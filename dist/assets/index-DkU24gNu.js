import{r as C,a as ko,g as Ji,R as Mo}from"./react-vendor-CSi47VP1.js";function Uo(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();var Wi={exports:{}},qt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Do=C,Lo=Symbol.for("react.element"),Fo=Symbol.for("react.fragment"),jo=Object.prototype.hasOwnProperty,$o=Do.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Oo={key:!0,ref:!0,__self:!0,__source:!0};function Ki(t,e,n){var s,i={},r=null,o=null;n!==void 0&&(r=""+n),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)jo.call(e,s)&&!Oo.hasOwnProperty(s)&&(i[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:Lo,type:t,key:r,ref:o,props:i,_owner:$o.current}}qt.Fragment=Fo;qt.jsx=Ki;qt.jsxs=Ki;Wi.exports=qt;var c=Wi.exports,an={},Yn=ko;an.createRoot=Yn.createRoot,an.hydrateRoot=Yn.hydrateRoot;const qo=t=>{const e=Math.floor((new Date().getTime()-t.getTime())/1e3);let n=e/31536e3;return n>1?Math.floor(n)+"y ago":(n=e/2592e3,n>1?Math.floor(n)+"mo ago":(n=e/86400,n>1?Math.floor(n)+"d ago":(n=e/3600,n>1?Math.floor(n)+"h ago":(n=e/60,n>1?Math.floor(n)+"m ago":Math.floor(e)+"s ago"))))},Vo=({notifications:t,onMarkAsRead:e,user:n,onNavigate:s})=>{const[i,r]=C.useState(!1),o=C.useRef(null),l=n?t.some(f=>!f.read):!1;C.useEffect(()=>{const f=m=>{o.current&&!o.current.contains(m.target)&&r(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const h=()=>{n?(!i&&l&&e(),r(f=>!f)):s("auth")},d={news:"fa-newspaper",job:"fa-briefcase",hostel:"fa-hotel",roommate:"fa-users"};return c.jsxs("div",{className:"relative",ref:o,children:[c.jsxs("button",{onClick:h,className:"relative text-2xl text-white hover:text-unistay-yellow transition-colors","aria-label":"Notifications",children:[c.jsx("i",{className:"fas fa-bell"}),l&&c.jsx("span",{className:"absolute top-0 right-0 block h-2.5 w-2.5 rounded-full bg-red-500 ring-2 ring-unistay-navy","aria-hidden":"true"})]}),i&&n&&c.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-white rounded-md shadow-lg text-unistay-navy z-50 overflow-hidden animate-slide-in-down",style:{animationDuration:"0.3s"},children:[c.jsx("div",{className:"p-3 font-bold border-b text-sm",children:"Notifications"}),t.length>0?c.jsx("div",{className:"max-h-96 overflow-y-auto no-scrollbar",children:t.map(f=>c.jsxs("div",{className:"flex items-start gap-3 p-3 border-b last:border-b-0 hover:bg-gray-50 transition-colors",children:[c.jsx("div",{className:"w-8 flex justify-center pt-1",children:c.jsx("i",{className:`fas ${d[f.type]} text-unistay-navy/60`})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm leading-snug",children:f.message}),c.jsx("p",{className:"text-xs text-gray-400 mt-1",children:qo(f.timestamp)})]})]},f.id))}):c.jsx("p",{className:"p-4 text-sm text-gray-500 text-center",children:"No new notifications."})]})]})},Go=({user:t,isAdmin:e,onLogout:n,onNavigate:s})=>{const[i,r]=C.useState(!1),o=C.useRef(null);C.useEffect(()=>{const h=d=>{o.current&&!o.current.contains(d.target)&&r(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const l=h=>{r(!1),s(h)};return c.jsxs("div",{className:"relative",ref:o,children:[c.jsx("button",{onClick:()=>r(!i),className:"flex items-center gap-2","aria-label":"Open user menu",children:c.jsx("div",{className:"w-10 h-10 rounded-full bg-unistay-yellow flex items-center justify-center font-bold text-unistay-navy text-xl",children:t?.name?.charAt(0).toUpperCase()})}),i&&c.jsxs("div",{className:"absolute right-0 mt-3 w-48 bg-white rounded-md shadow-lg py-1 text-unistay-navy z-50 animate-slide-in-down",style:{animationDuration:"0.3s"},children:[c.jsx("div",{className:"px-4 py-2 border-b",children:c.jsx("p",{className:"text-sm font-semibold truncate",children:t.name})}),c.jsx("button",{onClick:()=>l("profile"),className:"w-full text-left block px-4 py-2 text-sm hover:bg-gray-100 font-medium",children:"My Profile"}),e&&c.jsx("button",{onClick:()=>l("admin"),className:"w-full text-left block px-4 py-2 text-sm hover:bg-gray-100",children:"Admin Dashboard"}),c.jsx("button",{onClick:n,className:"w-full text-left block px-4 py-2 text-sm hover:bg-gray-100 text-red-600",children:"Logout"})]})]})},Bo=({onNavigate:t,currentView:e,user:n,isAdmin:s,onLogout:i,notifications:r,onMarkNotificationsAsRead:o})=>{const[l,h]=C.useState(!1),d=[{text:"Hostels",view:"main"},{text:"Roommates",view:"roommateFinder"},{text:"News",view:"blog"},{text:"Events",view:"events"},{text:"Jobs",view:"jobs"}],f=g=>e==="main"&&g==="main"?!0:e===g,m=g=>{t(g),h(!1)},p=e==="main";return e==="admin"||e==="auth"||e==="profile"?null:c.jsxs("header",{className:`bg-unistay-navy text-white shadow-lg ${p?"fixed":"sticky"} top-0 left-0 right-0 z-50`,children:[c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-20",children:[c.jsx("div",{className:"flex items-center",children:c.jsx("button",{onClick:()=>t("main"),className:"flex items-center select-none","aria-label":"Go to homepage",children:c.jsx("img",{src:"/images/hostels/unistay.png",alt:"UniStay Logo",className:"h-10"})})}),c.jsx("nav",{className:"hidden md:flex items-center space-x-6",children:d.map(g=>c.jsx("button",{onClick:()=>t(g.view),className:`font-medium transition-all duration-200 px-1 pb-2 pt-1 border-b-2 ${f(g.view)?"text-unistay-yellow border-unistay-yellow":"border-transparent hover:text-unistay-yellow"}`,children:g.text},g.text))}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx(Vo,{notifications:r,onMarkAsRead:o,user:n,onNavigate:t}),n?c.jsx(Go,{user:n,isAdmin:s,onLogout:i,onNavigate:t}):c.jsx("button",{onClick:()=>t("auth"),className:"hidden md:block bg-unistay-yellow text-unistay-navy font-bold py-2 px-6 rounded-full hover:bg-yellow-400 transition-colors",children:"Login"}),c.jsx("button",{onClick:()=>h(!l),className:"md:hidden text-white text-2xl focus:outline-none","aria-label":"Open menu","aria-expanded":l,children:c.jsx("i",{className:`fas ${l?"fa-times":"fa-bars"}`})})]})]})}),c.jsx("div",{className:`md:hidden bg-unistay-navy/95 backdrop-blur-sm overflow-hidden transition-all duration-300 ease-in-out ${l?"max-h-96":"max-h-0"}`,children:c.jsxs("nav",{className:"flex flex-col items-center space-y-4 py-4",children:[d.map(g=>c.jsx("button",{onClick:()=>m(g.view),className:`font-medium text-lg ${f(g.view)?"text-unistay-yellow":"text-white"}`,children:g.text},g.text)),!n&&c.jsx("button",{onClick:()=>m("auth"),className:"bg-unistay-yellow text-unistay-navy font-bold py-2 px-8 rounded-full mt-2",children:"Login"})]})})]})},Pe=()=>{const t=C.useRef(null),[e,n]=C.useState(!1);return C.useEffect(()=>{const s=new IntersectionObserver(([r])=>{r.isIntersecting&&(n(!0),s.unobserve(r.target))},{rootMargin:"0px 0px -100px 0px",threshold:.1}),i=t.current;return i&&s.observe(i),()=>{i&&s.unobserve(i)}},[]),[t,e]},Q=({size:t="md",color:e="navy",className:n=""})=>{const s={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-8 w-8"},i={white:"text-white",navy:"text-unistay-navy"};return c.jsxs("svg",{className:`animate-spin ${s[t]} ${i[e]} ${n}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},Ho=({hostels:t,onHostelSelect:e})=>{const[n,s]=Pe(),[i,r]=C.useState(!1),[o,l]=C.useState(""),[h,d]=C.useState([]),[f,m]=C.useState(!1),p=()=>{if(!o.trim())return;r(!0),m(!0);const y=t.filter(v=>{const x=o.toLowerCase().split(" "),w=`${v.name} ${v.location}`.toLowerCase();return x.every(_=>w.includes(_))});setTimeout(()=>{d(y),r(!1)},500)};C.useEffect(()=>{const y=v=>{const x=document.getElementById("search-container");x&&!x.contains(v.target)&&m(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const g=y=>{y.key==="Enter"&&p()};return c.jsxs("section",{ref:n,className:"relative bg-cover bg-center h-[60vh] min-h-[400px] flex items-center justify-center",style:{backgroundImage:"url('/images/hostels/akamweesi3.jpg')"},children:[c.jsx("div",{className:"absolute inset-0 bg-unistay-navy bg-opacity-60"}),c.jsxs("div",{className:`relative z-10 text-center text-white px-4 transition-all duration-1000 ${s?"opacity-100 translate-y-0":"opacity-0 translate-y-5"}`,children:[c.jsx("h1",{className:"text-4xl md:text-6xl font-extrabold tracking-tight mb-4",children:"Find Your Perfect Student Home"}),c.jsx("p",{className:"max-w-2xl mx-auto text-lg md:text-xl text-gray-200 mb-8",children:"Discover the best hostels near your university with all the amenities you need for a great student life."}),c.jsx("div",{className:"max-w-2xl mx-auto",children:c.jsxs("div",{id:"search-container",className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Search by hostel name or location...",className:"w-full p-4 pl-12 rounded-full border-2 border-transparent focus:ring-4 focus:ring-unistay-yellow focus:border-unistay-yellow text-gray-800 text-lg shadow-2xl transition",disabled:i,value:o,onChange:y=>l(y.target.value),onKeyPress:g}),c.jsx("i",{className:"fas fa-search absolute left-5 top-1/2 -translate-y-1/2 text-gray-400 text-xl"}),c.jsx("button",{onClick:p,disabled:i,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-unistay-navy hover:bg-opacity-90 text-white font-bold py-2.5 px-8 rounded-full transition-all duration-300 flex items-center justify-center w-[120px] disabled:bg-opacity-70",children:i?c.jsx(Q,{color:"white",size:"sm"}):"Search"}),f&&c.jsx("div",{className:"absolute mt-2 w-full bg-white rounded-xl shadow-2xl overflow-hidden z-20 transition-all duration-300",children:i?c.jsx("div",{className:"p-4 text-center",children:c.jsx(Q,{size:"lg"})}):h.length>0?c.jsx("div",{className:"max-h-96 overflow-y-auto",children:h.map(y=>c.jsxs("div",{onClick:()=>{e(y),m(!1),l("")},className:"flex items-center gap-4 p-4 hover:bg-gray-50 cursor-pointer border-b last:border-b-0 transition-colors",children:[c.jsx("div",{className:"w-16 h-16 flex-shrink-0",children:c.jsx("img",{src:y.imageUrl,alt:y.name,className:"w-full h-full object-cover rounded-lg"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-semibold text-unistay-navy",children:y.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:[c.jsx("i",{className:"fas fa-map-marker-alt text-unistay-yellow mr-2"}),y.location]}),c.jsxs("p",{className:"text-sm text-gray-500",children:[c.jsx("i",{className:"fas fa-tag text-unistay-yellow mr-2"}),y.priceRange]})]}),y.isRecommended&&c.jsx("span",{className:"text-unistay-yellow",children:c.jsx("i",{className:"fas fa-star"})})]},y.id))}):o&&c.jsxs("div",{className:"p-8 text-center",children:[c.jsx("i",{className:"fas fa-home text-4xl text-gray-300 mb-4"}),c.jsxs("p",{className:"text-gray-500",children:['No hostels found matching "',o,'"']})]})})]})})]})]})};new Date().toISOString();const ue=[{id:"123e4567-e89b-12d3-a456-426614174001",name:"Makerere",logoUrl:"/images/hostels/makerere.jpg"},{id:"123e4567-e89b-12d3-a456-426614174002",name:"Kyambogo",logoUrl:"/images/hostels/kyambogo.jpg"},{id:"123e4567-e89b-12d3-a456-426614174003",name:"MUBS",logoUrl:"/images/hostels/mubs.jpg"},{id:"123e4567-e89b-12d3-a456-426614174004",name:"UCU",logoUrl:"/images/hostels/ucu.png"},{id:"123e4567-e89b-12d3-a456-426614174005",name:"UMU Nkozi",logoUrl:"/images/hostels/umu.png"},{id:"123e4567-e89b-12d3-a456-426614174006",name:"KIU",logoUrl:"/images/hostels/kiu.jpg"},{id:"123e4567-e89b-12d3-a456-426614174007",name:"MUST",logoUrl:"/images/hostels/must.jpg"},{id:"123e4567-e89b-12d3-a456-426614174008",name:"Aga Khan",logoUrl:"/images/hostels/agaKhan.jpg"},{id:"123e4567-e89b-12d3-a456-426614174009",name:"Gulu",logoUrl:"/images/hostels/gulu.png"},{id:"123e4567-e89b-12d3-a456-426614174010",name:"Lira",logoUrl:"/images/hostels/lira.png"},{id:"123e4567-e89b-12d3-a456-426614174011",name:"IUEA",logoUrl:"/images/hostels/iuea.jpg"}],Jo=[{id:"food",name:"Food",icon:"fas fa-utensils",description:"Best & affordable food spots."},{id:"transport",name:"Transport",icon:"fas fa-motorcycle",description:"Easy ways to get around campus."},{id:"shopping",name:"Shopping",icon:"fas fa-shopping-bag",description:"Your essentials and retail therapy."},{id:"stationery",name:"Stationery",icon:"fas fa-book-open",description:"All your academic supplies."},{id:"laundry",name:"Laundry",icon:"fas fa-tshirt",description:"Quick & convenient laundry services."},{id:"entertainment",name:"Entertainment",icon:"fas fa-ticket-alt",description:"Fun activities and hangout joints."},{id:"internet",name:"Internet",icon:"fas fa-wifi",description:"Reliable internet for study & fun."},{id:"health",name:"Health",icon:"fas fa-heartbeat",description:"Clinics, pharmacies & wellness."}],Wo=[{name:"WiFi",icon:"fas fa-wifi"},{name:"Shuttle",icon:"fas fa-bus"},{name:"Security",icon:"fas fa-shield-alt"},{name:"DSTV",icon:"fas fa-tv"},{name:"Pool",icon:"fas fa-swimmer"},{name:"Gym",icon:"fas fa-dumbbell"},{name:"Restaurant",icon:"fas fa-utensils"},{name:"Water",icon:"fas fa-shower"}],Ko=["Male","Female"],zo=["Male","Female","Any"],Yo=["Semester","Full Year","Flexible"],Qo=["Early Bird","Night Owl","Flexible"],Xo=["Tidy","Average","Relaxed"],Zo=["Rarely","Sometimes","Often"],ea=["Socially","Rarely","No"],zi=({hostel:t,onViewHostel:e,onSaveToggle:n,isSaved:s})=>c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden group transform hover:-translate-y-2 transition-all duration-300 h-full flex flex-col",children:[c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:t.imageUrl,alt:t.name,className:"h-56 w-full object-cover"}),c.jsx("button",{onClick:i=>{i.stopPropagation(),n(t.id)},className:"absolute top-4 left-4 bg-black/40 text-white rounded-full h-10 w-10 flex items-center justify-center hover:bg-black/60 transition-all duration-200 transform hover:scale-110 z-10","aria-label":s?"Unsave hostel":"Save hostel",children:c.jsx("i",{className:`${s?"fas":"far"} fa-heart ${s?"text-red-500":""} text-lg`})}),c.jsxs("div",{className:"absolute top-4 right-4 bg-white/80 backdrop-blur-sm text-unistay-navy px-3 py-1 rounded-full font-bold flex items-center gap-1",children:[c.jsx("i",{className:"fas fa-star text-unistay-yellow"}),t.rating]})]}),c.jsxs("div",{className:"p-5 flex flex-col flex-grow",children:[c.jsx("h3",{className:"text-xl font-bold text-unistay-navy",children:t.name}),c.jsx("p",{className:"text-gray-600 mt-1 flex-grow",children:t.location}),c.jsxs("div",{className:"flex justify-between items-center mt-4",children:[c.jsx("span",{className:"text-lg font-extrabold text-unistay-navy bg-unistay-yellow/20 px-3 py-1 rounded-lg",children:t.priceRange}),c.jsx("button",{onClick:()=>e(t),className:"bg-unistay-navy text-white font-semibold px-5 py-2 rounded-lg transition-transform transform group-hover:scale-105 group-hover:bg-unistay-yellow group-hover:text-unistay-navy",children:"View"})]})]})]}),ta=({universities:t,selectedUniversity:e,onSelect:n})=>{const[s,i]=Pe(),[r,o]=C.useState(!1),l=C.useRef(null);return c.jsxs("div",{ref:s,className:`transition-all duration-700 ${i?"opacity-100 translate-y-0":"opacity-0 translate-y-5"}`,children:[c.jsx("h2",{className:"text-3xl font-bold text-unistay-navy text-center mb-6",children:"Find Hostels At Your University"}),c.jsx("div",{ref:l,className:"flex justify-center flex-wrap gap-4 overflow-hidden transition-all duration-500 ease-in-out",style:{maxHeight:r?`${l.current?.scrollHeight}px`:"70px"},children:t.map(f=>c.jsxs("button",{onClick:()=>n(f),className:`flex items-center gap-3 px-6 py-3 rounded-full text-lg font-semibold border-2 transition-all duration-300 transform hover:scale-105 ${e.id===f.id?"bg-unistay-navy text-white border-unistay-navy shadow-lg":"bg-white text-unistay-navy border-gray-200 hover:border-unistay-navy"}`,children:[c.jsx("img",{src:f.logoUrl,alt:`${f.name} Logo`,className:"w-7 h-7 rounded-full object-cover"}),f.name]},f.id))}),t.length>5&&c.jsx("div",{className:"text-center mt-6",children:c.jsxs("button",{onClick:()=>o(!r),className:"font-semibold text-unistay-navy hover:text-unistay-yellow transition-colors flex items-center gap-2 mx-auto","aria-expanded":r,children:[c.jsx("span",{children:r?"Show Less":"Show More"}),c.jsx("i",{className:`fas fa-chevron-down transition-transform duration-300 ${r?"rotate-180":""}`})]})})]})},na=({hostels:t,universityName:e,onViewHostel:n,savedHostelIds:s,onToggleSave:i,hasActiveFilter:r,initialHostelCount:o})=>{const[l,h]=Pe();return o===0?c.jsx("div",{ref:l,className:`mt-16 transition-all duration-700 delay-100 ${h?"opacity-100":"opacity-0"}`,children:c.jsxs("div",{className:"text-center py-8 px-4 bg-unistay-bg rounded-2xl",children:[c.jsx("i",{className:"fas fa-bed text-4xl text-gray-300 mb-4"}),c.jsxs("h3",{className:"text-xl font-semibold text-unistay-navy",children:["No Hostels Found for ",e]}),c.jsxs("p",{className:"text-gray-500 mt-2",children:["We don't have specific listings for this university yet. ",c.jsx("br",{})," Please check our general recommendations below!"]})]})}):t.length===0&&r?c.jsx("div",{ref:l,className:`mt-16 transition-all duration-700 delay-100 ${h?"opacity-100":"opacity-0"}`,children:c.jsxs("div",{className:"text-center py-8 px-4 bg-unistay-bg rounded-2xl",children:[c.jsx("i",{className:"fas fa-filter text-4xl text-gray-300 mb-4"}),c.jsx("h3",{className:"text-xl font-semibold text-unistay-navy",children:"No Hostels Match Your Filters"}),c.jsx("p",{className:"text-gray-500 mt-2",children:"Try removing some amenities to see more results."})]})}):c.jsxs("div",{ref:l,className:`mt-16 transition-all duration-700 delay-100 ${h?"opacity-100":"opacity-0"}`,children:[c.jsxs("h2",{className:"text-2xl font-bold text-unistay-navy mb-6",children:["Hostels Near ",e]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:t.map(d=>c.jsx("div",{children:c.jsx(zi,{hostel:d,onViewHostel:n,onSaveToggle:i,isSaved:s.has(d.id)})},d.id))})]})},sa=({hostels:t,onViewHostel:e,savedHostelIds:n,onToggleSave:s})=>{const[i,r]=Pe();return c.jsxs("div",{ref:i,className:`mt-16 transition-all duration-700 delay-200 ${r?"opacity-100":"opacity-0"}`,children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-unistay-navy",children:"Recommended For You"}),c.jsx("a",{href:"#",className:"text-unistay-yellow font-semibold hover:underline",children:"See All"})]}),c.jsx("div",{className:"flex overflow-x-auto space-x-6 pb-4 no-scrollbar scroll-snap-x-mandatory",children:t.map((o,l)=>c.jsx("div",{className:`w-80 md:w-96 flex-shrink-0 scroll-snap-align-start transition-transform duration-500 delay-${l*100} ${r?"translate-y-0":"translate-y-5"}`,children:c.jsx(zi,{hostel:o,onViewHostel:e,onSaveToggle:s,isSaved:n.has(o.id)})},o.id))})]})},ia=({universities:t,selectedUniversity:e,onSelectUniversity:n,hostels:s,onViewHostel:i,savedHostelIds:r,onToggleSave:o})=>{const[l,h]=Pe(),[d,f]=C.useState(new Set),m=v=>{f(x=>{const w=new Set(x);return w.has(v)?w.delete(v):w.add(v),w})},p=s.filter(v=>v.universityId===e.id),g=d.size>0?p.filter(v=>Array.from(d).every(x=>v.amenities.some(w=>w.name===x))):p,y=s.filter(v=>v.isRecommended);return c.jsx("section",{className:"bg-white py-16",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsx(ta,{universities:t,selectedUniversity:e,onSelect:n}),c.jsxs("div",{ref:l,className:`mt-12 transition-all duration-700 delay-100 ${h?"opacity-100":"opacity-0"}`,children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-xl font-bold text-unistay-navy",children:"Filter by Amenities"}),d.size>0&&c.jsx("button",{onClick:()=>f(new Set),className:"text-sm font-semibold text-unistay-navy hover:text-unistay-yellow transition-colors",children:"Clear Filters"})]}),c.jsx("div",{className:"flex flex-wrap gap-3",children:Wo.map(v=>c.jsxs("button",{onClick:()=>m(v.name),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold border-2 transition-all duration-200 transform hover:scale-105 ${d.has(v.name)?"bg-unistay-navy text-white border-unistay-navy":"bg-white text-gray-700 border-gray-200 hover:border-unistay-navy"}`,children:[c.jsx("i",{className:`${v.icon} w-4 text-center`}),c.jsx("span",{children:v.name})]},v.name))})]}),c.jsx(na,{hostels:g,universityName:e.name,onViewHostel:i,savedHostelIds:r,onToggleSave:o,hasActiveFilter:d.size>0,initialHostelCount:p.length}),y.length>0&&c.jsx(sa,{hostels:y,onViewHostel:i,savedHostelIds:r,onToggleSave:o})]})})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let ra,oa;function aa(){return{geminiUrl:ra,vertexUrl:oa}}function la(t,e,n,s){var i,r;if(!t?.baseUrl){const o=aa();return e?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(r=o.geminiUrl)!==null&&r!==void 0?r:s}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ke{}function I(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(s,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const r=e[i];return r!=null?String(r):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function u(t,e,n){for(let r=0;r<e.length-1;r++){const o=e[r];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in t))if(Array.isArray(n))t[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[l])){const h=t[l];if(Array.isArray(n))for(let d=0;d<h.length;d++){const f=h[d];u(f,e.slice(r+1),n[d])}else for(const d of h)u(d,e.slice(r+1),n)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in t||(t[l]=[{}]);const h=t[l];u(h[0],e.slice(r+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const s=e[e.length-1],i=t[s];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[s]=n}function a(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let s=0;s<e.length;s++){if(typeof t!="object"||t===null)return n;const i=e[s];if(i.endsWith("[]")){const r=i.slice(0,-2);if(r in t){const o=t[r];return Array.isArray(o)?o.map(l=>a(l,e.slice(s+1),n)):n}else return n}else t=t[i]}return t}catch(s){if(s instanceof TypeError)return n;throw s}}function ua(t,e){for(const[n,s]of Object.entries(e)){const i=n.split("."),r=s.split("."),o=new Set;let l=-1;for(let h=0;h<i.length;h++)if(i[h]==="*"){l=h;break}if(l!==-1&&r.length>l)for(let h=l;h<r.length;h++){const d=r[h];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&o.add(d)}ln(t,i,r,0,o)}}function ln(t,e,n,s,i){if(s>=e.length||typeof t!="object"||t===null)return;const r=e[s];if(r.endsWith("[]")){const o=r.slice(0,-2),l=t;if(o in l&&Array.isArray(l[o]))for(const h of l[o])ln(h,e,n,s+1,i)}else if(r==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const o=t,l=Object.keys(o).filter(d=>!d.startsWith("_")&&!i.has(d)),h={};for(const d of l)h[d]=o[d];for(const[d,f]of Object.entries(h)){const m=[];for(const p of n.slice(s))p==="*"?m.push(d):m.push(p);u(o,m,f)}for(const d of l)delete o[d]}}else{const o=t;r in o&&ln(o[r],e,n,s+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rn(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ca(t){const e={},n=a(t,["operationName"]);n!=null&&u(e,["operationName"],n);const s=a(t,["resourceName"]);return s!=null&&u(e,["_url","resourceName"],s),e}function da(t){const e={},n=a(t,["name"]);n!=null&&u(e,["name"],n);const s=a(t,["metadata"]);s!=null&&u(e,["metadata"],s);const i=a(t,["done"]);i!=null&&u(e,["done"],i);const r=a(t,["error"]);r!=null&&u(e,["error"],r);const o=a(t,["response","generateVideoResponse"]);return o!=null&&u(e,["response"],fa(o)),e}function ha(t){const e={},n=a(t,["name"]);n!=null&&u(e,["name"],n);const s=a(t,["metadata"]);s!=null&&u(e,["metadata"],s);const i=a(t,["done"]);i!=null&&u(e,["done"],i);const r=a(t,["error"]);r!=null&&u(e,["error"],r);const o=a(t,["response"]);return o!=null&&u(e,["response"],ma(o)),e}function fa(t){const e={},n=a(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>pa(o))),u(e,["generatedVideos"],r)}const s=a(t,["raiMediaFilteredCount"]);s!=null&&u(e,["raiMediaFilteredCount"],s);const i=a(t,["raiMediaFilteredReasons"]);return i!=null&&u(e,["raiMediaFilteredReasons"],i),e}function ma(t){const e={},n=a(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>ga(o))),u(e,["generatedVideos"],r)}const s=a(t,["raiMediaFilteredCount"]);s!=null&&u(e,["raiMediaFilteredCount"],s);const i=a(t,["raiMediaFilteredReasons"]);return i!=null&&u(e,["raiMediaFilteredReasons"],i),e}function pa(t){const e={},n=a(t,["video"]);return n!=null&&u(e,["video"],xa(n)),e}function ga(t){const e={},n=a(t,["_self"]);return n!=null&&u(e,["video"],wa(n)),e}function ya(t){const e={},n=a(t,["operationName"]);return n!=null&&u(e,["_url","operationName"],n),e}function va(t){const e={},n=a(t,["operationName"]);return n!=null&&u(e,["_url","operationName"],n),e}function xa(t){const e={},n=a(t,["uri"]);n!=null&&u(e,["uri"],n);const s=a(t,["encodedVideo"]);s!=null&&u(e,["videoBytes"],Rn(s));const i=a(t,["encoding"]);return i!=null&&u(e,["mimeType"],i),e}function wa(t){const e={},n=a(t,["gcsUri"]);n!=null&&u(e,["uri"],n);const s=a(t,["bytesBase64Encoded"]);s!=null&&u(e,["videoBytes"],Rn(s));const i=a(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Qn;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Qn||(Qn={}));var Xn;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Xn||(Xn={}));var Zn;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Zn||(Zn={}));var ve;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(ve||(ve={}));var es;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(es||(es={}));var ts;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(ts||(ts={}));var ns;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(ns||(ns={}));var ss;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(ss||(ss={}));var is;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(is||(is={}));var rs;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(rs||(rs={}));var os;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(os||(os={}));var as;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(as||(as={}));var ls;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ls||(ls={}));var us;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(us||(us={}));var cs;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(cs||(cs={}));var ds;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ds||(ds={}));var Pt;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Pt||(Pt={}));var hs;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(hs||(hs={}));var fs;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(fs||(fs={}));var ms;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ms||(ms={}));var un;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(un||(un={}));var ps;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(ps||(ps={}));var gs;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(gs||(gs={}));var ys;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(ys||(ys={}));var vs;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(vs||(vs={}));var xs;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(xs||(xs={}));var ws;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(ws||(ws={}));var _s;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(_s||(_s={}));var bs;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(bs||(bs={}));var Es;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Es||(Es={}));var Ts;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ts||(Ts={}));var Ss;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Ss||(Ss={}));var Cs;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Cs||(Cs={}));var Ns;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Ns||(Ns={}));var Is;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Is||(Is={}));var As;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(As||(As={}));var Rs;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Rs||(Rs={}));var Ps;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Ps||(Ps={}));var ks;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(ks||(ks={}));var Ms;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Ms||(Ms={}));var Us;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Us||(Us={}));var Ds;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Ds||(Ds={}));var Ls;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Ls||(Ls={}));var Fs;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Fs||(Fs={}));var js;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(js||(js={}));var $s;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})($s||($s={}));var Os;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Os||(Os={}));var qs;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(qs||(qs={}));var Vs;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Vs||(Vs={}));var Ve;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Ve||(Ve={}));class cn{constructor(e){const n={};for(const s of e.headers.entries())n[s[0]]=s[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class it{get text(){var e,n,s,i,r,o,l,h;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1;let d="",f=!1;const m=[];for(const p of(h=(l=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&h!==void 0?h:[]){for(const[g,y]of Object.entries(p))g!=="text"&&g!=="thought"&&(y!==null||y!==void 0)&&m.push(g);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,d+=p.text}}return m.length>0,f?d:void 0}get data(){var e,n,s,i,r,o,l,h;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1;let d="";const f=[];for(const m of(h=(l=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&h!==void 0?h:[]){for(const[p,g]of Object.entries(m))p!=="inlineData"&&(g!==null||g!==void 0)&&f.push(p);m.inlineData&&typeof m.inlineData.data=="string"&&(d+=atob(m.inlineData.data))}return f.length>0,d.length>0?btoa(d):void 0}get functionCalls(){var e,n,s,i,r,o,l,h;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1;const d=(h=(l=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||h===void 0?void 0:h.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if(d?.length!==0)return d}get executableCode(){var e,n,s,i,r,o,l,h,d;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1;const f=(h=(l=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||h===void 0?void 0:h.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if(f?.length!==0)return(d=f?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,s,i,r,o,l,h,d;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1;const f=(h=(l=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||h===void 0?void 0:h.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if(f?.length!==0)return(d=f?.[0])===null||d===void 0?void 0:d.output}}class Gs{}class Bs{}class _a{}class ba{}class Ea{}class Ta{}class Hs{}class Js{}class Ws{}class Sa{}class kt{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const s=new kt;let i;const r=e;return n?i=ha(r):i=da(r),Object.assign(s,i),s}}class Ks{}class zs{}class Ys{}class Ca{}class Na{}class Ia{}class Qs{}class Aa{get text(){var e,n,s;let i="",r=!1;const o=[];for(const l of(s=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&s!==void 0?s:[]){for(const[h,d]of Object.entries(l))h!=="text"&&h!=="thought"&&d!==null&&o.push(h);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;r=!0,i+=l.text}}return o.length>0,r?i:void 0}get data(){var e,n,s;let i="";const r=[];for(const o of(s=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&s!==void 0?s:[]){for(const[l,h]of Object.entries(o))l!=="inlineData"&&h!==null&&r.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return r.length>0,i.length>0?btoa(i):void 0}}class Ra{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function L(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Yi(t,e){const n=L(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function Qi(t){return Array.isArray(t)?t.map(e=>Mt(e)):[Mt(t)]}function Mt(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Xi(t){const e=Mt(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Zi(t){const e=Mt(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Xs(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function er(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Xs(e)):[Xs(t)]}function dn(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Zs(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function ei(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function z(t){if(t==null)throw new Error("ContentUnion is required");return dn(t)?t:{role:"user",parts:er(t)}}function Pn(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const s=z(n);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(t.isVertexAI()){const n=z(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>z(n)):[z(e)]}function se(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Zs(t)||ei(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[z(t)]}const e=[],n=[],s=dn(t[0]);for(const i of t){const r=dn(i);if(r!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(i);else{if(Zs(i)||ei(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return s||e.push({role:"user",parts:er(n)}),e}function Pa(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(s=>s!=="null");if(n.length===1)e.type=Object.values(ve).includes(n[0].toUpperCase())?n[0].toUpperCase():ve.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of n)e.anyOf.push({type:Object.values(ve).includes(s.toUpperCase())?s.toUpperCase():ve.TYPE_UNSPECIFIED})}}function Ge(t){const e={},n=["items"],s=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=t.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,t=r[1]):r[1].type==="null"&&(e.nullable=!0,t=r[0])),t.type instanceof Array&&Pa(t.type,e);for(const[o,l]of Object.entries(t))if(l!=null)if(o=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.values(ve).includes(l.toUpperCase())?l.toUpperCase():ve.TYPE_UNSPECIFIED}else if(n.includes(o))e[o]=Ge(l);else if(s.includes(o)){const h=[];for(const d of l){if(d.type=="null"){e.nullable=!0;continue}h.push(Ge(d))}e[o]=h}else if(i.includes(o)){const h={};for(const[d,f]of Object.entries(l))h[d]=Ge(f);e[o]=h}else{if(o==="additionalProperties")continue;e[o]=l}return e}function kn(t){return Ge(t)}function Mn(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Un(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function ze(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ge(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ge(e.response));return t}function Ye(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function ka(t,e,n,s=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===s;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function he(t,e){if(typeof e!="string")throw new Error("name must be a string");return ka(t,e,"cachedContents")}function tr(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function we(t){return Rn(t)}function Ma(t){return t!=null&&typeof t=="object"&&"name"in t}function Ua(t){return t!=null&&typeof t=="object"&&"video"in t}function Da(t){return t!=null&&typeof t=="object"&&"uri"in t}function nr(t){var e;let n;if(Ma(t)&&(n=t.name),!(Da(t)&&(n=t.uri,n===void 0))&&!(Ua(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function sr(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function ir(t){for(const e of["models","tunedModels","publisherModels"])if(La(t,e))return t[e];return[]}function La(t,e){return t!==null&&typeof t=="object"&&e in t}function Fa(t,e={}){const n=t,s={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(s.responseJsonSchema=n.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function ja(t,e={}){const n=[],s=new Set;for(const i of t){const r=i.name;if(s.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);s.add(r);const o=Fa(i,e);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function rr(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const s=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function $a(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function or(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let r=!1;for(const o of i){if(typeof o!="object"||o===null)continue;const h=o.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){r=!0;break}}return r&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Qe(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function ar(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oa(t){const e={},n=a(t,["responsesFile"]);n!=null&&u(e,["fileName"],n);const s=a(t,["inlinedResponses","inlinedResponses"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>yl(o))),u(e,["inlinedResponses"],r)}const i=a(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),u(e,["inlinedEmbedContentResponses"],r)}return e}function qa(t){const e={},n=a(t,["predictionsFormat"]);n!=null&&u(e,["format"],n);const s=a(t,["gcsDestination","outputUriPrefix"]);s!=null&&u(e,["gcsUri"],s);const i=a(t,["bigqueryDestination","outputUri"]);return i!=null&&u(e,["bigqueryUri"],i),e}function Va(t){const e={},n=a(t,["format"]);n!=null&&u(e,["predictionsFormat"],n);const s=a(t,["gcsUri"]);s!=null&&u(e,["gcsDestination","outputUriPrefix"],s);const i=a(t,["bigqueryUri"]);if(i!=null&&u(e,["bigqueryDestination","outputUri"],i),a(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(a(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(a(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function It(t){const e={},n=a(t,["name"]);n!=null&&u(e,["name"],n);const s=a(t,["metadata","displayName"]);s!=null&&u(e,["displayName"],s);const i=a(t,["metadata","state"]);i!=null&&u(e,["state"],ar(i));const r=a(t,["metadata","createTime"]);r!=null&&u(e,["createTime"],r);const o=a(t,["metadata","endTime"]);o!=null&&u(e,["endTime"],o);const l=a(t,["metadata","updateTime"]);l!=null&&u(e,["updateTime"],l);const h=a(t,["metadata","model"]);h!=null&&u(e,["model"],h);const d=a(t,["metadata","output"]);return d!=null&&u(e,["dest"],Oa(or(d))),e}function hn(t){const e={},n=a(t,["name"]);n!=null&&u(e,["name"],n);const s=a(t,["displayName"]);s!=null&&u(e,["displayName"],s);const i=a(t,["state"]);i!=null&&u(e,["state"],ar(i));const r=a(t,["error"]);r!=null&&u(e,["error"],r);const o=a(t,["createTime"]);o!=null&&u(e,["createTime"],o);const l=a(t,["startTime"]);l!=null&&u(e,["startTime"],l);const h=a(t,["endTime"]);h!=null&&u(e,["endTime"],h);const d=a(t,["updateTime"]);d!=null&&u(e,["updateTime"],d);const f=a(t,["model"]);f!=null&&u(e,["model"],f);const m=a(t,["inputConfig"]);m!=null&&u(e,["src"],Ga(m));const p=a(t,["outputConfig"]);return p!=null&&u(e,["dest"],qa(or(p))),e}function Ga(t){const e={},n=a(t,["instancesFormat"]);n!=null&&u(e,["format"],n);const s=a(t,["gcsSource","uris"]);s!=null&&u(e,["gcsUri"],s);const i=a(t,["bigquerySource","inputUri"]);return i!=null&&u(e,["bigqueryUri"],i),e}function Ba(t,e){const n={};if(a(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(a(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(a(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=a(e,["fileName"]);s!=null&&u(n,["fileName"],s);const i=a(e,["inlinedRequests"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>gl(t,o))),u(n,["requests","requests"],r)}return n}function Ha(t){const e={},n=a(t,["format"]);n!=null&&u(e,["instancesFormat"],n);const s=a(t,["gcsUri"]);s!=null&&u(e,["gcsSource","uris"],s);const i=a(t,["bigqueryUri"]);if(i!=null&&u(e,["bigquerySource","inputUri"],i),a(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(a(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Ja(t){const e={},n=a(t,["data"]);if(n!=null&&u(e,["data"],n),a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function Wa(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],Qe(t,s)),n}function Ka(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],Qe(t,s)),n}function za(t){const e={},n=a(t,["content"]);n!=null&&u(e,["content"],n);const s=a(t,["citationMetadata"]);s!=null&&u(e,["citationMetadata"],Ya(s));const i=a(t,["tokenCount"]);i!=null&&u(e,["tokenCount"],i);const r=a(t,["finishReason"]);r!=null&&u(e,["finishReason"],r);const o=a(t,["avgLogprobs"]);o!=null&&u(e,["avgLogprobs"],o);const l=a(t,["groundingMetadata"]);l!=null&&u(e,["groundingMetadata"],l);const h=a(t,["index"]);h!=null&&u(e,["index"],h);const d=a(t,["logprobsResult"]);d!=null&&u(e,["logprobsResult"],d);const f=a(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>g)),u(e,["safetyRatings"],p)}const m=a(t,["urlContextMetadata"]);return m!=null&&u(e,["urlContextMetadata"],m),e}function Ya(t){const e={},n=a(t,["citationSources"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),u(e,["citations"],s)}return e}function lr(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Tl(r))),u(e,["parts"],i)}const s=a(t,["role"]);return s!=null&&u(e,["role"],s),e}function Qa(t,e){const n={},s=a(t,["displayName"]);if(e!==void 0&&s!=null&&u(e,["batch","displayName"],s),a(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function Xa(t,e){const n={},s=a(t,["displayName"]);e!==void 0&&s!=null&&u(e,["displayName"],s);const i=a(t,["dest"]);return e!==void 0&&i!=null&&u(e,["outputConfig"],Va($a(i))),n}function ti(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["src"]);i!=null&&u(n,["batch","inputConfig"],Ba(t,rr(t,i)));const r=a(e,["config"]);return r!=null&&Qa(r,n),n}function Za(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["model"],L(t,s));const i=a(e,["src"]);i!=null&&u(n,["inputConfig"],Ha(rr(t,i)));const r=a(e,["config"]);return r!=null&&Xa(r,n),n}function el(t,e){const n={},s=a(t,["displayName"]);return e!==void 0&&s!=null&&u(e,["batch","displayName"],s),n}function tl(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["src"]);i!=null&&u(n,["batch","inputConfig"],ll(t,i));const r=a(e,["config"]);return r!=null&&el(r,n),n}function nl(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],Qe(t,s)),n}function sl(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],Qe(t,s)),n}function il(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["name"]);s!=null&&u(e,["name"],s);const i=a(t,["done"]);i!=null&&u(e,["done"],i);const r=a(t,["error"]);return r!=null&&u(e,["error"],r),e}function rl(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["name"]);s!=null&&u(e,["name"],s);const i=a(t,["done"]);i!=null&&u(e,["done"],i);const r=a(t,["error"]);return r!=null&&u(e,["error"],r),e}function ol(t,e){const n={},s=a(e,["contents"]);if(s!=null){let r=Pn(t,s);Array.isArray(r)&&(r=r.map(o=>o)),u(n,["requests[]","request","content"],r)}const i=a(e,["config"]);return i!=null&&(u(n,["_self"],al(i,n)),ua(n,{"requests[].*":"requests[].request.*"})),n}function al(t,e){const n={},s=a(t,["taskType"]);e!==void 0&&s!=null&&u(e,["requests[]","taskType"],s);const i=a(t,["title"]);e!==void 0&&i!=null&&u(e,["requests[]","title"],i);const r=a(t,["outputDimensionality"]);if(e!==void 0&&r!=null&&u(e,["requests[]","outputDimensionality"],r),a(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(a(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ll(t,e){const n={},s=a(e,["fileName"]);s!=null&&u(n,["file_name"],s);const i=a(e,["inlinedRequests"]);return i!=null&&u(n,["requests"],ol(t,i)),n}function ul(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function cl(t,e,n){const s={},i=a(e,["systemInstruction"]);n!==void 0&&i!=null&&u(n,["systemInstruction"],lr(z(i)));const r=a(e,["temperature"]);r!=null&&u(s,["temperature"],r);const o=a(e,["topP"]);o!=null&&u(s,["topP"],o);const l=a(e,["topK"]);l!=null&&u(s,["topK"],l);const h=a(e,["candidateCount"]);h!=null&&u(s,["candidateCount"],h);const d=a(e,["maxOutputTokens"]);d!=null&&u(s,["maxOutputTokens"],d);const f=a(e,["stopSequences"]);f!=null&&u(s,["stopSequences"],f);const m=a(e,["responseLogprobs"]);m!=null&&u(s,["responseLogprobs"],m);const p=a(e,["logprobs"]);p!=null&&u(s,["logprobs"],p);const g=a(e,["presencePenalty"]);g!=null&&u(s,["presencePenalty"],g);const y=a(e,["frequencyPenalty"]);y!=null&&u(s,["frequencyPenalty"],y);const v=a(e,["seed"]);v!=null&&u(s,["seed"],v);const x=a(e,["responseMimeType"]);x!=null&&u(s,["responseMimeType"],x);const w=a(e,["responseSchema"]);w!=null&&u(s,["responseSchema"],kn(w));const _=a(e,["responseJsonSchema"]);if(_!=null&&u(s,["responseJsonSchema"],_),a(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(a(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=a(e,["safetySettings"]);if(n!==void 0&&b!=null){let $=b;Array.isArray($)&&($=$.map(te=>Sl(te))),u(n,["safetySettings"],$)}const T=a(e,["tools"]);if(n!==void 0&&T!=null){let $=Ye(T);Array.isArray($)&&($=$.map(te=>Cl(ze(te)))),u(n,["tools"],$)}const S=a(e,["toolConfig"]);if(n!==void 0&&S!=null&&u(n,["toolConfig"],S),a(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const E=a(e,["cachedContent"]);n!==void 0&&E!=null&&u(n,["cachedContent"],he(t,E));const N=a(e,["responseModalities"]);N!=null&&u(s,["responseModalities"],N);const M=a(e,["mediaResolution"]);M!=null&&u(s,["mediaResolution"],M);const R=a(e,["speechConfig"]);if(R!=null&&u(s,["speechConfig"],Mn(R)),a(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=a(e,["thinkingConfig"]);U!=null&&u(s,["thinkingConfig"],U);const V=a(e,["imageConfig"]);return V!=null&&u(s,["imageConfig"],V),s}function dl(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["candidates"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(d=>za(d))),u(e,["candidates"],h)}const i=a(t,["modelVersion"]);i!=null&&u(e,["modelVersion"],i);const r=a(t,["promptFeedback"]);r!=null&&u(e,["promptFeedback"],r);const o=a(t,["responseId"]);o!=null&&u(e,["responseId"],o);const l=a(t,["usageMetadata"]);return l!=null&&u(e,["usageMetadata"],l),e}function hl(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],Qe(t,s)),n}function fl(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],Qe(t,s)),n}function ml(t){const e={};if(a(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function pl(t){const e={};if(a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=a(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function gl(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["request","model"],L(t,s));const i=a(e,["contents"]);if(i!=null){let l=se(i);Array.isArray(l)&&(l=l.map(h=>lr(h))),u(n,["request","contents"],l)}const r=a(e,["metadata"]);r!=null&&u(n,["metadata"],r);const o=a(e,["config"]);return o!=null&&u(n,["request","generationConfig"],cl(t,o,a(n,["request"],{}))),n}function yl(t){const e={},n=a(t,["response"]);n!=null&&u(e,["response"],dl(n));const s=a(t,["error"]);return s!=null&&u(e,["error"],s),e}function vl(t,e){const n={},s=a(t,["pageSize"]);e!==void 0&&s!=null&&u(e,["_query","pageSize"],s);const i=a(t,["pageToken"]);if(e!==void 0&&i!=null&&u(e,["_query","pageToken"],i),a(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function xl(t,e){const n={},s=a(t,["pageSize"]);e!==void 0&&s!=null&&u(e,["_query","pageSize"],s);const i=a(t,["pageToken"]);e!==void 0&&i!=null&&u(e,["_query","pageToken"],i);const r=a(t,["filter"]);return e!==void 0&&r!=null&&u(e,["_query","filter"],r),n}function wl(t){const e={},n=a(t,["config"]);return n!=null&&vl(n,e),e}function _l(t){const e={},n=a(t,["config"]);return n!=null&&xl(n,e),e}function bl(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["nextPageToken"]);s!=null&&u(e,["nextPageToken"],s);const i=a(t,["operations"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>It(o))),u(e,["batchJobs"],r)}return e}function El(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["nextPageToken"]);s!=null&&u(e,["nextPageToken"],s);const i=a(t,["batchPredictionJobs"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>hn(o))),u(e,["batchJobs"],r)}return e}function Tl(t){const e={},n=a(t,["functionCall"]);n!=null&&u(e,["functionCall"],n);const s=a(t,["codeExecutionResult"]);s!=null&&u(e,["codeExecutionResult"],s);const i=a(t,["executableCode"]);i!=null&&u(e,["executableCode"],i);const r=a(t,["fileData"]);r!=null&&u(e,["fileData"],ul(r));const o=a(t,["functionResponse"]);o!=null&&u(e,["functionResponse"],o);const l=a(t,["inlineData"]);l!=null&&u(e,["inlineData"],Ja(l));const h=a(t,["text"]);h!=null&&u(e,["text"],h);const d=a(t,["thought"]);d!=null&&u(e,["thought"],d);const f=a(t,["thoughtSignature"]);f!=null&&u(e,["thoughtSignature"],f);const m=a(t,["videoMetadata"]);return m!=null&&u(e,["videoMetadata"],m),e}function Sl(t){const e={},n=a(t,["category"]);if(n!=null&&u(e,["category"],n),a(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=a(t,["threshold"]);return s!=null&&u(e,["threshold"],s),e}function Cl(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>f)),u(e,["functionDeclarations"],d)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=a(t,["googleSearchRetrieval"]);s!=null&&u(e,["googleSearchRetrieval"],s);const i=a(t,["googleMaps"]);i!=null&&u(e,["googleMaps"],ml(i));const r=a(t,["computerUse"]);r!=null&&u(e,["computerUse"],r);const o=a(t,["codeExecution"]);if(o!=null&&u(e,["codeExecution"],o),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(t,["googleSearch"]);l!=null&&u(e,["googleSearch"],pl(l));const h=a(t,["urlContext"]);return h!=null&&u(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Re;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_RAG_STORES="ragStores",t.PAGED_ITEM_DOCUMENTS="documents"})(Re||(Re={}));class mt{constructor(e,n,s,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,s,i)}init(e,n,s){var i,r;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n?.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!s||Object.keys(s).length===0?o={config:{}}:typeof s=="object"?o=Object.assign({},s):o=s,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(r=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Nl extends ke{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new mt(Re.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=ti(this.apiClient,e),s=n._url,i=I("{model}:batchGenerateContent",s),l=n.batch.inputConfig.requests,h=l.requests,d=[];for(const f of h){const m=Object.assign({},f);if(m.systemInstruction){const p=m.systemInstruction;delete m.systemInstruction;const g=m.request;g.systemInstruction=p,m.request=g}d.push(m)}return l.requests=d,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const s=n?Object.assign({},n):{},i=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${i}`),s.dest===void 0){const r=this.getGcsUri(e),o=this.getBigqueryUri(e);if(r)r.endsWith(".jsonl")?s.dest=`${r.slice(0,-6)}/dest`:s.dest=`${r}_dest_${i}`;else if(o)s.dest=`${o}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Za(this.apiClient,e);return l=I("batchPredictionJobs",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>hn(f))}else{const d=ti(this.apiClient,e);return l=I("{model}:batchGenerateContent",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>It(f))}}async createEmbeddingsInternal(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=tl(this.apiClient,e);return r=I("{model}:asyncBatchEmbedContent",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),i.then(h=>It(h))}}async get(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=fl(this.apiClient,e);return l=I("batchPredictionJobs/{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>hn(f))}else{const d=hl(this.apiClient,e);return l=I("batches/{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>It(f))}}async cancel(e){var n,s,i,r;let o="",l={};if(this.apiClient.isVertexAI()){const h=Ka(this.apiClient,e);o=I("batchPredictionJobs/{name}:cancel",h._url),l=h._query,delete h._url,delete h._query,await this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const h=Wa(this.apiClient,e);o=I("batches/{name}:cancel",h._url),l=h._query,delete h._url,delete h._query,await this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=_l(e);return l=I("batchPredictionJobs",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=El(f),p=new Qs;return Object.assign(p,m),p})}else{const d=wl(e);return l=I("batches",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=bl(f),p=new Qs;return Object.assign(p,m),p})}}async delete(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=sl(this.apiClient,e);return l=I("batchPredictionJobs/{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>rl(f))}else{const d=nl(this.apiClient,e);return l=I("batches/{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>il(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Il(t){const e={},n=a(t,["data"]);if(n!=null&&u(e,["data"],n),a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function ni(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>zl(r))),u(e,["parts"],i)}const s=a(t,["role"]);return s!=null&&u(e,["role"],s),e}function Al(t,e){const n={},s=a(t,["ttl"]);e!==void 0&&s!=null&&u(e,["ttl"],s);const i=a(t,["expireTime"]);e!==void 0&&i!=null&&u(e,["expireTime"],i);const r=a(t,["displayName"]);e!==void 0&&r!=null&&u(e,["displayName"],r);const o=a(t,["contents"]);if(e!==void 0&&o!=null){let f=se(o);Array.isArray(f)&&(f=f.map(m=>ni(m))),u(e,["contents"],f)}const l=a(t,["systemInstruction"]);e!==void 0&&l!=null&&u(e,["systemInstruction"],ni(z(l)));const h=a(t,["tools"]);if(e!==void 0&&h!=null){let f=h;Array.isArray(f)&&(f=f.map(m=>Yl(m))),u(e,["tools"],f)}const d=a(t,["toolConfig"]);if(e!==void 0&&d!=null&&u(e,["toolConfig"],d),a(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Rl(t,e){const n={},s=a(t,["ttl"]);e!==void 0&&s!=null&&u(e,["ttl"],s);const i=a(t,["expireTime"]);e!==void 0&&i!=null&&u(e,["expireTime"],i);const r=a(t,["displayName"]);e!==void 0&&r!=null&&u(e,["displayName"],r);const o=a(t,["contents"]);if(e!==void 0&&o!=null){let m=se(o);Array.isArray(m)&&(m=m.map(p=>p)),u(e,["contents"],m)}const l=a(t,["systemInstruction"]);e!==void 0&&l!=null&&u(e,["systemInstruction"],z(l));const h=a(t,["tools"]);if(e!==void 0&&h!=null){let m=h;Array.isArray(m)&&(m=m.map(p=>Ql(p))),u(e,["tools"],m)}const d=a(t,["toolConfig"]);e!==void 0&&d!=null&&u(e,["toolConfig"],d);const f=a(t,["kmsKeyName"]);return e!==void 0&&f!=null&&u(e,["encryption_spec","kmsKeyName"],f),n}function Pl(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["model"],Yi(t,s));const i=a(e,["config"]);return i!=null&&Al(i,n),n}function kl(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["model"],Yi(t,s));const i=a(e,["config"]);return i!=null&&Rl(i,n),n}function Ml(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],he(t,s)),n}function Ul(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],he(t,s)),n}function Dl(t){const e={},n=a(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function Ll(t){const e={},n=a(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function Fl(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function jl(t){const e={};if(a(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(t,["description"]);n!=null&&u(e,["description"],n);const s=a(t,["name"]);s!=null&&u(e,["name"],s);const i=a(t,["parameters"]);i!=null&&u(e,["parameters"],i);const r=a(t,["parametersJsonSchema"]);r!=null&&u(e,["parametersJsonSchema"],r);const o=a(t,["response"]);o!=null&&u(e,["response"],o);const l=a(t,["responseJsonSchema"]);return l!=null&&u(e,["responseJsonSchema"],l),e}function $l(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],he(t,s)),n}function Ol(t,e){const n={},s=a(e,["name"]);return s!=null&&u(n,["_url","name"],he(t,s)),n}function ql(t){const e={};if(a(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function Vl(t){const e={};if(a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=a(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function Gl(t,e){const n={},s=a(t,["pageSize"]);e!==void 0&&s!=null&&u(e,["_query","pageSize"],s);const i=a(t,["pageToken"]);return e!==void 0&&i!=null&&u(e,["_query","pageToken"],i),n}function Bl(t,e){const n={},s=a(t,["pageSize"]);e!==void 0&&s!=null&&u(e,["_query","pageSize"],s);const i=a(t,["pageToken"]);return e!==void 0&&i!=null&&u(e,["_query","pageToken"],i),n}function Hl(t){const e={},n=a(t,["config"]);return n!=null&&Gl(n,e),e}function Jl(t){const e={},n=a(t,["config"]);return n!=null&&Bl(n,e),e}function Wl(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["nextPageToken"]);s!=null&&u(e,["nextPageToken"],s);const i=a(t,["cachedContents"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),u(e,["cachedContents"],r)}return e}function Kl(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["nextPageToken"]);s!=null&&u(e,["nextPageToken"],s);const i=a(t,["cachedContents"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),u(e,["cachedContents"],r)}return e}function zl(t){const e={},n=a(t,["functionCall"]);n!=null&&u(e,["functionCall"],n);const s=a(t,["codeExecutionResult"]);s!=null&&u(e,["codeExecutionResult"],s);const i=a(t,["executableCode"]);i!=null&&u(e,["executableCode"],i);const r=a(t,["fileData"]);r!=null&&u(e,["fileData"],Fl(r));const o=a(t,["functionResponse"]);o!=null&&u(e,["functionResponse"],o);const l=a(t,["inlineData"]);l!=null&&u(e,["inlineData"],Il(l));const h=a(t,["text"]);h!=null&&u(e,["text"],h);const d=a(t,["thought"]);d!=null&&u(e,["thought"],d);const f=a(t,["thoughtSignature"]);f!=null&&u(e,["thoughtSignature"],f);const m=a(t,["videoMetadata"]);return m!=null&&u(e,["videoMetadata"],m),e}function Yl(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>f)),u(e,["functionDeclarations"],d)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=a(t,["googleSearchRetrieval"]);s!=null&&u(e,["googleSearchRetrieval"],s);const i=a(t,["googleMaps"]);i!=null&&u(e,["googleMaps"],ql(i));const r=a(t,["computerUse"]);r!=null&&u(e,["computerUse"],r);const o=a(t,["codeExecution"]);if(o!=null&&u(e,["codeExecution"],o),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(t,["googleSearch"]);l!=null&&u(e,["googleSearch"],Vl(l));const h=a(t,["urlContext"]);return h!=null&&u(e,["urlContext"],h),e}function Ql(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>jl(p))),u(e,["functionDeclarations"],m)}const s=a(t,["retrieval"]);s!=null&&u(e,["retrieval"],s);const i=a(t,["googleSearchRetrieval"]);i!=null&&u(e,["googleSearchRetrieval"],i);const r=a(t,["googleMaps"]);r!=null&&u(e,["googleMaps"],r);const o=a(t,["computerUse"]);o!=null&&u(e,["computerUse"],o);const l=a(t,["codeExecution"]);l!=null&&u(e,["codeExecution"],l);const h=a(t,["enterpriseWebSearch"]);h!=null&&u(e,["enterpriseWebSearch"],h);const d=a(t,["googleSearch"]);d!=null&&u(e,["googleSearch"],d);const f=a(t,["urlContext"]);return f!=null&&u(e,["urlContext"],f),e}function Xl(t,e){const n={},s=a(t,["ttl"]);e!==void 0&&s!=null&&u(e,["ttl"],s);const i=a(t,["expireTime"]);return e!==void 0&&i!=null&&u(e,["expireTime"],i),n}function Zl(t,e){const n={},s=a(t,["ttl"]);e!==void 0&&s!=null&&u(e,["ttl"],s);const i=a(t,["expireTime"]);return e!==void 0&&i!=null&&u(e,["expireTime"],i),n}function eu(t,e){const n={},s=a(e,["name"]);s!=null&&u(n,["_url","name"],he(t,s));const i=a(e,["config"]);return i!=null&&Xl(i,n),n}function tu(t,e){const n={},s=a(e,["name"]);s!=null&&u(n,["_url","name"],he(t,s));const i=a(e,["config"]);return i!=null&&Zl(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nu extends ke{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new mt(Re.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(n),n)}async create(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=kl(this.apiClient,e);return l=I("cachedContents",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const d=Pl(this.apiClient,e);return l=I("cachedContents",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Ol(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const d=$l(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Ul(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Ll(f),p=new zs;return Object.assign(p,m),p})}else{const d=Ml(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Dl(f),p=new zs;return Object.assign(p,m),p})}}async update(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=tu(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>f)}else{const d=eu(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async listInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Jl(e);return l=I("cachedContents",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Kl(f),p=new Ys;return Object.assign(p,m),p})}else{const d=Hl(e);return l=I("cachedContents",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Wl(f),p=new Ys;return Object.assign(p,m),p})}}}function si(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function j(t){return this instanceof j?(this.v=t,this):new j(t)}function Be(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),i,r=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(g){return function(y){return Promise.resolve(y).then(g,m)}}function l(g,y){s[g]&&(i[g]=function(v){return new Promise(function(x,w){r.push([g,v,x,w])>1||h(g,v)})},y&&(i[g]=y(i[g])))}function h(g,y){try{d(s[g](y))}catch(v){p(r[0][3],v)}}function d(g){g.value instanceof j?Promise.resolve(g.value.v).then(f,m):p(r[0][2],g)}function f(g){h("next",g)}function m(g){h("throw",g)}function p(g,y){g(y),r.shift(),r.length&&h(r[0][0],r[0][1])}}function ot(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof si=="function"?si(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(r){n[r]=t[r]&&function(o){return new Promise(function(l,h){o=t[r](o),i(l,h,o.done,o.value)})}}function i(r,o,l,h){Promise.resolve(h).then(function(d){r({value:d,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function su(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:ur(n)}function ur(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function iu(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function ii(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let s=0;for(;s<n;)if(t[s].role==="user")e.push(t[s]),s++;else{const i=[];let r=!0;for(;s<n&&t[s].role==="model";)i.push(t[s]),r&&!ur(t[s])&&(r=!1),s++;r?e.push(...i):e.pop()}return e}class ru{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new ou(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class ou{constructor(e,n,s,i={},r=[]){this.apiClient=e,this.modelsModule=n,this.model=s,this.config=i,this.history=r,this.sendPromise=Promise.resolve(),iu(r)}async sendMessage(e){var n;await this.sendPromise;const s=z(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var r,o,l;const h=await i,d=(o=(r=h.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content,f=h.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let p=[];f!=null&&(p=(l=f.slice(m))!==null&&l!==void 0?l:[]);const g=d?[d]:[];this.recordHistory(s,g,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const s=z(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const r=await i;return this.processStreamResponse(r,s)}getHistory(e=!1){const n=e?ii(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var s,i;return Be(this,arguments,function*(){var o,l,h,d;const f=[];try{for(var m=!0,p=ot(e),g;g=yield j(p.next()),o=g.done,!o;m=!0){d=g.value,m=!1;const y=d;if(su(y)){const v=(i=(s=y.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content;v!==void 0&&f.push(v)}yield yield j(y)}}catch(y){l={error:y}}finally{try{!m&&!o&&(h=p.return)&&(yield j(h.call(p)))}finally{if(l)throw l.error}}this.recordHistory(n,f)})}recordHistory(e,n,s){let i=[];n.length>0&&n.every(r=>r.role!==void 0)?i=n:i.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...ii(s)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vt extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Vt.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function au(t){const e={},n=a(t,["file"]);return n!=null&&u(e,["file"],n),e}function lu(t){const e={},n=a(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function uu(t){const e={},n=a(t,["name"]);return n!=null&&u(e,["_url","file"],nr(n)),e}function cu(t){const e={},n=a(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function du(t){const e={},n=a(t,["name"]);return n!=null&&u(e,["_url","file"],nr(n)),e}function hu(t,e){const n={},s=a(t,["pageSize"]);e!==void 0&&s!=null&&u(e,["_query","pageSize"],s);const i=a(t,["pageToken"]);return e!==void 0&&i!=null&&u(e,["_query","pageToken"],i),n}function fu(t){const e={},n=a(t,["config"]);return n!=null&&hu(n,e),e}function mu(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["nextPageToken"]);s!=null&&u(e,["nextPageToken"],s);const i=a(t,["files"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),u(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pu extends ke{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new mt(Re.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=fu(e);return r=I("files",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:h.headers},f})),i.then(h=>{const d=mu(h),f=new Ca;return Object.assign(f,d),f})}}async createInternal(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=au(e);return r=I("upload/v1beta/files",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),i.then(h=>{const d=lu(h),f=new Na;return Object.assign(f,d),f})}}async get(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=du(e);return r=I("files/{file}",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=uu(e);return r=I("files/{file}",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:h.headers},f})),i.then(h=>{const d=cu(h),f=new Ia;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function At(t){const e={},n=a(t,["data"]);if(n!=null&&u(e,["data"],n),a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function gu(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Pu(r))),u(e,["parts"],i)}const s=a(t,["role"]);return s!=null&&u(e,["role"],s),e}function yu(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function vu(t){const e={};if(a(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(t,["description"]);n!=null&&u(e,["description"],n);const s=a(t,["name"]);s!=null&&u(e,["name"],s);const i=a(t,["parameters"]);i!=null&&u(e,["parameters"],i);const r=a(t,["parametersJsonSchema"]);r!=null&&u(e,["parametersJsonSchema"],r);const o=a(t,["response"]);o!=null&&u(e,["response"],o);const l=a(t,["responseJsonSchema"]);return l!=null&&u(e,["responseJsonSchema"],l),e}function xu(t){const e={},n=a(t,["modelSelectionConfig"]);n!=null&&u(e,["modelConfig"],n);const s=a(t,["audioTimestamp"]);s!=null&&u(e,["audioTimestamp"],s);const i=a(t,["candidateCount"]);i!=null&&u(e,["candidateCount"],i);const r=a(t,["enableAffectiveDialog"]);r!=null&&u(e,["enableAffectiveDialog"],r);const o=a(t,["frequencyPenalty"]);o!=null&&u(e,["frequencyPenalty"],o);const l=a(t,["logprobs"]);l!=null&&u(e,["logprobs"],l);const h=a(t,["maxOutputTokens"]);h!=null&&u(e,["maxOutputTokens"],h);const d=a(t,["mediaResolution"]);d!=null&&u(e,["mediaResolution"],d);const f=a(t,["presencePenalty"]);f!=null&&u(e,["presencePenalty"],f);const m=a(t,["responseJsonSchema"]);m!=null&&u(e,["responseJsonSchema"],m);const p=a(t,["responseLogprobs"]);p!=null&&u(e,["responseLogprobs"],p);const g=a(t,["responseMimeType"]);g!=null&&u(e,["responseMimeType"],g);const y=a(t,["responseModalities"]);y!=null&&u(e,["responseModalities"],y);const v=a(t,["responseSchema"]);v!=null&&u(e,["responseSchema"],v);const x=a(t,["routingConfig"]);x!=null&&u(e,["routingConfig"],x);const w=a(t,["seed"]);w!=null&&u(e,["seed"],w);const _=a(t,["speechConfig"]);_!=null&&u(e,["speechConfig"],cr(_));const b=a(t,["stopSequences"]);b!=null&&u(e,["stopSequences"],b);const T=a(t,["temperature"]);T!=null&&u(e,["temperature"],T);const S=a(t,["thinkingConfig"]);S!=null&&u(e,["thinkingConfig"],S);const E=a(t,["topK"]);E!=null&&u(e,["topK"],E);const N=a(t,["topP"]);if(N!=null&&u(e,["topP"],N),a(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function wu(t){const e={};if(a(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function _u(t){const e={};if(a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=a(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function bu(t,e){const n={},s=a(t,["generationConfig"]);e!==void 0&&s!=null&&u(e,["setup","generationConfig"],s);const i=a(t,["responseModalities"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig","responseModalities"],i);const r=a(t,["temperature"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig","temperature"],r);const o=a(t,["topP"]);e!==void 0&&o!=null&&u(e,["setup","generationConfig","topP"],o);const l=a(t,["topK"]);e!==void 0&&l!=null&&u(e,["setup","generationConfig","topK"],l);const h=a(t,["maxOutputTokens"]);e!==void 0&&h!=null&&u(e,["setup","generationConfig","maxOutputTokens"],h);const d=a(t,["mediaResolution"]);e!==void 0&&d!=null&&u(e,["setup","generationConfig","mediaResolution"],d);const f=a(t,["seed"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","seed"],f);const m=a(t,["speechConfig"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","speechConfig"],Un(m));const p=a(t,["thinkingConfig"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","thinkingConfig"],p);const g=a(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=a(t,["systemInstruction"]);e!==void 0&&y!=null&&u(e,["setup","systemInstruction"],gu(z(y)));const v=a(t,["tools"]);if(e!==void 0&&v!=null){let E=Ye(v);Array.isArray(E)&&(E=E.map(N=>Mu(ze(N)))),u(e,["setup","tools"],E)}const x=a(t,["sessionResumption"]);e!==void 0&&x!=null&&u(e,["setup","sessionResumption"],ku(x));const w=a(t,["inputAudioTranscription"]);e!==void 0&&w!=null&&u(e,["setup","inputAudioTranscription"],w);const _=a(t,["outputAudioTranscription"]);e!==void 0&&_!=null&&u(e,["setup","outputAudioTranscription"],_);const b=a(t,["realtimeInputConfig"]);e!==void 0&&b!=null&&u(e,["setup","realtimeInputConfig"],b);const T=a(t,["contextWindowCompression"]);e!==void 0&&T!=null&&u(e,["setup","contextWindowCompression"],T);const S=a(t,["proactivity"]);return e!==void 0&&S!=null&&u(e,["setup","proactivity"],S),n}function Eu(t,e){const n={},s=a(t,["generationConfig"]);e!==void 0&&s!=null&&u(e,["setup","generationConfig"],xu(s));const i=a(t,["responseModalities"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig","responseModalities"],i);const r=a(t,["temperature"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig","temperature"],r);const o=a(t,["topP"]);e!==void 0&&o!=null&&u(e,["setup","generationConfig","topP"],o);const l=a(t,["topK"]);e!==void 0&&l!=null&&u(e,["setup","generationConfig","topK"],l);const h=a(t,["maxOutputTokens"]);e!==void 0&&h!=null&&u(e,["setup","generationConfig","maxOutputTokens"],h);const d=a(t,["mediaResolution"]);e!==void 0&&d!=null&&u(e,["setup","generationConfig","mediaResolution"],d);const f=a(t,["seed"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","seed"],f);const m=a(t,["speechConfig"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","speechConfig"],cr(Un(m)));const p=a(t,["thinkingConfig"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","thinkingConfig"],p);const g=a(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=a(t,["systemInstruction"]);e!==void 0&&y!=null&&u(e,["setup","systemInstruction"],z(y));const v=a(t,["tools"]);if(e!==void 0&&v!=null){let E=Ye(v);Array.isArray(E)&&(E=E.map(N=>Uu(ze(N)))),u(e,["setup","tools"],E)}const x=a(t,["sessionResumption"]);e!==void 0&&x!=null&&u(e,["setup","sessionResumption"],x);const w=a(t,["inputAudioTranscription"]);e!==void 0&&w!=null&&u(e,["setup","inputAudioTranscription"],w);const _=a(t,["outputAudioTranscription"]);e!==void 0&&_!=null&&u(e,["setup","outputAudioTranscription"],_);const b=a(t,["realtimeInputConfig"]);e!==void 0&&b!=null&&u(e,["setup","realtimeInputConfig"],b);const T=a(t,["contextWindowCompression"]);e!==void 0&&T!=null&&u(e,["setup","contextWindowCompression"],T);const S=a(t,["proactivity"]);return e!==void 0&&S!=null&&u(e,["setup","proactivity"],S),n}function Tu(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["setup","model"],L(t,s));const i=a(e,["config"]);return i!=null&&u(n,["config"],bu(i,n)),n}function Su(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["setup","model"],L(t,s));const i=a(e,["config"]);return i!=null&&u(n,["config"],Eu(i,n)),n}function Cu(t){const e={},n=a(t,["musicGenerationConfig"]);return n!=null&&u(e,["musicGenerationConfig"],n),e}function Nu(t){const e={},n=a(t,["weightedPrompts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),u(e,["weightedPrompts"],s)}return e}function Iu(t){const e={},n=a(t,["media"]);if(n!=null){let d=Qi(n);Array.isArray(d)&&(d=d.map(f=>At(f))),u(e,["mediaChunks"],d)}const s=a(t,["audio"]);s!=null&&u(e,["audio"],At(Zi(s)));const i=a(t,["audioStreamEnd"]);i!=null&&u(e,["audioStreamEnd"],i);const r=a(t,["video"]);r!=null&&u(e,["video"],At(Xi(r)));const o=a(t,["text"]);o!=null&&u(e,["text"],o);const l=a(t,["activityStart"]);l!=null&&u(e,["activityStart"],l);const h=a(t,["activityEnd"]);return h!=null&&u(e,["activityEnd"],h),e}function Au(t){const e={},n=a(t,["media"]);if(n!=null){let d=Qi(n);Array.isArray(d)&&(d=d.map(f=>f)),u(e,["mediaChunks"],d)}const s=a(t,["audio"]);s!=null&&u(e,["audio"],Zi(s));const i=a(t,["audioStreamEnd"]);i!=null&&u(e,["audioStreamEnd"],i);const r=a(t,["video"]);r!=null&&u(e,["video"],Xi(r));const o=a(t,["text"]);o!=null&&u(e,["text"],o);const l=a(t,["activityStart"]);l!=null&&u(e,["activityStart"],l);const h=a(t,["activityEnd"]);return h!=null&&u(e,["activityEnd"],h),e}function Ru(t){const e={},n=a(t,["setupComplete"]);n!=null&&u(e,["setupComplete"],n);const s=a(t,["serverContent"]);s!=null&&u(e,["serverContent"],s);const i=a(t,["toolCall"]);i!=null&&u(e,["toolCall"],i);const r=a(t,["toolCallCancellation"]);r!=null&&u(e,["toolCallCancellation"],r);const o=a(t,["usageMetadata"]);o!=null&&u(e,["usageMetadata"],Du(o));const l=a(t,["goAway"]);l!=null&&u(e,["goAway"],l);const h=a(t,["sessionResumptionUpdate"]);return h!=null&&u(e,["sessionResumptionUpdate"],h),e}function Pu(t){const e={},n=a(t,["functionCall"]);n!=null&&u(e,["functionCall"],n);const s=a(t,["codeExecutionResult"]);s!=null&&u(e,["codeExecutionResult"],s);const i=a(t,["executableCode"]);i!=null&&u(e,["executableCode"],i);const r=a(t,["fileData"]);r!=null&&u(e,["fileData"],yu(r));const o=a(t,["functionResponse"]);o!=null&&u(e,["functionResponse"],o);const l=a(t,["inlineData"]);l!=null&&u(e,["inlineData"],At(l));const h=a(t,["text"]);h!=null&&u(e,["text"],h);const d=a(t,["thought"]);d!=null&&u(e,["thought"],d);const f=a(t,["thoughtSignature"]);f!=null&&u(e,["thoughtSignature"],f);const m=a(t,["videoMetadata"]);return m!=null&&u(e,["videoMetadata"],m),e}function ku(t){const e={},n=a(t,["handle"]);if(n!=null&&u(e,["handle"],n),a(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function cr(t){const e={},n=a(t,["languageCode"]);n!=null&&u(e,["languageCode"],n);const s=a(t,["voiceConfig"]);if(s!=null&&u(e,["voiceConfig"],s),a(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function Mu(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>f)),u(e,["functionDeclarations"],d)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=a(t,["googleSearchRetrieval"]);s!=null&&u(e,["googleSearchRetrieval"],s);const i=a(t,["googleMaps"]);i!=null&&u(e,["googleMaps"],wu(i));const r=a(t,["computerUse"]);r!=null&&u(e,["computerUse"],r);const o=a(t,["codeExecution"]);if(o!=null&&u(e,["codeExecution"],o),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(t,["googleSearch"]);l!=null&&u(e,["googleSearch"],_u(l));const h=a(t,["urlContext"]);return h!=null&&u(e,["urlContext"],h),e}function Uu(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>vu(p))),u(e,["functionDeclarations"],m)}const s=a(t,["retrieval"]);s!=null&&u(e,["retrieval"],s);const i=a(t,["googleSearchRetrieval"]);i!=null&&u(e,["googleSearchRetrieval"],i);const r=a(t,["googleMaps"]);r!=null&&u(e,["googleMaps"],r);const o=a(t,["computerUse"]);o!=null&&u(e,["computerUse"],o);const l=a(t,["codeExecution"]);l!=null&&u(e,["codeExecution"],l);const h=a(t,["enterpriseWebSearch"]);h!=null&&u(e,["enterpriseWebSearch"],h);const d=a(t,["googleSearch"]);d!=null&&u(e,["googleSearch"],d);const f=a(t,["urlContext"]);return f!=null&&u(e,["urlContext"],f),e}function Du(t){const e={},n=a(t,["promptTokenCount"]);n!=null&&u(e,["promptTokenCount"],n);const s=a(t,["cachedContentTokenCount"]);s!=null&&u(e,["cachedContentTokenCount"],s);const i=a(t,["candidatesTokenCount"]);i!=null&&u(e,["responseTokenCount"],i);const r=a(t,["toolUsePromptTokenCount"]);r!=null&&u(e,["toolUsePromptTokenCount"],r);const o=a(t,["thoughtsTokenCount"]);o!=null&&u(e,["thoughtsTokenCount"],o);const l=a(t,["totalTokenCount"]);l!=null&&u(e,["totalTokenCount"],l);const h=a(t,["promptTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(y=>y)),u(e,["promptTokensDetails"],g)}const d=a(t,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(y=>y)),u(e,["cacheTokensDetails"],g)}const f=a(t,["candidatesTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(y=>y)),u(e,["responseTokensDetails"],g)}const m=a(t,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(y=>y)),u(e,["toolUsePromptTokensDetails"],g)}const p=a(t,["trafficType"]);return p!=null&&u(e,["trafficType"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lu(t){const e={},n=a(t,["data"]);if(n!=null&&u(e,["data"],n),a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function Fu(t){const e={},n=a(t,["content"]);n!=null&&u(e,["content"],n);const s=a(t,["citationMetadata"]);s!=null&&u(e,["citationMetadata"],ju(s));const i=a(t,["tokenCount"]);i!=null&&u(e,["tokenCount"],i);const r=a(t,["finishReason"]);r!=null&&u(e,["finishReason"],r);const o=a(t,["avgLogprobs"]);o!=null&&u(e,["avgLogprobs"],o);const l=a(t,["groundingMetadata"]);l!=null&&u(e,["groundingMetadata"],l);const h=a(t,["index"]);h!=null&&u(e,["index"],h);const d=a(t,["logprobsResult"]);d!=null&&u(e,["logprobsResult"],d);const f=a(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>g)),u(e,["safetyRatings"],p)}const m=a(t,["urlContextMetadata"]);return m!=null&&u(e,["urlContextMetadata"],m),e}function ju(t){const e={},n=a(t,["citationSources"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),u(e,["citations"],s)}return e}function $u(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["contents"]);if(i!=null){let r=se(i);Array.isArray(r)&&(r=r.map(o=>o)),u(n,["contents"],r)}return n}function Ou(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["tokensInfo"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>r)),u(e,["tokensInfo"],i)}return e}function qu(t){const e={},n=a(t,["values"]);n!=null&&u(e,["values"],n);const s=a(t,["statistics"]);return s!=null&&u(e,["statistics"],Vu(s)),e}function Vu(t){const e={},n=a(t,["truncated"]);n!=null&&u(e,["truncated"],n);const s=a(t,["token_count"]);return s!=null&&u(e,["tokenCount"],s),e}function Gt(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>Wc(r))),u(e,["parts"],i)}const s=a(t,["role"]);return s!=null&&u(e,["role"],s),e}function Gu(t){const e={},n=a(t,["controlType"]);n!=null&&u(e,["controlType"],n);const s=a(t,["enableControlImageComputation"]);return s!=null&&u(e,["computeControl"],s),e}function Bu(t){const e={};if(a(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(a(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(a(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Hu(t,e){const n={},s=a(t,["systemInstruction"]);e!==void 0&&s!=null&&u(e,["systemInstruction"],z(s));const i=a(t,["tools"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>pr(l))),u(e,["tools"],o)}const r=a(t,["generationConfig"]);return e!==void 0&&r!=null&&u(e,["generationConfig"],Uc(r)),n}function Ju(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["contents"]);if(i!=null){let o=se(i);Array.isArray(o)&&(o=o.map(l=>Gt(l))),u(n,["contents"],o)}const r=a(e,["config"]);return r!=null&&Bu(r),n}function Wu(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["contents"]);if(i!=null){let o=se(i);Array.isArray(o)&&(o=o.map(l=>l)),u(n,["contents"],o)}const r=a(e,["config"]);return r!=null&&Hu(r,n),n}function Ku(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["totalTokens"]);s!=null&&u(e,["totalTokens"],s);const i=a(t,["cachedContentTokenCount"]);return i!=null&&u(e,["cachedContentTokenCount"],i),e}function zu(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["totalTokens"]);return s!=null&&u(e,["totalTokens"],s),e}function Yu(t,e){const n={},s=a(e,["model"]);return s!=null&&u(n,["_url","name"],L(t,s)),n}function Qu(t,e){const n={},s=a(e,["model"]);return s!=null&&u(n,["_url","name"],L(t,s)),n}function Xu(t){const e={},n=a(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function Zu(t){const e={},n=a(t,["sdkHttpResponse"]);return n!=null&&u(e,["sdkHttpResponse"],n),e}function ec(t,e){const n={},s=a(t,["outputGcsUri"]);e!==void 0&&s!=null&&u(e,["parameters","storageUri"],s);const i=a(t,["negativePrompt"]);e!==void 0&&i!=null&&u(e,["parameters","negativePrompt"],i);const r=a(t,["numberOfImages"]);e!==void 0&&r!=null&&u(e,["parameters","sampleCount"],r);const o=a(t,["aspectRatio"]);e!==void 0&&o!=null&&u(e,["parameters","aspectRatio"],o);const l=a(t,["guidanceScale"]);e!==void 0&&l!=null&&u(e,["parameters","guidanceScale"],l);const h=a(t,["seed"]);e!==void 0&&h!=null&&u(e,["parameters","seed"],h);const d=a(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&u(e,["parameters","safetySetting"],d);const f=a(t,["personGeneration"]);e!==void 0&&f!=null&&u(e,["parameters","personGeneration"],f);const m=a(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&u(e,["parameters","includeSafetyAttributes"],m);const p=a(t,["includeRaiReason"]);e!==void 0&&p!=null&&u(e,["parameters","includeRaiReason"],p);const g=a(t,["language"]);e!==void 0&&g!=null&&u(e,["parameters","language"],g);const y=a(t,["outputMimeType"]);e!==void 0&&y!=null&&u(e,["parameters","outputOptions","mimeType"],y);const v=a(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&u(e,["parameters","outputOptions","compressionQuality"],v);const x=a(t,["addWatermark"]);e!==void 0&&x!=null&&u(e,["parameters","addWatermark"],x);const w=a(t,["labels"]);e!==void 0&&w!=null&&u(e,["labels"],w);const _=a(t,["editMode"]);e!==void 0&&_!=null&&u(e,["parameters","editMode"],_);const b=a(t,["baseSteps"]);return e!==void 0&&b!=null&&u(e,["parameters","editConfig","baseSteps"],b),n}function tc(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["prompt"]);i!=null&&u(n,["instances[0]","prompt"],i);const r=a(e,["referenceImages"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(h=>Zc(h))),u(n,["instances[0]","referenceImages"],l)}const o=a(e,["config"]);return o!=null&&ec(o,n),n}function nc(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>Bt(r))),u(e,["generatedImages"],i)}return e}function sc(t,e){const n={},s=a(t,["taskType"]);e!==void 0&&s!=null&&u(e,["requests[]","taskType"],s);const i=a(t,["title"]);e!==void 0&&i!=null&&u(e,["requests[]","title"],i);const r=a(t,["outputDimensionality"]);if(e!==void 0&&r!=null&&u(e,["requests[]","outputDimensionality"],r),a(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(a(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ic(t,e){const n={},s=a(t,["taskType"]);e!==void 0&&s!=null&&u(e,["instances[]","task_type"],s);const i=a(t,["title"]);e!==void 0&&i!=null&&u(e,["instances[]","title"],i);const r=a(t,["outputDimensionality"]);e!==void 0&&r!=null&&u(e,["parameters","outputDimensionality"],r);const o=a(t,["mimeType"]);e!==void 0&&o!=null&&u(e,["instances[]","mimeType"],o);const l=a(t,["autoTruncate"]);return e!==void 0&&l!=null&&u(e,["parameters","autoTruncate"],l),n}function rc(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["contents"]);if(i!=null){let l=Pn(t,i);Array.isArray(l)&&(l=l.map(h=>h)),u(n,["requests[]","content"],l)}const r=a(e,["config"]);r!=null&&sc(r,n);const o=a(e,["model"]);return o!==void 0&&u(n,["requests[]","model"],L(t,o)),n}function oc(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["contents"]);if(i!=null){let o=Pn(t,i);Array.isArray(o)&&(o=o.map(l=>l)),u(n,["instances[]","content"],o)}const r=a(e,["config"]);return r!=null&&ic(r,n),n}function ac(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["embeddings"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),u(e,["embeddings"],r)}const i=a(t,["metadata"]);return i!=null&&u(e,["metadata"],i),e}function lc(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["predictions[]","embeddings"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>qu(o))),u(e,["embeddings"],r)}const i=a(t,["metadata"]);return i!=null&&u(e,["metadata"],i),e}function uc(t){const e={},n=a(t,["endpoint"]);n!=null&&u(e,["name"],n);const s=a(t,["deployedModelId"]);return s!=null&&u(e,["deployedModelId"],s),e}function cc(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function dc(t){const e={};if(a(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(t,["description"]);n!=null&&u(e,["description"],n);const s=a(t,["name"]);s!=null&&u(e,["name"],s);const i=a(t,["parameters"]);i!=null&&u(e,["parameters"],i);const r=a(t,["parametersJsonSchema"]);r!=null&&u(e,["parametersJsonSchema"],r);const o=a(t,["response"]);o!=null&&u(e,["response"],o);const l=a(t,["responseJsonSchema"]);return l!=null&&u(e,["responseJsonSchema"],l),e}function hc(t,e,n){const s={},i=a(e,["systemInstruction"]);n!==void 0&&i!=null&&u(n,["systemInstruction"],Gt(z(i)));const r=a(e,["temperature"]);r!=null&&u(s,["temperature"],r);const o=a(e,["topP"]);o!=null&&u(s,["topP"],o);const l=a(e,["topK"]);l!=null&&u(s,["topK"],l);const h=a(e,["candidateCount"]);h!=null&&u(s,["candidateCount"],h);const d=a(e,["maxOutputTokens"]);d!=null&&u(s,["maxOutputTokens"],d);const f=a(e,["stopSequences"]);f!=null&&u(s,["stopSequences"],f);const m=a(e,["responseLogprobs"]);m!=null&&u(s,["responseLogprobs"],m);const p=a(e,["logprobs"]);p!=null&&u(s,["logprobs"],p);const g=a(e,["presencePenalty"]);g!=null&&u(s,["presencePenalty"],g);const y=a(e,["frequencyPenalty"]);y!=null&&u(s,["frequencyPenalty"],y);const v=a(e,["seed"]);v!=null&&u(s,["seed"],v);const x=a(e,["responseMimeType"]);x!=null&&u(s,["responseMimeType"],x);const w=a(e,["responseSchema"]);w!=null&&u(s,["responseSchema"],kn(w));const _=a(e,["responseJsonSchema"]);if(_!=null&&u(s,["responseJsonSchema"],_),a(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(a(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=a(e,["safetySettings"]);if(n!==void 0&&b!=null){let $=b;Array.isArray($)&&($=$.map(te=>ed(te))),u(n,["safetySettings"],$)}const T=a(e,["tools"]);if(n!==void 0&&T!=null){let $=Ye(T);Array.isArray($)&&($=$.map(te=>od(ze(te)))),u(n,["tools"],$)}const S=a(e,["toolConfig"]);if(n!==void 0&&S!=null&&u(n,["toolConfig"],S),a(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const E=a(e,["cachedContent"]);n!==void 0&&E!=null&&u(n,["cachedContent"],he(t,E));const N=a(e,["responseModalities"]);N!=null&&u(s,["responseModalities"],N);const M=a(e,["mediaResolution"]);M!=null&&u(s,["mediaResolution"],M);const R=a(e,["speechConfig"]);if(R!=null&&u(s,["speechConfig"],Mn(R)),a(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=a(e,["thinkingConfig"]);U!=null&&u(s,["thinkingConfig"],U);const V=a(e,["imageConfig"]);return V!=null&&u(s,["imageConfig"],V),s}function fc(t,e,n){const s={},i=a(e,["systemInstruction"]);n!==void 0&&i!=null&&u(n,["systemInstruction"],z(i));const r=a(e,["temperature"]);r!=null&&u(s,["temperature"],r);const o=a(e,["topP"]);o!=null&&u(s,["topP"],o);const l=a(e,["topK"]);l!=null&&u(s,["topK"],l);const h=a(e,["candidateCount"]);h!=null&&u(s,["candidateCount"],h);const d=a(e,["maxOutputTokens"]);d!=null&&u(s,["maxOutputTokens"],d);const f=a(e,["stopSequences"]);f!=null&&u(s,["stopSequences"],f);const m=a(e,["responseLogprobs"]);m!=null&&u(s,["responseLogprobs"],m);const p=a(e,["logprobs"]);p!=null&&u(s,["logprobs"],p);const g=a(e,["presencePenalty"]);g!=null&&u(s,["presencePenalty"],g);const y=a(e,["frequencyPenalty"]);y!=null&&u(s,["frequencyPenalty"],y);const v=a(e,["seed"]);v!=null&&u(s,["seed"],v);const x=a(e,["responseMimeType"]);x!=null&&u(s,["responseMimeType"],x);const w=a(e,["responseSchema"]);w!=null&&u(s,["responseSchema"],kn(w));const _=a(e,["responseJsonSchema"]);_!=null&&u(s,["responseJsonSchema"],_);const b=a(e,["routingConfig"]);b!=null&&u(s,["routingConfig"],b);const T=a(e,["modelSelectionConfig"]);T!=null&&u(s,["modelConfig"],T);const S=a(e,["safetySettings"]);if(n!==void 0&&S!=null){let ie=S;Array.isArray(ie)&&(ie=ie.map(Ue=>Ue)),u(n,["safetySettings"],ie)}const E=a(e,["tools"]);if(n!==void 0&&E!=null){let ie=Ye(E);Array.isArray(ie)&&(ie=ie.map(Ue=>pr(ze(Ue)))),u(n,["tools"],ie)}const N=a(e,["toolConfig"]);n!==void 0&&N!=null&&u(n,["toolConfig"],N);const M=a(e,["labels"]);n!==void 0&&M!=null&&u(n,["labels"],M);const R=a(e,["cachedContent"]);n!==void 0&&R!=null&&u(n,["cachedContent"],he(t,R));const U=a(e,["responseModalities"]);U!=null&&u(s,["responseModalities"],U);const V=a(e,["mediaResolution"]);V!=null&&u(s,["mediaResolution"],V);const $=a(e,["speechConfig"]);$!=null&&u(s,["speechConfig"],mr(Mn($)));const te=a(e,["audioTimestamp"]);te!=null&&u(s,["audioTimestamp"],te);const G=a(e,["thinkingConfig"]);G!=null&&u(s,["thinkingConfig"],G);const nt=a(e,["imageConfig"]);return nt!=null&&u(s,["imageConfig"],nt),s}function ri(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["contents"]);if(i!=null){let o=se(i);Array.isArray(o)&&(o=o.map(l=>Gt(l))),u(n,["contents"],o)}const r=a(e,["config"]);return r!=null&&u(n,["generationConfig"],hc(t,r,n)),n}function oi(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["contents"]);if(i!=null){let o=se(i);Array.isArray(o)&&(o=o.map(l=>l)),u(n,["contents"],o)}const r=a(e,["config"]);return r!=null&&u(n,["generationConfig"],fc(t,r,n)),n}function ai(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["candidates"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(d=>Fu(d))),u(e,["candidates"],h)}const i=a(t,["modelVersion"]);i!=null&&u(e,["modelVersion"],i);const r=a(t,["promptFeedback"]);r!=null&&u(e,["promptFeedback"],r);const o=a(t,["responseId"]);o!=null&&u(e,["responseId"],o);const l=a(t,["usageMetadata"]);return l!=null&&u(e,["usageMetadata"],l),e}function li(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["candidates"]);if(s!=null){let d=s;Array.isArray(d)&&(d=d.map(f=>f)),u(e,["candidates"],d)}const i=a(t,["createTime"]);i!=null&&u(e,["createTime"],i);const r=a(t,["modelVersion"]);r!=null&&u(e,["modelVersion"],r);const o=a(t,["promptFeedback"]);o!=null&&u(e,["promptFeedback"],o);const l=a(t,["responseId"]);l!=null&&u(e,["responseId"],l);const h=a(t,["usageMetadata"]);return h!=null&&u(e,["usageMetadata"],h),e}function mc(t,e){const n={};if(a(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(a(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=a(t,["numberOfImages"]);e!==void 0&&s!=null&&u(e,["parameters","sampleCount"],s);const i=a(t,["aspectRatio"]);e!==void 0&&i!=null&&u(e,["parameters","aspectRatio"],i);const r=a(t,["guidanceScale"]);if(e!==void 0&&r!=null&&u(e,["parameters","guidanceScale"],r),a(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=a(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&u(e,["parameters","safetySetting"],o);const l=a(t,["personGeneration"]);e!==void 0&&l!=null&&u(e,["parameters","personGeneration"],l);const h=a(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&u(e,["parameters","includeSafetyAttributes"],h);const d=a(t,["includeRaiReason"]);e!==void 0&&d!=null&&u(e,["parameters","includeRaiReason"],d);const f=a(t,["language"]);e!==void 0&&f!=null&&u(e,["parameters","language"],f);const m=a(t,["outputMimeType"]);e!==void 0&&m!=null&&u(e,["parameters","outputOptions","mimeType"],m);const p=a(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&u(e,["parameters","outputOptions","compressionQuality"],p),a(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(a(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=a(t,["imageSize"]);if(e!==void 0&&g!=null&&u(e,["parameters","sampleImageSize"],g),a(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function pc(t,e){const n={},s=a(t,["outputGcsUri"]);e!==void 0&&s!=null&&u(e,["parameters","storageUri"],s);const i=a(t,["negativePrompt"]);e!==void 0&&i!=null&&u(e,["parameters","negativePrompt"],i);const r=a(t,["numberOfImages"]);e!==void 0&&r!=null&&u(e,["parameters","sampleCount"],r);const o=a(t,["aspectRatio"]);e!==void 0&&o!=null&&u(e,["parameters","aspectRatio"],o);const l=a(t,["guidanceScale"]);e!==void 0&&l!=null&&u(e,["parameters","guidanceScale"],l);const h=a(t,["seed"]);e!==void 0&&h!=null&&u(e,["parameters","seed"],h);const d=a(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&u(e,["parameters","safetySetting"],d);const f=a(t,["personGeneration"]);e!==void 0&&f!=null&&u(e,["parameters","personGeneration"],f);const m=a(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&u(e,["parameters","includeSafetyAttributes"],m);const p=a(t,["includeRaiReason"]);e!==void 0&&p!=null&&u(e,["parameters","includeRaiReason"],p);const g=a(t,["language"]);e!==void 0&&g!=null&&u(e,["parameters","language"],g);const y=a(t,["outputMimeType"]);e!==void 0&&y!=null&&u(e,["parameters","outputOptions","mimeType"],y);const v=a(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&u(e,["parameters","outputOptions","compressionQuality"],v);const x=a(t,["addWatermark"]);e!==void 0&&x!=null&&u(e,["parameters","addWatermark"],x);const w=a(t,["labels"]);e!==void 0&&w!=null&&u(e,["labels"],w);const _=a(t,["imageSize"]);e!==void 0&&_!=null&&u(e,["parameters","sampleImageSize"],_);const b=a(t,["enhancePrompt"]);return e!==void 0&&b!=null&&u(e,["parameters","enhancePrompt"],b),n}function gc(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["prompt"]);i!=null&&u(n,["instances[0]","prompt"],i);const r=a(e,["config"]);return r!=null&&mc(r,n),n}function yc(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["prompt"]);i!=null&&u(n,["instances[0]","prompt"],i);const r=a(e,["config"]);return r!=null&&pc(r,n),n}function vc(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Rc(o))),u(e,["generatedImages"],r)}const i=a(t,["positivePromptSafetyAttributes"]);return i!=null&&u(e,["positivePromptSafetyAttributes"],hr(i)),e}function xc(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Bt(o))),u(e,["generatedImages"],r)}const i=a(t,["positivePromptSafetyAttributes"]);return i!=null&&u(e,["positivePromptSafetyAttributes"],fr(i)),e}function wc(t,e){const n={},s=a(t,["numberOfVideos"]);if(e!==void 0&&s!=null&&u(e,["parameters","sampleCount"],s),a(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(a(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=a(t,["durationSeconds"]);if(e!==void 0&&i!=null&&u(e,["parameters","durationSeconds"],i),a(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=a(t,["aspectRatio"]);e!==void 0&&r!=null&&u(e,["parameters","aspectRatio"],r);const o=a(t,["resolution"]);e!==void 0&&o!=null&&u(e,["parameters","resolution"],o);const l=a(t,["personGeneration"]);if(e!==void 0&&l!=null&&u(e,["parameters","personGeneration"],l),a(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=a(t,["negativePrompt"]);e!==void 0&&h!=null&&u(e,["parameters","negativePrompt"],h);const d=a(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&u(e,["parameters","enhancePrompt"],d),a(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=a(t,["lastFrame"]);e!==void 0&&f!=null&&u(e,["instances[0]","lastFrame"],Ht(f));const m=a(t,["referenceImages"]);if(e!==void 0&&m!=null){let p=m;Array.isArray(p)&&(p=p.map(g=>xd(g))),u(e,["instances[0]","referenceImages"],p)}if(a(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(a(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function _c(t,e){const n={},s=a(t,["numberOfVideos"]);e!==void 0&&s!=null&&u(e,["parameters","sampleCount"],s);const i=a(t,["outputGcsUri"]);e!==void 0&&i!=null&&u(e,["parameters","storageUri"],i);const r=a(t,["fps"]);e!==void 0&&r!=null&&u(e,["parameters","fps"],r);const o=a(t,["durationSeconds"]);e!==void 0&&o!=null&&u(e,["parameters","durationSeconds"],o);const l=a(t,["seed"]);e!==void 0&&l!=null&&u(e,["parameters","seed"],l);const h=a(t,["aspectRatio"]);e!==void 0&&h!=null&&u(e,["parameters","aspectRatio"],h);const d=a(t,["resolution"]);e!==void 0&&d!=null&&u(e,["parameters","resolution"],d);const f=a(t,["personGeneration"]);e!==void 0&&f!=null&&u(e,["parameters","personGeneration"],f);const m=a(t,["pubsubTopic"]);e!==void 0&&m!=null&&u(e,["parameters","pubsubTopic"],m);const p=a(t,["negativePrompt"]);e!==void 0&&p!=null&&u(e,["parameters","negativePrompt"],p);const g=a(t,["enhancePrompt"]);e!==void 0&&g!=null&&u(e,["parameters","enhancePrompt"],g);const y=a(t,["generateAudio"]);e!==void 0&&y!=null&&u(e,["parameters","generateAudio"],y);const v=a(t,["lastFrame"]);e!==void 0&&v!=null&&u(e,["instances[0]","lastFrame"],le(v));const x=a(t,["referenceImages"]);if(e!==void 0&&x!=null){let b=x;Array.isArray(b)&&(b=b.map(T=>wd(T))),u(e,["instances[0]","referenceImages"],b)}const w=a(t,["mask"]);e!==void 0&&w!=null&&u(e,["instances[0]","mask"],vd(w));const _=a(t,["compressionQuality"]);return e!==void 0&&_!=null&&u(e,["parameters","compressionQuality"],_),n}function bc(t){const e={},n=a(t,["name"]);n!=null&&u(e,["name"],n);const s=a(t,["metadata"]);s!=null&&u(e,["metadata"],s);const i=a(t,["done"]);i!=null&&u(e,["done"],i);const r=a(t,["error"]);r!=null&&u(e,["error"],r);const o=a(t,["response","generateVideoResponse"]);return o!=null&&u(e,["response"],Cc(o)),e}function Ec(t){const e={},n=a(t,["name"]);n!=null&&u(e,["name"],n);const s=a(t,["metadata"]);s!=null&&u(e,["metadata"],s);const i=a(t,["done"]);i!=null&&u(e,["done"],i);const r=a(t,["error"]);r!=null&&u(e,["error"],r);const o=a(t,["response"]);return o!=null&&u(e,["response"],Nc(o)),e}function Tc(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["prompt"]);i!=null&&u(n,["instances[0]","prompt"],i);const r=a(e,["image"]);r!=null&&u(n,["instances[0]","image"],Ht(r));const o=a(e,["video"]);o!=null&&u(n,["instances[0]","video"],gr(o));const l=a(e,["source"]);l!=null&&Ic(l,n);const h=a(e,["config"]);return h!=null&&wc(h,n),n}function Sc(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["prompt"]);i!=null&&u(n,["instances[0]","prompt"],i);const r=a(e,["image"]);r!=null&&u(n,["instances[0]","image"],le(r));const o=a(e,["video"]);o!=null&&u(n,["instances[0]","video"],yr(o));const l=a(e,["source"]);l!=null&&Ac(l,n);const h=a(e,["config"]);return h!=null&&_c(h,n),n}function Cc(t){const e={},n=a(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>kc(o))),u(e,["generatedVideos"],r)}const s=a(t,["raiMediaFilteredCount"]);s!=null&&u(e,["raiMediaFilteredCount"],s);const i=a(t,["raiMediaFilteredReasons"]);return i!=null&&u(e,["raiMediaFilteredReasons"],i),e}function Nc(t){const e={},n=a(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>Mc(o))),u(e,["generatedVideos"],r)}const s=a(t,["raiMediaFilteredCount"]);s!=null&&u(e,["raiMediaFilteredCount"],s);const i=a(t,["raiMediaFilteredReasons"]);return i!=null&&u(e,["raiMediaFilteredReasons"],i),e}function Ic(t,e){const n={},s=a(t,["prompt"]);e!==void 0&&s!=null&&u(e,["instances[0]","prompt"],s);const i=a(t,["image"]);e!==void 0&&i!=null&&u(e,["instances[0]","image"],Ht(i));const r=a(t,["video"]);return e!==void 0&&r!=null&&u(e,["instances[0]","video"],gr(r)),n}function Ac(t,e){const n={},s=a(t,["prompt"]);e!==void 0&&s!=null&&u(e,["instances[0]","prompt"],s);const i=a(t,["image"]);e!==void 0&&i!=null&&u(e,["instances[0]","image"],le(i));const r=a(t,["video"]);return e!==void 0&&r!=null&&u(e,["instances[0]","video"],yr(r)),n}function Rc(t){const e={},n=a(t,["_self"]);n!=null&&u(e,["image"],$c(n));const s=a(t,["raiFilteredReason"]);s!=null&&u(e,["raiFilteredReason"],s);const i=a(t,["_self"]);return i!=null&&u(e,["safetyAttributes"],hr(i)),e}function Bt(t){const e={},n=a(t,["_self"]);n!=null&&u(e,["image"],dr(n));const s=a(t,["raiFilteredReason"]);s!=null&&u(e,["raiFilteredReason"],s);const i=a(t,["_self"]);i!=null&&u(e,["safetyAttributes"],fr(i));const r=a(t,["prompt"]);return r!=null&&u(e,["enhancedPrompt"],r),e}function Pc(t){const e={},n=a(t,["_self"]);n!=null&&u(e,["mask"],dr(n));const s=a(t,["labels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>r)),u(e,["labels"],i)}return e}function kc(t){const e={},n=a(t,["video"]);return n!=null&&u(e,["video"],gd(n)),e}function Mc(t){const e={},n=a(t,["_self"]);return n!=null&&u(e,["video"],yd(n)),e}function Uc(t){const e={},n=a(t,["modelSelectionConfig"]);n!=null&&u(e,["modelConfig"],n);const s=a(t,["audioTimestamp"]);s!=null&&u(e,["audioTimestamp"],s);const i=a(t,["candidateCount"]);i!=null&&u(e,["candidateCount"],i);const r=a(t,["enableAffectiveDialog"]);r!=null&&u(e,["enableAffectiveDialog"],r);const o=a(t,["frequencyPenalty"]);o!=null&&u(e,["frequencyPenalty"],o);const l=a(t,["logprobs"]);l!=null&&u(e,["logprobs"],l);const h=a(t,["maxOutputTokens"]);h!=null&&u(e,["maxOutputTokens"],h);const d=a(t,["mediaResolution"]);d!=null&&u(e,["mediaResolution"],d);const f=a(t,["presencePenalty"]);f!=null&&u(e,["presencePenalty"],f);const m=a(t,["responseJsonSchema"]);m!=null&&u(e,["responseJsonSchema"],m);const p=a(t,["responseLogprobs"]);p!=null&&u(e,["responseLogprobs"],p);const g=a(t,["responseMimeType"]);g!=null&&u(e,["responseMimeType"],g);const y=a(t,["responseModalities"]);y!=null&&u(e,["responseModalities"],y);const v=a(t,["responseSchema"]);v!=null&&u(e,["responseSchema"],v);const x=a(t,["routingConfig"]);x!=null&&u(e,["routingConfig"],x);const w=a(t,["seed"]);w!=null&&u(e,["seed"],w);const _=a(t,["speechConfig"]);_!=null&&u(e,["speechConfig"],mr(_));const b=a(t,["stopSequences"]);b!=null&&u(e,["stopSequences"],b);const T=a(t,["temperature"]);T!=null&&u(e,["temperature"],T);const S=a(t,["thinkingConfig"]);S!=null&&u(e,["thinkingConfig"],S);const E=a(t,["topK"]);E!=null&&u(e,["topK"],E);const N=a(t,["topP"]);if(N!=null&&u(e,["topP"],N),a(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Dc(t,e){const n={},s=a(e,["model"]);return s!=null&&u(n,["_url","name"],L(t,s)),n}function Lc(t,e){const n={},s=a(e,["model"]);return s!=null&&u(n,["_url","name"],L(t,s)),n}function Fc(t){const e={};if(a(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function jc(t){const e={};if(a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=a(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function $c(t){const e={},n=a(t,["bytesBase64Encoded"]);n!=null&&u(e,["imageBytes"],we(n));const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function dr(t){const e={},n=a(t,["gcsUri"]);n!=null&&u(e,["gcsUri"],n);const s=a(t,["bytesBase64Encoded"]);s!=null&&u(e,["imageBytes"],we(s));const i=a(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function Ht(t){const e={};if(a(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=a(t,["imageBytes"]);n!=null&&u(e,["bytesBase64Encoded"],we(n));const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function le(t){const e={},n=a(t,["gcsUri"]);n!=null&&u(e,["gcsUri"],n);const s=a(t,["imageBytes"]);s!=null&&u(e,["bytesBase64Encoded"],we(s));const i=a(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function Oc(t,e,n){const s={},i=a(e,["pageSize"]);n!==void 0&&i!=null&&u(n,["_query","pageSize"],i);const r=a(e,["pageToken"]);n!==void 0&&r!=null&&u(n,["_query","pageToken"],r);const o=a(e,["filter"]);n!==void 0&&o!=null&&u(n,["_query","filter"],o);const l=a(e,["queryBase"]);return n!==void 0&&l!=null&&u(n,["_url","models_url"],sr(t,l)),s}function qc(t,e,n){const s={},i=a(e,["pageSize"]);n!==void 0&&i!=null&&u(n,["_query","pageSize"],i);const r=a(e,["pageToken"]);n!==void 0&&r!=null&&u(n,["_query","pageToken"],r);const o=a(e,["filter"]);n!==void 0&&o!=null&&u(n,["_query","filter"],o);const l=a(e,["queryBase"]);return n!==void 0&&l!=null&&u(n,["_url","models_url"],sr(t,l)),s}function Vc(t,e){const n={},s=a(e,["config"]);return s!=null&&Oc(t,s,n),n}function Gc(t,e){const n={},s=a(e,["config"]);return s!=null&&qc(t,s,n),n}function Bc(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["nextPageToken"]);s!=null&&u(e,["nextPageToken"],s);const i=a(t,["_self"]);if(i!=null){let r=ir(i);Array.isArray(r)&&(r=r.map(o=>fn(o))),u(e,["models"],r)}return e}function Hc(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["nextPageToken"]);s!=null&&u(e,["nextPageToken"],s);const i=a(t,["_self"]);if(i!=null){let r=ir(i);Array.isArray(r)&&(r=r.map(o=>mn(o))),u(e,["models"],r)}return e}function Jc(t){const e={},n=a(t,["maskMode"]);n!=null&&u(e,["maskMode"],n);const s=a(t,["segmentationClasses"]);s!=null&&u(e,["maskClasses"],s);const i=a(t,["maskDilation"]);return i!=null&&u(e,["dilation"],i),e}function fn(t){const e={},n=a(t,["name"]);n!=null&&u(e,["name"],n);const s=a(t,["displayName"]);s!=null&&u(e,["displayName"],s);const i=a(t,["description"]);i!=null&&u(e,["description"],i);const r=a(t,["version"]);r!=null&&u(e,["version"],r);const o=a(t,["_self"]);o!=null&&u(e,["tunedModelInfo"],ad(o));const l=a(t,["inputTokenLimit"]);l!=null&&u(e,["inputTokenLimit"],l);const h=a(t,["outputTokenLimit"]);h!=null&&u(e,["outputTokenLimit"],h);const d=a(t,["supportedGenerationMethods"]);return d!=null&&u(e,["supportedActions"],d),e}function mn(t){const e={},n=a(t,["name"]);n!=null&&u(e,["name"],n);const s=a(t,["displayName"]);s!=null&&u(e,["displayName"],s);const i=a(t,["description"]);i!=null&&u(e,["description"],i);const r=a(t,["versionId"]);r!=null&&u(e,["version"],r);const o=a(t,["deployedModels"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(p=>uc(p))),u(e,["endpoints"],m)}const l=a(t,["labels"]);l!=null&&u(e,["labels"],l);const h=a(t,["_self"]);h!=null&&u(e,["tunedModelInfo"],ld(h));const d=a(t,["defaultCheckpointId"]);d!=null&&u(e,["defaultCheckpointId"],d);const f=a(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(p=>p)),u(e,["checkpoints"],m)}return e}function Wc(t){const e={},n=a(t,["functionCall"]);n!=null&&u(e,["functionCall"],n);const s=a(t,["codeExecutionResult"]);s!=null&&u(e,["codeExecutionResult"],s);const i=a(t,["executableCode"]);i!=null&&u(e,["executableCode"],i);const r=a(t,["fileData"]);r!=null&&u(e,["fileData"],cc(r));const o=a(t,["functionResponse"]);o!=null&&u(e,["functionResponse"],o);const l=a(t,["inlineData"]);l!=null&&u(e,["inlineData"],Lu(l));const h=a(t,["text"]);h!=null&&u(e,["text"],h);const d=a(t,["thought"]);d!=null&&u(e,["thought"],d);const f=a(t,["thoughtSignature"]);f!=null&&u(e,["thoughtSignature"],f);const m=a(t,["videoMetadata"]);return m!=null&&u(e,["videoMetadata"],m),e}function Kc(t){const e={},n=a(t,["productImage"]);return n!=null&&u(e,["image"],le(n)),e}function zc(t,e){const n={},s=a(t,["numberOfImages"]);e!==void 0&&s!=null&&u(e,["parameters","sampleCount"],s);const i=a(t,["baseSteps"]);e!==void 0&&i!=null&&u(e,["parameters","editConfig","baseSteps"],i);const r=a(t,["outputGcsUri"]);e!==void 0&&r!=null&&u(e,["parameters","storageUri"],r);const o=a(t,["seed"]);e!==void 0&&o!=null&&u(e,["parameters","seed"],o);const l=a(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&u(e,["parameters","safetySetting"],l);const h=a(t,["personGeneration"]);e!==void 0&&h!=null&&u(e,["parameters","personGeneration"],h);const d=a(t,["addWatermark"]);e!==void 0&&d!=null&&u(e,["parameters","addWatermark"],d);const f=a(t,["outputMimeType"]);e!==void 0&&f!=null&&u(e,["parameters","outputOptions","mimeType"],f);const m=a(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&u(e,["parameters","outputOptions","compressionQuality"],m);const p=a(t,["enhancePrompt"]);e!==void 0&&p!=null&&u(e,["parameters","enhancePrompt"],p);const g=a(t,["labels"]);return e!==void 0&&g!=null&&u(e,["labels"],g),n}function Yc(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["source"]);i!=null&&Xc(i,n);const r=a(e,["config"]);return r!=null&&zc(r,n),n}function Qc(t){const e={},n=a(t,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>Bt(i))),u(e,["generatedImages"],s)}return e}function Xc(t,e){const n={},s=a(t,["prompt"]);e!==void 0&&s!=null&&u(e,["instances[0]","prompt"],s);const i=a(t,["personImage"]);e!==void 0&&i!=null&&u(e,["instances[0]","personImage","image"],le(i));const r=a(t,["productImages"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Kc(l))),u(e,["instances[0]","productImages"],o)}return n}function Zc(t){const e={},n=a(t,["referenceImage"]);n!=null&&u(e,["referenceImage"],le(n));const s=a(t,["referenceId"]);s!=null&&u(e,["referenceId"],s);const i=a(t,["referenceType"]);i!=null&&u(e,["referenceType"],i);const r=a(t,["maskImageConfig"]);r!=null&&u(e,["maskImageConfig"],Jc(r));const o=a(t,["controlImageConfig"]);o!=null&&u(e,["controlImageConfig"],Gu(o));const l=a(t,["styleImageConfig"]);l!=null&&u(e,["styleImageConfig"],l);const h=a(t,["subjectImageConfig"]);return h!=null&&u(e,["subjectImageConfig"],h),e}function hr(t){const e={},n=a(t,["safetyAttributes","categories"]);n!=null&&u(e,["categories"],n);const s=a(t,["safetyAttributes","scores"]);s!=null&&u(e,["scores"],s);const i=a(t,["contentType"]);return i!=null&&u(e,["contentType"],i),e}function fr(t){const e={},n=a(t,["safetyAttributes","categories"]);n!=null&&u(e,["categories"],n);const s=a(t,["safetyAttributes","scores"]);s!=null&&u(e,["scores"],s);const i=a(t,["contentType"]);return i!=null&&u(e,["contentType"],i),e}function ed(t){const e={},n=a(t,["category"]);if(n!=null&&u(e,["category"],n),a(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=a(t,["threshold"]);return s!=null&&u(e,["threshold"],s),e}function td(t){const e={},n=a(t,["image"]);return n!=null&&u(e,["image"],le(n)),e}function nd(t,e){const n={},s=a(t,["mode"]);e!==void 0&&s!=null&&u(e,["parameters","mode"],s);const i=a(t,["maxPredictions"]);e!==void 0&&i!=null&&u(e,["parameters","maxPredictions"],i);const r=a(t,["confidenceThreshold"]);e!==void 0&&r!=null&&u(e,["parameters","confidenceThreshold"],r);const o=a(t,["maskDilation"]);e!==void 0&&o!=null&&u(e,["parameters","maskDilation"],o);const l=a(t,["binaryColorThreshold"]);e!==void 0&&l!=null&&u(e,["parameters","binaryColorThreshold"],l);const h=a(t,["labels"]);return e!==void 0&&h!=null&&u(e,["labels"],h),n}function sd(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["source"]);i!=null&&rd(i,n);const r=a(e,["config"]);return r!=null&&nd(r,n),n}function id(t){const e={},n=a(t,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>Pc(i))),u(e,["generatedMasks"],s)}return e}function rd(t,e){const n={},s=a(t,["prompt"]);e!==void 0&&s!=null&&u(e,["instances[0]","prompt"],s);const i=a(t,["image"]);e!==void 0&&i!=null&&u(e,["instances[0]","image"],le(i));const r=a(t,["scribbleImage"]);return e!==void 0&&r!=null&&u(e,["instances[0]","scribble"],td(r)),n}function mr(t){const e={},n=a(t,["languageCode"]);n!=null&&u(e,["languageCode"],n);const s=a(t,["voiceConfig"]);if(s!=null&&u(e,["voiceConfig"],s),a(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function od(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>f)),u(e,["functionDeclarations"],d)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=a(t,["googleSearchRetrieval"]);s!=null&&u(e,["googleSearchRetrieval"],s);const i=a(t,["googleMaps"]);i!=null&&u(e,["googleMaps"],Fc(i));const r=a(t,["computerUse"]);r!=null&&u(e,["computerUse"],r);const o=a(t,["codeExecution"]);if(o!=null&&u(e,["codeExecution"],o),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(t,["googleSearch"]);l!=null&&u(e,["googleSearch"],jc(l));const h=a(t,["urlContext"]);return h!=null&&u(e,["urlContext"],h),e}function pr(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>dc(p))),u(e,["functionDeclarations"],m)}const s=a(t,["retrieval"]);s!=null&&u(e,["retrieval"],s);const i=a(t,["googleSearchRetrieval"]);i!=null&&u(e,["googleSearchRetrieval"],i);const r=a(t,["googleMaps"]);r!=null&&u(e,["googleMaps"],r);const o=a(t,["computerUse"]);o!=null&&u(e,["computerUse"],o);const l=a(t,["codeExecution"]);l!=null&&u(e,["codeExecution"],l);const h=a(t,["enterpriseWebSearch"]);h!=null&&u(e,["enterpriseWebSearch"],h);const d=a(t,["googleSearch"]);d!=null&&u(e,["googleSearch"],d);const f=a(t,["urlContext"]);return f!=null&&u(e,["urlContext"],f),e}function ad(t){const e={},n=a(t,["baseModel"]);n!=null&&u(e,["baseModel"],n);const s=a(t,["createTime"]);s!=null&&u(e,["createTime"],s);const i=a(t,["updateTime"]);return i!=null&&u(e,["updateTime"],i),e}function ld(t){const e={},n=a(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&u(e,["baseModel"],n);const s=a(t,["createTime"]);s!=null&&u(e,["createTime"],s);const i=a(t,["updateTime"]);return i!=null&&u(e,["updateTime"],i),e}function ud(t,e){const n={},s=a(t,["displayName"]);e!==void 0&&s!=null&&u(e,["displayName"],s);const i=a(t,["description"]);e!==void 0&&i!=null&&u(e,["description"],i);const r=a(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&u(e,["defaultCheckpointId"],r),n}function cd(t,e){const n={},s=a(t,["displayName"]);e!==void 0&&s!=null&&u(e,["displayName"],s);const i=a(t,["description"]);e!==void 0&&i!=null&&u(e,["description"],i);const r=a(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&u(e,["defaultCheckpointId"],r),n}function dd(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","name"],L(t,s));const i=a(e,["config"]);return i!=null&&ud(i,n),n}function hd(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["config"]);return i!=null&&cd(i,n),n}function fd(t,e){const n={},s=a(t,["outputGcsUri"]);e!==void 0&&s!=null&&u(e,["parameters","storageUri"],s);const i=a(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&u(e,["parameters","safetySetting"],i);const r=a(t,["personGeneration"]);e!==void 0&&r!=null&&u(e,["parameters","personGeneration"],r);const o=a(t,["includeRaiReason"]);e!==void 0&&o!=null&&u(e,["parameters","includeRaiReason"],o);const l=a(t,["outputMimeType"]);e!==void 0&&l!=null&&u(e,["parameters","outputOptions","mimeType"],l);const h=a(t,["outputCompressionQuality"]);e!==void 0&&h!=null&&u(e,["parameters","outputOptions","compressionQuality"],h);const d=a(t,["enhanceInputImage"]);e!==void 0&&d!=null&&u(e,["parameters","upscaleConfig","enhanceInputImage"],d);const f=a(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&u(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const m=a(t,["labels"]);e!==void 0&&m!=null&&u(e,["labels"],m);const p=a(t,["numberOfImages"]);e!==void 0&&p!=null&&u(e,["parameters","sampleCount"],p);const g=a(t,["mode"]);return e!==void 0&&g!=null&&u(e,["parameters","mode"],g),n}function md(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["_url","model"],L(t,s));const i=a(e,["image"]);i!=null&&u(n,["instances[0]","image"],le(i));const r=a(e,["upscaleFactor"]);r!=null&&u(n,["parameters","upscaleConfig","upscaleFactor"],r);const o=a(e,["config"]);return o!=null&&fd(o,n),n}function pd(t){const e={},n=a(t,["sdkHttpResponse"]);n!=null&&u(e,["sdkHttpResponse"],n);const s=a(t,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>Bt(r))),u(e,["generatedImages"],i)}return e}function gd(t){const e={},n=a(t,["uri"]);n!=null&&u(e,["uri"],n);const s=a(t,["encodedVideo"]);s!=null&&u(e,["videoBytes"],we(s));const i=a(t,["encoding"]);return i!=null&&u(e,["mimeType"],i),e}function yd(t){const e={},n=a(t,["gcsUri"]);n!=null&&u(e,["uri"],n);const s=a(t,["bytesBase64Encoded"]);s!=null&&u(e,["videoBytes"],we(s));const i=a(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}function vd(t){const e={},n=a(t,["image"]);n!=null&&u(e,["_self"],le(n));const s=a(t,["maskMode"]);return s!=null&&u(e,["maskMode"],s),e}function xd(t){const e={},n=a(t,["image"]);n!=null&&u(e,["image"],Ht(n));const s=a(t,["referenceType"]);return s!=null&&u(e,["referenceType"],s),e}function wd(t){const e={},n=a(t,["image"]);n!=null&&u(e,["image"],le(n));const s=a(t,["referenceType"]);return s!=null&&u(e,["referenceType"],s),e}function gr(t){const e={},n=a(t,["uri"]);n!=null&&u(e,["uri"],n);const s=a(t,["videoBytes"]);s!=null&&u(e,["encodedVideo"],we(s));const i=a(t,["mimeType"]);return i!=null&&u(e,["encoding"],i),e}function yr(t){const e={},n=a(t,["uri"]);n!=null&&u(e,["gcsUri"],n);const s=a(t,["videoBytes"]);s!=null&&u(e,["bytesBase64Encoded"],we(s));const i=a(t,["mimeType"]);return i!=null&&u(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _d="Content-Type",bd="X-Server-Timeout",Ed="User-Agent",pn="x-goog-api-client",Td="1.28.0",Sd=`google-genai-sdk/${Td}`,Cd="v1beta1",Nd="v1beta",ui=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Id{constructor(e){var n,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Cd,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:Nd,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,s){const i=[this.getRequestUrlInternal(n)];return s&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,s);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))i.searchParams.append(o,String(l));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,n,i.toString(),e.abortSignal),this.unaryApiCall(i,r,e.httpMethod)}patchHttpOptions(e,n){const s=JSON.parse(JSON.stringify(e));for(const[i,r]of Object.entries(n))typeof r=="object"?s[i]=Object.assign(Object.assign({},s[i]),r):r!==void 0&&(s[i]=r);return s}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,s);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,n,i.toString(),e.abortSignal),this.streamApiCall(i,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,s,i){if(n&&n.timeout||i){const r=new AbortController,o=r.signal;if(n.timeout&&n?.timeout>0){const l=setTimeout(()=>r.abort(),n.timeout);l&&typeof l.unref=="function"&&l.unref()}i&&i.addEventListener("abort",()=>{r.abort()}),e.signal=o}return n&&n.extraBody!==null&&Ad(e,n.extraBody),e.headers=await this.getHeadersInternal(n,s),e}async unaryApiCall(e,n,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:s})).then(async i=>(await ci(i),new cn(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:s})).then(async i=>(await ci(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return Be(this,arguments,function*(){const i=(n=e?.body)===null||n===void 0?void 0:n.getReader(),r=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:h}=yield j(i.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=r.decode(h,{stream:!0});try{const m=JSON.parse(d);if("error"in m){const p=JSON.parse(JSON.stringify(m.error)),g=p.status,y=p.code,v=`got status: ${g}. ${JSON.stringify(m)}`;if(y>=400&&y<600)throw new Vt({message:v,status:y})}}catch(m){if(m.name==="ApiError")throw m}o+=d;let f=o.match(ui);for(;f;){const m=f[1];try{const p=new Response(m,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield j(new cn(p)),o=o.slice(f[0].length),f=o.match(ui)}catch(p){throw new Error(`exception parsing stream chunk ${m}. ${p}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},n=Sd+" "+this.clientOptions.userAgentExtra;return e[Ed]=n,e[pn]=n,e[_d]="application/json",e}async getHeadersInternal(e,n){const s=new Headers;if(e&&e.headers){for(const[i,r]of Object.entries(e.headers))s.append(i,r);e.timeout&&e.timeout>0&&s.append(bd,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(s,n),s}async uploadFile(e,n){var s,i;const r={};n!=null&&(r.mimeType=n.mimeType,r.name=n.name,r.displayName=n.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const o=this.clientOptions.uploader,l=await o.stat(e);r.sizeBytes=String(l.size);const h=(s=n?.mimeType)!==null&&s!==void 0?s:l.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=h;let d="";typeof e=="string"&&(d=e.replace(/[/\\]+$/,""),d=(i=d.split(/[/\\]/).pop())!==null&&i!==void 0?i:"");const f=await this.fetchUploadUrl(r,d,n);return o.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,s){var i;let r={};s?.httpOptions?r=s.httpOptions:r={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`},n?{"X-Goog-Upload-File-Name":n}:{})};const o={file:e},l=await this.request({path:I("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:r});if(!l||!l?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(i=l?.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function ci(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(s);throw n>=400&&n<600?new Vt({message:i,status:n}):new Error(i)}}function Ad(t,e){if(!e||Object.keys(e).length===0||t.body instanceof Blob)return;let n={};if(typeof t.body=="string"&&t.body.length>0)try{const r=JSON.parse(t.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))n=r;else return}catch{return}function s(r,o){const l=Object.assign({},r);for(const h in o)if(Object.prototype.hasOwnProperty.call(o,h)){const d=o[h],f=l[h];d&&typeof d=="object"&&!Array.isArray(d)&&f&&typeof f=="object"&&!Array.isArray(f)?l[h]=s(f,d):l[h]=d}return l}const i=s(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Rd="mcp_used/unknown";let Pd=!1;function vr(t){for(const e of t)if(kd(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Pd}function xr(t){var e;const n=(e=t[pn])!==null&&e!==void 0?e:"";t[pn]=(n+` ${Rd}`).trimStart()}function kd(t){return t!==null&&typeof t=="object"&&t instanceof Dn}function Md(t,e=100){return Be(this,arguments,function*(){let s,i=0;for(;i<e;){const r=yield j(t.listTools({cursor:s}));for(const o of r.tools)yield yield j(o),i++;if(!r.nextCursor)break;s=r.nextCursor}})}class Dn{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Dn(e,n)}async initialize(){var e,n,s,i;if(this.mcpTools.length>0)return;const r={},o=[];for(const f of this.mcpClients)try{for(var l=!0,h=(n=void 0,ot(Md(f))),d;d=await h.next(),e=d.done,!e;l=!0){i=d.value,l=!1;const m=i;o.push(m);const p=m.name;if(r[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);r[p]=f}}catch(m){n={error:m}}finally{try{!l&&!e&&(s=h.return)&&await s.call(h)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),ja(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[s.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const o=await i.callTool({name:s.name,arguments:s.args},void 0,r);n.push({functionResponse:{name:s.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Ud(t,e,n){const s=new Ra;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(s,i),e(s)}class Dd{constructor(e,n,s){this.apiClient=e,this.auth=n,this.webSocketFactory=s}async connect(e){var n,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");const i=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),o=jd(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),h=`${i}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${l}`;let d=()=>{};const f=new Promise(b=>{d=b}),m=e.callbacks,p=function(){d({})},g=this.apiClient,y={onopen:p,onmessage:b=>{Ud(g,m.onmessage,b)},onerror:(n=m?.onerror)!==null&&n!==void 0?n:function(b){},onclose:(s=m?.onclose)!==null&&s!==void 0?s:function(b){}},v=this.webSocketFactory.create(h,Fd(o),y);v.connect(),await f;const _={setup:{model:L(this.apiClient,e.model)}};return v.send(JSON.stringify(_)),new Ld(v,this.apiClient)}}class Ld{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Nu(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=Cu(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ve.PLAY)}pause(){this.sendPlaybackControl(Ve.PAUSE)}stop(){this.sendPlaybackControl(Ve.STOP)}resetContext(){this.sendPlaybackControl(Ve.RESET_CONTEXT)}close(){this.conn.close()}}function Fd(t){const e={};return t.forEach((n,s)=>{e[s]=n}),e}function jd(t){const e=new Headers;for(const[n,s]of Object.entries(t))e.append(n,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $d="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Od(t,e,n){const s=new Aa;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const r=JSON.parse(i);if(t.isVertexAI()){const o=Ru(r);Object.assign(s,o)}else Object.assign(s,r);e(s)}class qd{constructor(e,n,s){this.apiClient=e,this.auth=n,this.webSocketFactory=s,this.music=new Dd(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,s,i,r,o,l;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&vr(e.config.tools)&&xr(m);const p=Hd(m);if(this.apiClient.isVertexAI())f=`${h}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,f);else{const R=this.apiClient.getApiKey();let U="BidiGenerateContent",V="key";R?.startsWith("auth_tokens/")&&(U="BidiGenerateContentConstrained",V="access_token"),f=`${h}/ws/google.ai.generativelanguage.${d}.GenerativeService.${U}?${V}=${R}`}let g=()=>{};const y=new Promise(R=>{g=R}),v=e.callbacks,x=function(){var R;(R=v?.onopen)===null||R===void 0||R.call(v),g({})},w=this.apiClient,_={onopen:x,onmessage:R=>{Od(w,v.onmessage,R)},onerror:(n=v?.onerror)!==null&&n!==void 0?n:function(R){},onclose:(s=v?.onclose)!==null&&s!==void 0?s:function(R){}},b=this.webSocketFactory.create(f,Bd(p),_);b.connect(),await y;let T=L(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&T.startsWith("publishers/")){const R=this.apiClient.getProject(),U=this.apiClient.getLocation();T=`projects/${R}/locations/${U}/`+T}let S={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Pt.AUDIO]}:e.config.responseModalities=[Pt.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig;const E=(l=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[],N=[];for(const R of E)if(this.isCallableTool(R)){const U=R;N.push(await U.tool())}else N.push(R);N.length>0&&(e.config.tools=N);const M={model:T,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?S=Su(this.apiClient,M):S=Tu(this.apiClient,M),delete S.config,b.send(JSON.stringify(S)),new Gd(b,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Vd={turnComplete:!0};class Gd{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let s=[];try{s=se(n.turns),e.isVertexAI()||(s=s.map(i=>Gt(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:s,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let s=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?s=n.functionResponses:s=[n.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const r of s){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error($d)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},Vd),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Au(e)}:n={realtimeInput:Iu(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function Bd(t){const e={};return t.forEach((n,s)=>{e[s]=n}),e}function Hd(t){const e=new Headers;for(const[n,s]of Object.entries(t))e.append(n,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const di=10;function hi(t){var e,n,s;if(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const o of(n=t?.tools)!==null&&n!==void 0?n:[])if(He(o)){i=!0;break}if(!i)return!0;const r=(s=t?.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return!!(r&&(r<0||!Number.isInteger(r))||r==0)}function He(t){return"callTool"in t&&typeof t.callTool=="function"}function Jd(t){var e,n,s;return(s=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>He(i)))!==null&&s!==void 0?s:!1}function Wd(t){var e,n,s;return(s=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!He(i)))!==null&&s!==void 0?s:!1}function fi(t){var e;return!(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kd extends ke{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var s,i,r,o,l;const h=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!Jd(n)||hi(n.config))return await this.generateContentInternal(h);if(Wd(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let d,f;const m=se(h.contents),p=(r=(i=(s=h.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:di;let g=0;for(;g<p&&(d=await this.generateContentInternal(h),!(!d.functionCalls||d.functionCalls.length===0));){const y=d.candidates[0].content,v=[];for(const x of(l=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[])if(He(x)){const _=await x.callTool(d.functionCalls);v.push(..._)}g++,f={role:"user",parts:v},h.contents=se(h.contents),h.contents.push(y),h.contents.push(f),fi(h.config)&&(m.push(y),m.push(f))}return fi(h.config)&&(d.automaticFunctionCallingHistory=m),d},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),hi(n.config)){const s=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(s)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(s=>{var i;let r;const o=[];if(s?.generatedImages)for(const h of s.generatedImages)h&&h?.safetyAttributes&&((i=h?.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?r=h?.safetyAttributes:o.push(h);let l;return r?l={generatedImages:o,positivePromptSafetyAttributes:r,sdkHttpResponse:s.sdkHttpResponse}:l={generatedImages:o,sdkHttpResponse:s.sdkHttpResponse},l}),this.list=async n=>{var s;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((s=o.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new mt(Re.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async n=>{const s={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(s.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async n=>{let s={numberOfImages:1,mode:"upscale"};n.config&&(s=Object.assign(Object.assign({},s),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:s};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var s,i,r,o,l,h;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((s=n.video)===null||s===void 0)&&s.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((o=(r=n.source)===null||r===void 0?void 0:r.video)===null||o===void 0)&&o.uri&&(!((h=(l=n.source)===null||l===void 0?void 0:l.video)===null||h===void 0)&&h.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,s,i;const r=(n=e.config)===null||n===void 0?void 0:n.tools;if(!r)return e;const o=await Promise.all(r.map(async h=>He(h)?await h.tool():h)),l={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(l.config.tools=o,e.config&&e.config.tools&&vr(e.config.tools)){const h=(i=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&i!==void 0?i:{};let d=Object.assign({},h);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),xr(d),l.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return l}async initAfcToolsMap(e){var n,s,i;const r=new Map;for(const o of(s=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&s!==void 0?s:[])if(He(o)){const l=o,h=await l.tool();for(const d of(i=h.functionDeclarations)!==null&&i!==void 0?i:[]){if(!d.name)throw new Error("Function declaration name is required.");if(r.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);r.set(d.name,l)}}return r}async processAfcStream(e){var n,s,i;const r=(i=(s=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&i!==void 0?i:di;let o=!1,l=0;const h=await this.initAfcToolsMap(e);return function(d,f,m){var p,g;return Be(this,arguments,function*(){for(var y,v,x,w;l<r;){o&&(l++,o=!1);const S=yield j(d.processParamsMaybeAddMcpUsage(m)),E=yield j(d.generateContentStreamInternal(S)),N=[],M=[];try{for(var _=!0,b=(v=void 0,ot(E)),T;T=yield j(b.next()),y=T.done,!y;_=!0){w=T.value,_=!1;const R=w;if(yield yield j(R),R.candidates&&(!((p=R.candidates[0])===null||p===void 0)&&p.content)){M.push(R.candidates[0].content);for(const U of(g=R.candidates[0].content.parts)!==null&&g!==void 0?g:[])if(l<r&&U.functionCall){if(!U.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(U.functionCall.name)){const V=yield j(f.get(U.functionCall.name).callTool([U.functionCall]));N.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${U.functionCall.name}`)}}}}catch(R){v={error:R}}finally{try{!_&&!y&&(x=b.return)&&(yield j(x.call(b)))}finally{if(v)throw v.error}}if(N.length>0){o=!0;const R=new it;R.candidates=[{content:{role:"user",parts:N}}],yield yield j(R);const U=[];U.push(...M),U.push({role:"user",parts:N});const V=se(m.contents).concat(U);m.contents=V}else break}})}(this,h,e)}async generateContentInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=oi(this.apiClient,e);return l=I("{model}:generateContent",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=li(f),p=new it;return Object.assign(p,m),p})}else{const d=ri(this.apiClient,e);return l=I("{model}:generateContent",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=ai(f),p=new it;return Object.assign(p,m),p})}}async generateContentStreamInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=oi(this.apiClient,e);return l=I("{model}:streamGenerateContent?alt=sse",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.requestStream({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(m){return Be(this,arguments,function*(){var p,g,y,v;try{for(var x=!0,w=ot(m),_;_=yield j(w.next()),p=_.done,!p;x=!0){v=_.value,x=!1;const b=v,T=li(yield j(b.json()));T.sdkHttpResponse={headers:b.headers};const S=new it;Object.assign(S,T),yield yield j(S)}}catch(b){g={error:b}}finally{try{!x&&!p&&(y=w.return)&&(yield j(y.call(w)))}finally{if(g)throw g.error}}})})}else{const d=ri(this.apiClient,e);return l=I("{model}:streamGenerateContent?alt=sse",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.requestStream({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(m){return Be(this,arguments,function*(){var p,g,y,v;try{for(var x=!0,w=ot(m),_;_=yield j(w.next()),p=_.done,!p;x=!0){v=_.value,x=!1;const b=v,T=ai(yield j(b.json()));T.sdkHttpResponse={headers:b.headers};const S=new it;Object.assign(S,T),yield yield j(S)}}catch(b){g={error:b}}finally{try{!x&&!p&&(y=w.return)&&(yield j(y.call(w)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=oc(this.apiClient,e);return l=I("{model}:predict",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=lc(f),p=new Gs;return Object.assign(p,m),p})}else{const d=rc(this.apiClient,e);return l=I("{model}:batchEmbedContents",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=ac(f),p=new Gs;return Object.assign(p,m),p})}}async generateImagesInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=yc(this.apiClient,e);return l=I("{model}:predict",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=xc(f),p=new Bs;return Object.assign(p,m),p})}else{const d=gc(this.apiClient,e);return l=I("{model}:predict",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=vc(f),p=new Bs;return Object.assign(p,m),p})}}async editImageInternal(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI()){const l=tc(this.apiClient,e);return r=I("{model}:predict",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:h.headers},f})),i.then(h=>{const d=nc(h),f=new _a;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI()){const l=md(this.apiClient,e);return r=I("{model}:predict",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:h.headers},f})),i.then(h=>{const d=pd(h),f=new ba;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI()){const l=Yc(this.apiClient,e);return r=I("{model}:predict",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),i.then(h=>{const d=Qc(h),f=new Ea;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI()){const l=sd(this.apiClient,e);return r=I("{model}:predict",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),i.then(h=>{const d=id(h),f=new Ta;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Lc(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>mn(f))}else{const d=Dc(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>fn(f))}}async listInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Gc(this.apiClient,e);return l=I("{models_url}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Hc(f),p=new Hs;return Object.assign(p,m),p})}else{const d=Vc(this.apiClient,e);return l=I("{models_url}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Bc(f),p=new Hs;return Object.assign(p,m),p})}}async update(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=hd(this.apiClient,e);return l=I("{model}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>mn(f))}else{const d=dd(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>fn(f))}}async delete(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Qu(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Zu(f),p=new Js;return Object.assign(p,m),p})}else{const d=Yu(this.apiClient,e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Xu(f),p=new Js;return Object.assign(p,m),p})}}async countTokens(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Wu(this.apiClient,e);return l=I("{model}:countTokens",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=zu(f),p=new Ws;return Object.assign(p,m),p})}else{const d=Ju(this.apiClient,e);return l=I("{model}:countTokens",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Ku(f),p=new Ws;return Object.assign(p,m),p})}}async computeTokens(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI()){const l=$u(this.apiClient,e);return r=I("{model}:computeTokens",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:h.headers},f})),i.then(h=>{const d=Ou(h),f=new Sa;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=Sc(this.apiClient,e);return l=I("{model}:predictLongRunning",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o.then(f=>{const m=Ec(f),p=new kt;return Object.assign(p,m),p})}else{const d=Tc(this.apiClient,e);return l=I("{model}:predictLongRunning",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o.then(f=>{const m=bc(f),p=new kt;return Object.assign(p,m),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zd extends ke{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,s=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let r;s&&"httpOptions"in s&&(r=s.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:r}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:s});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,s=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let r;s&&"httpOptions"in s&&(r=s.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:r}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:s});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=va(e);return l=I("{operationName}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),o}else{const d=ya(e);return l=I("{operationName}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),o}}async fetchPredictVideosOperationInternal(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI()){const l=ca(e);return r=I("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Yd(t){const e={},n=a(t,["data"]);if(n!=null&&u(e,["data"],n),a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function Qd(t){const e={},n=a(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(r=>rh(r))),u(e,["parts"],i)}const s=a(t,["role"]);return s!=null&&u(e,["role"],s),e}function Xd(t,e,n){const s={},i=a(e,["expireTime"]);n!==void 0&&i!=null&&u(n,["expireTime"],i);const r=a(e,["newSessionExpireTime"]);n!==void 0&&r!=null&&u(n,["newSessionExpireTime"],r);const o=a(e,["uses"]);n!==void 0&&o!=null&&u(n,["uses"],o);const l=a(e,["liveConnectConstraints"]);n!==void 0&&l!=null&&u(n,["bidiGenerateContentSetup"],ih(t,l));const h=a(e,["lockAdditionalFields"]);return n!==void 0&&h!=null&&u(n,["fieldMask"],h),s}function Zd(t,e){const n={},s=a(e,["config"]);return s!=null&&u(n,["config"],Xd(t,s,n)),n}function eh(t){const e={};if(a(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(t,["fileUri"]);n!=null&&u(e,["fileUri"],n);const s=a(t,["mimeType"]);return s!=null&&u(e,["mimeType"],s),e}function th(t){const e={};if(a(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(t,["enableWidget"]);return n!=null&&u(e,["enableWidget"],n),e}function nh(t){const e={};if(a(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");const n=a(t,["timeRangeFilter"]);return n!=null&&u(e,["timeRangeFilter"],n),e}function sh(t,e){const n={},s=a(t,["generationConfig"]);e!==void 0&&s!=null&&u(e,["setup","generationConfig"],s);const i=a(t,["responseModalities"]);e!==void 0&&i!=null&&u(e,["setup","generationConfig","responseModalities"],i);const r=a(t,["temperature"]);e!==void 0&&r!=null&&u(e,["setup","generationConfig","temperature"],r);const o=a(t,["topP"]);e!==void 0&&o!=null&&u(e,["setup","generationConfig","topP"],o);const l=a(t,["topK"]);e!==void 0&&l!=null&&u(e,["setup","generationConfig","topK"],l);const h=a(t,["maxOutputTokens"]);e!==void 0&&h!=null&&u(e,["setup","generationConfig","maxOutputTokens"],h);const d=a(t,["mediaResolution"]);e!==void 0&&d!=null&&u(e,["setup","generationConfig","mediaResolution"],d);const f=a(t,["seed"]);e!==void 0&&f!=null&&u(e,["setup","generationConfig","seed"],f);const m=a(t,["speechConfig"]);e!==void 0&&m!=null&&u(e,["setup","generationConfig","speechConfig"],Un(m));const p=a(t,["thinkingConfig"]);e!==void 0&&p!=null&&u(e,["setup","generationConfig","thinkingConfig"],p);const g=a(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&u(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=a(t,["systemInstruction"]);e!==void 0&&y!=null&&u(e,["setup","systemInstruction"],Qd(z(y)));const v=a(t,["tools"]);if(e!==void 0&&v!=null){let E=Ye(v);Array.isArray(E)&&(E=E.map(N=>ah(ze(N)))),u(e,["setup","tools"],E)}const x=a(t,["sessionResumption"]);e!==void 0&&x!=null&&u(e,["setup","sessionResumption"],oh(x));const w=a(t,["inputAudioTranscription"]);e!==void 0&&w!=null&&u(e,["setup","inputAudioTranscription"],w);const _=a(t,["outputAudioTranscription"]);e!==void 0&&_!=null&&u(e,["setup","outputAudioTranscription"],_);const b=a(t,["realtimeInputConfig"]);e!==void 0&&b!=null&&u(e,["setup","realtimeInputConfig"],b);const T=a(t,["contextWindowCompression"]);e!==void 0&&T!=null&&u(e,["setup","contextWindowCompression"],T);const S=a(t,["proactivity"]);return e!==void 0&&S!=null&&u(e,["setup","proactivity"],S),n}function ih(t,e){const n={},s=a(e,["model"]);s!=null&&u(n,["setup","model"],L(t,s));const i=a(e,["config"]);return i!=null&&u(n,["config"],sh(i,n)),n}function rh(t){const e={},n=a(t,["functionCall"]);n!=null&&u(e,["functionCall"],n);const s=a(t,["codeExecutionResult"]);s!=null&&u(e,["codeExecutionResult"],s);const i=a(t,["executableCode"]);i!=null&&u(e,["executableCode"],i);const r=a(t,["fileData"]);r!=null&&u(e,["fileData"],eh(r));const o=a(t,["functionResponse"]);o!=null&&u(e,["functionResponse"],o);const l=a(t,["inlineData"]);l!=null&&u(e,["inlineData"],Yd(l));const h=a(t,["text"]);h!=null&&u(e,["text"],h);const d=a(t,["thought"]);d!=null&&u(e,["thought"],d);const f=a(t,["thoughtSignature"]);f!=null&&u(e,["thoughtSignature"],f);const m=a(t,["videoMetadata"]);return m!=null&&u(e,["videoMetadata"],m),e}function oh(t){const e={},n=a(t,["handle"]);if(n!=null&&u(e,["handle"],n),a(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function ah(t){const e={},n=a(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>f)),u(e,["functionDeclarations"],d)}if(a(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=a(t,["googleSearchRetrieval"]);s!=null&&u(e,["googleSearchRetrieval"],s);const i=a(t,["googleMaps"]);i!=null&&u(e,["googleMaps"],th(i));const r=a(t,["computerUse"]);r!=null&&u(e,["computerUse"],r);const o=a(t,["codeExecution"]);if(o!=null&&u(e,["codeExecution"],o),a(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(t,["googleSearch"]);l!=null&&u(e,["googleSearch"],nh(l));const h=a(t,["urlContext"]);return h!=null&&u(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lh(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const s=t[n];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const i=Object.keys(s).map(r=>`${n}.${r}`);e.push(...i)}else e.push(n)}return e.join(",")}function uh(t,e){let n=null;const s=t.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const r=s.setup;typeof r=="object"&&r!==null?(t.bidiGenerateContentSetup=r,n=r):delete t.bidiGenerateContentSetup}else s!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const r=lh(n);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)r?t.fieldMask=r:delete t.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let l=[];i.length>0&&(l=i.map(d=>o.includes(d)?`generationConfig.${d}`:d));const h=[];r&&h.push(r),l.length>0&&h.push(...l),h.length>0?t.fieldMask=h.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class ch extends ke{constructor(e){super(),this.apiClient=e}async create(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const l=Zd(this.apiClient,e);r=I("auth_tokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query;const h=uh(l,e.config);return i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dh(t,e){const n={},s=a(t,["name"]);return s!=null&&u(n,["_url","name"],s),n}function hh(t,e){const n={},s=a(t,["name"]);return s!=null&&u(n,["_url","name"],s),n}function fh(t,e,n){const s={};if(a(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=a(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&u(e,["displayName"],i),a(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=a(t,["epochCount"]);e!==void 0&&r!=null&&u(e,["tuningTask","hyperparameters","epochCount"],r);const o=a(t,["learningRateMultiplier"]);if(o!=null&&u(s,["tuningTask","hyperparameters","learningRateMultiplier"],o),a(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(a(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(a(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=a(t,["batchSize"]);e!==void 0&&l!=null&&u(e,["tuningTask","hyperparameters","batchSize"],l);const h=a(t,["learningRate"]);if(e!==void 0&&h!=null&&u(e,["tuningTask","hyperparameters","learningRate"],h),a(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(a(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return s}function mh(t,e,n){const s={};let i=a(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const g=a(t,["validationDataset"]);e!==void 0&&g!=null&&u(e,["supervisedTuningSpec"],mi(g))}else if(i==="PREFERENCE_TUNING"){const g=a(t,["validationDataset"]);e!==void 0&&g!=null&&u(e,["preferenceOptimizationSpec"],mi(g))}const r=a(t,["tunedModelDisplayName"]);e!==void 0&&r!=null&&u(e,["tunedModelDisplayName"],r);const o=a(t,["description"]);e!==void 0&&o!=null&&u(e,["description"],o);let l=a(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const g=a(t,["epochCount"]);e!==void 0&&g!=null&&u(e,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(l==="PREFERENCE_TUNING"){const g=a(t,["epochCount"]);e!==void 0&&g!=null&&u(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let h=a(n,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const g=a(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&u(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(h==="PREFERENCE_TUNING"){const g=a(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&u(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let d=a(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const g=a(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&u(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(d==="PREFERENCE_TUNING"){const g=a(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&u(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let f=a(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const g=a(t,["adapterSize"]);e!==void 0&&g!=null&&u(e,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(f==="PREFERENCE_TUNING"){const g=a(t,["adapterSize"]);e!==void 0&&g!=null&&u(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(a(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(a(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=a(t,["labels"]);e!==void 0&&m!=null&&u(e,["labels"],m);const p=a(t,["beta"]);return e!==void 0&&p!=null&&u(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),s}function ph(t,e){const n={},s=a(t,["baseModel"]);s!=null&&u(n,["baseModel"],s);const i=a(t,["preTunedModel"]);i!=null&&u(n,["preTunedModel"],i);const r=a(t,["trainingDataset"]);r!=null&&Ch(r);const o=a(t,["config"]);return o!=null&&fh(o,n),n}function gh(t,e){const n={},s=a(t,["baseModel"]);s!=null&&u(n,["baseModel"],s);const i=a(t,["preTunedModel"]);i!=null&&u(n,["preTunedModel"],i);const r=a(t,["trainingDataset"]);r!=null&&Nh(r,n,e);const o=a(t,["config"]);return o!=null&&mh(o,n,e),n}function yh(t,e){const n={},s=a(t,["name"]);return s!=null&&u(n,["_url","name"],s),n}function vh(t,e){const n={},s=a(t,["name"]);return s!=null&&u(n,["_url","name"],s),n}function xh(t,e,n){const s={},i=a(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const r=a(t,["pageToken"]);e!==void 0&&r!=null&&u(e,["_query","pageToken"],r);const o=a(t,["filter"]);return e!==void 0&&o!=null&&u(e,["_query","filter"],o),s}function wh(t,e,n){const s={},i=a(t,["pageSize"]);e!==void 0&&i!=null&&u(e,["_query","pageSize"],i);const r=a(t,["pageToken"]);e!==void 0&&r!=null&&u(e,["_query","pageToken"],r);const o=a(t,["filter"]);return e!==void 0&&o!=null&&u(e,["_query","filter"],o),s}function _h(t,e){const n={},s=a(t,["config"]);return s!=null&&xh(s,n),n}function bh(t,e){const n={},s=a(t,["config"]);return s!=null&&wh(s,n),n}function Eh(t,e){const n={},s=a(t,["sdkHttpResponse"]);s!=null&&u(n,["sdkHttpResponse"],s);const i=a(t,["nextPageToken"]);i!=null&&u(n,["nextPageToken"],i);const r=a(t,["tunedModels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>wr(l))),u(n,["tuningJobs"],o)}return n}function Th(t,e){const n={},s=a(t,["sdkHttpResponse"]);s!=null&&u(n,["sdkHttpResponse"],s);const i=a(t,["nextPageToken"]);i!=null&&u(n,["nextPageToken"],i);const r=a(t,["tuningJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>gn(l))),u(n,["tuningJobs"],o)}return n}function Sh(t,e){const n={},s=a(t,["name"]);s!=null&&u(n,["model"],s);const i=a(t,["name"]);return i!=null&&u(n,["endpoint"],i),n}function Ch(t,e){const n={};if(a(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(a(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const s=a(t,["examples"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>r)),u(n,["examples","examples"],i)}return n}function Nh(t,e,n){const s={};let i=a(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const o=a(t,["gcsUri"]);e!==void 0&&o!=null&&u(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(i==="PREFERENCE_TUNING"){const o=a(t,["gcsUri"]);e!==void 0&&o!=null&&u(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let r=a(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const o=a(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&u(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(r==="PREFERENCE_TUNING"){const o=a(t,["vertexDatasetResource"]);e!==void 0&&o!=null&&u(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(a(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return s}function wr(t,e){const n={},s=a(t,["sdkHttpResponse"]);s!=null&&u(n,["sdkHttpResponse"],s);const i=a(t,["name"]);i!=null&&u(n,["name"],i);const r=a(t,["state"]);r!=null&&u(n,["state"],tr(r));const o=a(t,["createTime"]);o!=null&&u(n,["createTime"],o);const l=a(t,["tuningTask","startTime"]);l!=null&&u(n,["startTime"],l);const h=a(t,["tuningTask","completeTime"]);h!=null&&u(n,["endTime"],h);const d=a(t,["updateTime"]);d!=null&&u(n,["updateTime"],d);const f=a(t,["description"]);f!=null&&u(n,["description"],f);const m=a(t,["baseModel"]);m!=null&&u(n,["baseModel"],m);const p=a(t,["_self"]);return p!=null&&u(n,["tunedModel"],Sh(p)),n}function gn(t,e){const n={},s=a(t,["sdkHttpResponse"]);s!=null&&u(n,["sdkHttpResponse"],s);const i=a(t,["name"]);i!=null&&u(n,["name"],i);const r=a(t,["state"]);r!=null&&u(n,["state"],tr(r));const o=a(t,["createTime"]);o!=null&&u(n,["createTime"],o);const l=a(t,["startTime"]);l!=null&&u(n,["startTime"],l);const h=a(t,["endTime"]);h!=null&&u(n,["endTime"],h);const d=a(t,["updateTime"]);d!=null&&u(n,["updateTime"],d);const f=a(t,["error"]);f!=null&&u(n,["error"],f);const m=a(t,["description"]);m!=null&&u(n,["description"],m);const p=a(t,["baseModel"]);p!=null&&u(n,["baseModel"],p);const g=a(t,["tunedModel"]);g!=null&&u(n,["tunedModel"],g);const y=a(t,["preTunedModel"]);y!=null&&u(n,["preTunedModel"],y);const v=a(t,["supervisedTuningSpec"]);v!=null&&u(n,["supervisedTuningSpec"],v);const x=a(t,["preferenceOptimizationSpec"]);x!=null&&u(n,["preferenceOptimizationSpec"],x);const w=a(t,["tuningDataStats"]);w!=null&&u(n,["tuningDataStats"],w);const _=a(t,["encryptionSpec"]);_!=null&&u(n,["encryptionSpec"],_);const b=a(t,["partnerModelTuningSpec"]);b!=null&&u(n,["partnerModelTuningSpec"],b);const T=a(t,["customBaseModel"]);T!=null&&u(n,["customBaseModel"],T);const S=a(t,["experiment"]);S!=null&&u(n,["experiment"],S);const E=a(t,["labels"]);E!=null&&u(n,["labels"],E);const N=a(t,["outputUri"]);N!=null&&u(n,["outputUri"],N);const M=a(t,["pipelineJob"]);M!=null&&u(n,["pipelineJob"],M);const R=a(t,["serviceAccount"]);R!=null&&u(n,["serviceAccount"],R);const U=a(t,["tunedModelDisplayName"]);U!=null&&u(n,["tunedModelDisplayName"],U);const V=a(t,["veoTuningSpec"]);return V!=null&&u(n,["veoTuningSpec"],V),n}function Ih(t,e){const n={},s=a(t,["sdkHttpResponse"]);s!=null&&u(n,["sdkHttpResponse"],s);const i=a(t,["name"]);i!=null&&u(n,["name"],i);const r=a(t,["metadata"]);r!=null&&u(n,["metadata"],r);const o=a(t,["done"]);o!=null&&u(n,["done"],o);const l=a(t,["error"]);return l!=null&&u(n,["error"],l),n}function mi(t,e){const n={},s=a(t,["gcsUri"]);s!=null&&u(n,["validationDatasetUri"],s);const i=a(t,["vertexDatasetResource"]);return i!=null&&u(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ah extends ke{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new mt(Re.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(n),n),this.tune=async n=>{var s;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((s=n.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const r=Object.assign(Object.assign({},n),{preTunedModel:i});return r.baseModel=void 0,await this.tuneInternal(r)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),r=await this.tuneMldevInternal(i);let o="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?o=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(o=r.name.split("/operations/")[0]),{name:o,state:un.JOB_STATE_QUEUED}}}}async getInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=vh(e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>gn(f))}else{const d=yh(e);return l=I("{name}",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>wr(f))}}async listInternal(e){var n,s,i,r;let o,l="",h={};if(this.apiClient.isVertexAI()){const d=bh(e);return l=I("tuningJobs",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Th(f),p=new Ks;return Object.assign(p,m),p})}else{const d=_h(e);return l=I("tunedModels",d._url),h=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),o.then(f=>{const m=Eh(f),p=new Ks;return Object.assign(p,m),p})}}async cancel(e){var n,s,i,r;let o="",l={};if(this.apiClient.isVertexAI()){const h=hh(e);o=I("{name}:cancel",h._url),l=h._query,delete h._url,delete h._query,await this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const h=dh(e);o=I("{name}:cancel",h._url),l=h._query,delete h._url,delete h._query,await this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async tuneInternal(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI()){const l=gh(e,e);return r=I("tuningJobs",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:h.headers},f})),i.then(h=>gn(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,s;let i,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ph(e);return r=I("tunedModels",l._url),o=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:h.headers},f})),i.then(h=>Ih(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rh{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Ph=1024*1024*8,kh=3,Mh=1e3,Uh=2,Yt="x-goog-upload-status";async function Dh(t,e,n){var s,i,r;let o=0,l=0,h=new cn(new Response),d="upload";for(o=t.size;l<o;){const m=Math.min(Ph,o-l),p=t.slice(l,l+m);l+m>=o&&(d+=", finalize");let g=0,y=Mh;for(;g<kh&&(h=await n.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(m)}}}),!(!((s=h?.headers)===null||s===void 0)&&s[Yt]));)g++,await Fh(y),y=y*Uh;if(l+=m,((i=h?.headers)===null||i===void 0?void 0:i[Yt])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await h?.json();if(((r=h?.headers)===null||r===void 0?void 0:r[Yt])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function Lh(t){return{size:t.size,type:t.type}}function Fh(t){return new Promise(e=>setTimeout(e,t))}class jh{async upload(e,n,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Dh(e,n,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Lh(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $h{create(e,n,s){return new Oh(e,n,s)}}class Oh{constructor(e,n,s){this.url=e,this.headers=n,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pi="x-goog-api-key";class qh{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(pi)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(pi,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vh="gl-node/";class Gh{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const s=la(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion;const i=new qh(this.apiKey);this.apiClient=new Id({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Vh+"web",uploader:new jh,downloader:new Rh}),this.models=new Kd(this.apiClient),this.live=new qd(this.apiClient,i,new $h),this.batches=new Nl(this.apiClient),this.chats=new ru(this.models,this.apiClient),this.caches=new nu(this.apiClient),this.files=new pu(this.apiClient),this.operations=new zd(this.apiClient),this.authTokens=new ch(this.apiClient),this.tunings=new Ah(this.apiClient)}}const _r=new Gh({apiKey:"PLACEHOLDER_API_KEY"}),Bh=async t=>{try{const e=`Generate a brief, friendly, and helpful student guide for the area around ${t} university in Kampala, Uganda. The tone should be welcoming and informative for a new student. Include three sections with headings: 1. Popular Student Hangouts (mention cafes or food spots), 2. Transportation Tips (mention common modes like boda-bodas), and 3. Safety Pointers. Format the output as simple HTML using <h2> for the main title, <h3> for section headings, and <p> or <ul>/<li> for the content. Do not include <html> or <body> tags.`;return(await _r.models.generateContent({model:"gemini-2.5-flash",contents:e})).text}catch{return`
      <h2 class="text-2xl font-bold text-red-600 mb-3">Oops! Something went wrong.</h2>
      <p>We couldn't generate the campus guide at the moment. This might be due to a configuration issue or a problem with the AI service. Please try again later.</p>
      <p class="mt-2 text-sm text-gray-500">If you are the developer, check the console for more details.</p>
    `}},Hh=async(t,e)=>{try{const n=`You are a helpful student advisor. Generate a brief, friendly, and helpful guide for finding "${e}" services around ${t} university in Kampala, Uganda. Provide practical tips, mention a few popular or affordable places (use realistic but placeholder names if you don't know any), and keep the tone encouraging for a new student. Format the output as simple HTML using <h3> for section headings, and <p> or <ul>/<li> for the content. Do not include a main <h2> title, or any <html> or <body> tags.`;return(await _r.models.generateContent({model:"gemini-2.5-flash",contents:n})).text}catch{return`
      <h3 class="text-xl font-bold text-red-600 mb-3">Oops! Something went wrong.</h3>
      <p>We couldn't generate the guide for ${e} services at the moment. Please try again later.</p>
    `}},Ut=t=>{const e=new Date,n=new Date(t),s=Math.floor((e.getTime()-n.getTime())/1e3),i={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60};if(s<60)return"just now";for(const[r,o]of Object.entries(i)){const l=Math.floor(s/o);if(l>=1)return l===1?`1 ${r} ago`:`${l} ${r}s ago`}return"just now"},Jh=({items:t,onNavigateToBlog:e})=>c.jsx("div",{className:"space-y-4",children:t.map(n=>c.jsxs("div",{className:"flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[c.jsx("img",{src:n.imageUrl,alt:n.title,className:"w-20 h-20 rounded-lg object-cover flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-bold text-unistay-navy",children:n.title}),c.jsxs("div",{className:"flex justify-between items-center mt-2",children:[c.jsx("p",{className:"text-xs text-gray-400",children:Ut(n.timestamp)}),c.jsxs("p",{className:"text-xs text-gray-400",children:["Source: ",n.source]})]}),c.jsxs("button",{onClick:e,className:"mt-2 text-sm font-semibold text-unistay-yellow hover:text-unistay-navy transition-colors",children:["Read Full Article ",c.jsx("i",{className:"fas fa-arrow-right ml-1"})]})]})]},n.id))}),Wh=({items:t})=>c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(e=>c.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden group transform hover:-translate-y-1 transition-transform duration-300",children:[c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:e.imageUrl,alt:e.title,className:"h-40 w-full object-cover"}),c.jsxs("div",{className:"absolute top-3 left-3 bg-unistay-yellow text-unistay-navy text-center rounded-lg px-3 py-1 shadow-md",children:[c.jsx("p",{className:"font-extrabold text-xl",children:e.day}),c.jsx("p",{className:"font-semibold text-xs leading-tight",children:e.month})]})]}),c.jsxs("div",{className:"p-4",children:[c.jsx("h3",{className:"font-bold text-lg text-unistay-navy",children:e.title}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[c.jsx("i",{className:"fas fa-map-marker-alt text-unistay-yellow mr-2"}),e.location]})]})]},e.id))}),Kh=({items:t})=>c.jsx("div",{className:"space-y-4",children:t.map(e=>c.jsxs("div",{className:"flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[c.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:c.jsx("img",{src:e.imageUrl,alt:e.company,className:"w-12 h-12 object-contain"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-bold text-unistay-navy",children:e.title}),c.jsx("p",{className:"text-sm text-gray-600",children:e.company})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Apply by"}),c.jsx("p",{className:"font-semibold text-unistay-navy",children:e.deadline})]})]},e.id))}),zh=({universities:t,user:e,onNavigate:n})=>{const[s,i]=C.useState(null),[r,o]=C.useState(!1),[l,h]=C.useState(null),[d,f]=C.useState(t[0].id),m=!!e,p=C.useCallback(async()=>{if(!m){n("auth");return}const g=t.find(y=>y.id===d);if(!g){h("Could not find the selected university.");return}o(!0),h(null),i(null);try{const y=await Bh(g.name);i(y)}catch(y){const v=y instanceof Error?y.message:"An unknown error occurred.";h(v),i(`<h2 class="text-2xl font-bold text-red-600 mb-3">Oops! Something went wrong.</h2><p>We couldn't generate the campus guide at the moment. Please try again later.</p>`)}finally{o(!1)}},[d,t,m,n]);return c.jsxs("div",{id:"campus-guide",className:"bg-white rounded-2xl shadow-xl p-6 md:p-8 relative mt-12 animate-fade-in-up",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("div",{className:"w-24 h-24 mx-auto bg-unistay-yellow/20 rounded-full flex items-center justify-center mb-4",children:c.jsx("i",{className:"fas fa-robot text-5xl text-unistay-navy"})}),c.jsx("h2",{className:"text-3xl font-extrabold text-unistay-navy",children:"AI-Powered Campus Guide"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Get instant insights about any campus area with Gemini."})]}),c.jsx("div",{className:"max-w-xl mx-auto",children:c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[c.jsx("select",{value:d,onChange:g=>f(g.target.value),disabled:r||!m,className:"w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-200 disabled:cursor-not-allowed","aria-label":"Select a university for the campus guide",children:t.map(g=>c.jsx("option",{value:g.id,children:g.name},g.id))}),c.jsx("button",{onClick:p,disabled:r,className:"w-full sm:w-auto bg-unistay-navy hover:bg-opacity-90 text-white font-bold py-3 px-8 rounded-lg transition-all duration-300 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center min-w-[170px]",children:r?c.jsx(Q,{color:"white",size:"sm"}):m?"Generate":"Login to Generate"})]})}),c.jsx("div",{className:"mt-6 p-5 bg-unistay-bg rounded-lg border border-gray-200 min-h-[250px] gemini-guide",children:r?c.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-unistay-navy p-4",children:[c.jsx(Q,{color:"navy",size:"lg",className:"mb-4"}),c.jsx("p",{className:"font-semibold",children:"Generating your personalized guide..."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This might take a moment."})]}):s?c.jsx("div",{dangerouslySetInnerHTML:{__html:s}}):m?c.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500 p-4",children:[c.jsx("i",{className:"fas fa-lightbulb text-3xl mb-4","aria-hidden":"true"}),c.jsx("p",{children:"Select a university and click 'Generate' to get a helpful guide."})]}):c.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-gray-500 p-4",children:[c.jsx("i",{className:"fas fa-lock text-3xl mb-4","aria-hidden":"true"}),c.jsx("h3",{className:"font-semibold text-unistay-navy",children:"This is a members-only feature."}),c.jsx("p",{children:"Please log in or create an account to use the AI Campus Guide."})]})})]})},Yh=({news:t,events:e,jobs:n,universities:s,onNavigateToBlog:i,onNavigateToEvents:r,onNavigateToJobs:o,user:l,onNavigate:h})=>{const[d,f]=C.useState("News"),[m,p]=Pe(),g=[{name:"News",icon:"fas fa-newspaper",action:i},{name:"Events",icon:"fas fa-calendar-alt",action:r},{name:"Jobs",icon:"fas fa-briefcase",action:o}],y={News:c.jsx(Jh,{items:t,onNavigateToBlog:i}),Events:c.jsx(Wh,{items:e}),Jobs:c.jsx(Kh,{items:n})};return c.jsx("section",{ref:m,className:"py-16 bg-unistay-bg",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:`text-center mb-12 transition-all duration-1000 ${p?"opacity-100 translate-y-0":"opacity-0 translate-y-5"}`,children:[c.jsx("h2",{className:"text-3xl font-bold text-unistay-navy sm:text-4xl",children:"Campus Community Hub"}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Stay connected with the latest news, events, and job opportunities from your university."})]}),c.jsxs("div",{className:`transition-all duration-700 delay-200 ${p?"opacity-100":"opacity-0"}`,children:[c.jsx("div",{className:"mb-8 flex justify-center border-b-2 border-gray-200",role:"tablist","aria-label":"Community Hub Tabs",children:g.map(v=>c.jsxs("button",{onClick:()=>f(v.name),className:`px-4 sm:px-8 py-4 font-semibold text-lg border-b-4 transition-all duration-300 -mb-0.5 ${d===v.name?"text-unistay-navy border-unistay-yellow":"text-gray-500 border-transparent hover:text-unistay-navy hover:border-gray-300"}`,role:"tab","aria-selected":d===v.name,"aria-controls":`panel-${v.name}`,children:[c.jsx("i",{className:`${v.icon} mr-2 hidden sm:inline-block`,"aria-hidden":"true"})," ",v.name]},v.name))}),c.jsx("div",{className:"relative min-h-[400px]",children:Object.entries(y).map(([v,x])=>c.jsx("div",{id:`panel-${v}`,role:"tabpanel","aria-labelledby":`tab-${v}`,className:`transition-opacity duration-500 ${d===v?"opacity-100":"opacity-0 absolute w-full pointer-events-none"}`,children:x},v))}),c.jsx("div",{className:"text-center mt-8",children:c.jsxs("button",{onClick:g.find(v=>v.name===d)?.action,className:"font-bold text-unistay-navy hover:text-unistay-yellow transition-colors flex items-center gap-2 mx-auto",children:[c.jsxs("span",{children:["View All ",d]}),c.jsx("i",{className:"fas fa-arrow-right","aria-hidden":"true"})]})})]}),c.jsx(zh,{universities:s,user:l,onNavigate:h})]})})},Qh=({service:t,onClick:e,index:n,isVisible:s})=>c.jsxs("div",{onClick:e,className:`bg-white rounded-2xl shadow-lg p-6 text-center cursor-pointer group transform hover:-translate-y-2 transition-all duration-300 ease-in-out ${s?"opacity-100 translate-y-0":"opacity-0 translate-y-5"}`,style:{transitionDelay:`${s?n*100:0}ms`},children:[c.jsx("div",{className:"w-20 h-20 mx-auto bg-unistay-yellow/20 rounded-full flex items-center justify-center mb-4 transition-all duration-300 group-hover:bg-unistay-yellow",children:c.jsx("i",{className:`${t.icon} text-4xl text-unistay-navy transition-colors duration-300 group-hover:text-white`})}),c.jsx("h3",{className:"text-xl font-bold text-unistay-navy",children:t.name}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:t.description})]}),Xh=({service:t,universityName:e,onBack:n})=>{const[s,i]=C.useState(null),[r,o]=C.useState(!0);return C.useEffect(()=>{(async()=>{o(!0),i(null);const h=await Hh(e,t.name);i(h),o(!1)})()},[t,e]),c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8 relative animate-fade-in-up",children:[c.jsx("button",{onClick:n,className:"absolute top-4 left-4 h-10 w-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors z-10","aria-label":"Go back to services",children:c.jsx("i",{className:"fas fa-arrow-left text-unistay-navy"})}),c.jsxs("div",{className:"text-center mb-6 pt-8",children:[c.jsx("div",{className:"w-24 h-24 mx-auto bg-unistay-yellow rounded-full flex items-center justify-center mb-4",children:c.jsx("i",{className:`${t.icon} text-5xl text-white`})}),c.jsxs("h2",{className:"text-3xl font-extrabold text-unistay-navy",children:[t.name," Services"]}),c.jsxs("p",{className:"text-gray-600 mt-1",children:["Your guide to the best ",t.name.toLowerCase()," options near ",e,"."]})]}),c.jsx("div",{className:"mt-6 p-5 bg-gray-50 rounded-lg border border-gray-200 min-h-[250px] gemini-guide",children:r?c.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-unistay-navy p-4",children:[c.jsx(Q,{color:"navy",size:"lg",className:"mb-4"}),c.jsx("p",{className:"font-semibold",children:"Generating your personalized guide..."})]}):c.jsx("div",{dangerouslySetInnerHTML:{__html:s||""}})})]})},Zh=({services:t,selectedUniversity:e})=>{const[n,s]=C.useState(null),[i,r]=Pe(),o=h=>{s(h)},l=()=>{s(null)};return c.jsx("section",{ref:i,id:"services",className:"py-16 bg-gray-100",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:`text-center mb-12 transition-opacity duration-1000 ${r?"opacity-100":"opacity-0"}`,children:[c.jsx("h2",{className:"text-3xl font-bold text-unistay-navy sm:text-4xl",children:"Student Life Services"}),c.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Everything you need for a comfortable and productive campus life, right at your fingertips."})]}),c.jsxs("div",{className:"relative min-h-[400px]",children:[c.jsx("div",{className:`transition-all duration-500 ease-in-out ${n?"opacity-0 scale-95 pointer-events-none":"opacity-100 scale-100"}`,children:c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:t.map((h,d)=>c.jsx("div",{children:c.jsx(Qh,{service:h,onClick:()=>o(h),index:d,isVisible:r&&!n})},h.id))})}),n&&c.jsx("div",{className:`absolute top-0 left-0 w-full transition-opacity duration-500 ease-in-out ${n?"opacity-100":"opacity-0 pointer-events-none"}`,children:c.jsx(Xh,{service:n,universityName:e.name,onBack:l})})]})]})})},ef=({onNavigateToRoommateFinder:t,onNavigateToBlog:e,onNavigateToAuth:n,user:s})=>{const[i,r]=C.useState(!1),o=()=>{window.scrollY>300?r(!0):r(!1)};C.useEffect(()=>(window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)),[]);const l=()=>{window.scrollTo({top:0,behavior:"smooth"})},f={UniStay:[{text:"Hostels",action:l},{text:"About Us",href:"#"},{text:"Contact",href:"#"},{text:"Blog",action:e}],"For Students":[{text:"Find a Roommate",action:s?t:n},{text:"Student Deals",action:s?()=>{alert("The Student Deals feature is coming soon!")}:n},{text:"Campus Guides",action:s?()=>{document.getElementById("campus-guide")?.scrollIntoView({behavior:"smooth"})}:n},!s&&{text:"Login / Sign Up",action:n}].filter(Boolean),Support:[{text:"Help Center",href:"#"},{text:"FAQs",href:"#"},{text:"Terms of Service",href:"#"},{text:"Privacy Policy",href:"#"}]},m=[{icon:"fab fa-facebook-f",href:"#",name:"Facebook"},{icon:"fab fa-twitter",href:"#",name:"Twitter"},{icon:"fab fa-instagram",href:"#",name:"Instagram"},{icon:"fab fa-linkedin-in",href:"#",name:"LinkedIn"}];return c.jsxs("footer",{className:"bg-unistay-navy text-white relative",children:[c.jsxs("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-8",children:[c.jsxs("div",{className:"col-span-2 md:col-span-4 lg:col-span-1",children:[c.jsx("div",{className:"flex items-center select-none",children:c.jsx("img",{src:"/images/hostels/unistay.png",alt:"UniStay Logo",className:"h-10"})}),c.jsx("p",{className:"mt-4 text-gray-300 text-sm",children:"Your partner in finding the perfect student accommodation."})]}),Object.entries(f).map(([p,g])=>c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-200 tracking-wider uppercase",children:p}),c.jsx("ul",{className:"mt-4 space-y-3",children:g.map(y=>c.jsx("li",{children:y.action?c.jsx("button",{onClick:y.action,className:"text-base text-left text-gray-300 hover:text-unistay-yellow transition-colors duration-200",children:y.text}):c.jsx("a",{href:y.href,className:"text-base text-gray-300 hover:text-unistay-yellow transition-colors duration-200",children:y.text})},y.text))})]},p)),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-200 tracking-wider uppercase",children:"Get the App"}),c.jsxs("div",{className:"mt-4 space-y-3",children:[c.jsx("a",{href:"#","aria-label":"Download on the App Store",children:c.jsx("img",{src:"https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg",alt:"Download on the App Store",className:"h-10"})}),c.jsx("a",{href:"#","aria-label":"Get it on Google Play",children:c.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg",alt:"Get it on Google Play",className:"h-10"})})]})]})]}),c.jsxs("div",{className:"mt-12 border-t border-white/10 pt-8 flex flex-col sm:flex-row items-center justify-between",children:[c.jsxs("p",{className:"text-base text-gray-400 order-2 sm:order-1 mt-4 sm:mt-0",children:["© ",new Date().getFullYear()," UniStay. All rights reserved."]}),c.jsx("div",{className:"flex space-x-6 order-1 sm:order-2",children:m.map(p=>c.jsxs("a",{href:p.href,className:"text-gray-400 hover:text-unistay-yellow transition-colors duration-200",children:[c.jsx("span",{className:"sr-only",children:p.name}),c.jsx("i",{className:`${p.icon} text-xl`})]},p.name))})]})]}),i&&c.jsx("button",{onClick:l,className:"fixed bottom-8 right-8 bg-unistay-yellow text-unistay-navy h-14 w-14 rounded-full shadow-lg flex items-center justify-center transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-yellow-300 animate-fade-in","aria-label":"Go to top",children:c.jsx("i",{className:"fas fa-arrow-up text-2xl"})})]})},tf=({hostel:t,onClose:e})=>{const[n,s]=C.useState(!1);C.useEffect(()=>{const r=o=>{o.key==="Escape"&&e()};return window.addEventListener("keydown",r),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",r),document.body.style.overflow="unset"}},[e]);const i=()=>{s(!0),setTimeout(()=>{s(!1)},2e3)};return c.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-[100] flex items-center justify-center p-4",style:{animation:"fadeIn 0.3s ease-out forwards"},onClick:e,children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto no-scrollbar",style:{animation:"scaleIn 0.3s ease-out forwards"},onClick:r=>r.stopPropagation(),children:[c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-64 object-cover rounded-t-2xl"}),c.jsx("button",{onClick:e,className:"absolute top-4 right-4 bg-white/70 text-unistay-navy rounded-full h-10 w-10 flex items-center justify-center hover:bg-white transition-transform duration-200 hover:scale-110 z-10","aria-label":"Close modal",children:c.jsx("i",{className:"fas fa-times text-xl"})}),c.jsxs("div",{className:"absolute bottom-0 left-0 w-full p-6 bg-gradient-to-t from-black/80 to-transparent rounded-b-t-none rounded-t-2xl",children:[c.jsx("h2",{className:"text-3xl font-extrabold text-white",children:t.name}),c.jsxs("p",{className:"text-gray-200 mt-1",children:[c.jsx("i",{className:"fas fa-map-marker-alt text-unistay-yellow mr-2"}),t.location]})]})]}),c.jsxs("div",{className:"p-6 md:p-8",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[c.jsx("span",{className:"text-xl font-extrabold text-unistay-navy bg-unistay-yellow/30 px-4 py-2 rounded-lg",children:t.priceRange}),c.jsxs("div",{className:"flex items-center gap-2 text-xl font-bold text-unistay-navy",children:[c.jsx("i",{className:"fas fa-star text-unistay-yellow"}),c.jsx("span",{children:t.rating}),c.jsx("span",{className:"text-sm font-normal text-gray-500",children:"(25 reviews)"})]})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xl font-bold text-unistay-navy mb-3",children:"About this hostel"}),c.jsx("p",{className:"text-gray-600 leading-relaxed",children:t.description})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-xl font-bold text-unistay-navy mb-4",children:"Amenities"}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:t.amenities.map(r=>c.jsxs("div",{className:"bg-gray-50 border border-gray-200 p-4 rounded-lg flex items-center gap-4",children:[c.jsx("i",{className:`${r.icon} text-unistay-navy text-2xl w-8 text-center`}),c.jsx("span",{className:"font-semibold text-gray-700",children:r.name})]},r.name))})]}),c.jsx("div",{className:"pt-6 border-t border-gray-200",children:c.jsx("button",{onClick:i,disabled:n,className:"w-full bg-unistay-navy hover:bg-opacity-90 text-white font-bold text-lg py-4 px-8 rounded-full transition-all duration-300 transform hover:scale-105 flex items-center justify-center disabled:bg-opacity-70",children:n?c.jsx(Q,{color:"white",size:"md"}):"Book Now"})})]})]}),c.jsx("style",{children:`
          @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
          }
          @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.95) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
          }
      `})]})},yt=({children:t})=>c.jsx("h3",{className:"text-xl font-bold text-unistay-navy mb-4 border-b pb-2",children:t}),Ee=t=>c.jsx("input",{...t,className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-200"}),me=({children:t,...e})=>c.jsx("select",{...e,className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-200",children:t}),nf=t=>c.jsx("textarea",{...t,rows:4,className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-200"}),W=({children:t,...e})=>c.jsx("label",{...e,className:"block text-sm font-medium text-gray-700 mb-1",children:t}),sf=({profile:t,user:e,onProfileUpdate:n,onCancel:s,isProfileIncomplete:i})=>{const r={id:e.id,name:e.name.split(" ")[0],imageUrl:`https://picsum.photos/seed/${e.name.toLowerCase()}/400/400`,age:20,gender:"Female",universityId:ue[0].id,course:"",yearOfStudy:1,budget:5e5,moveInDate:new Date().toISOString().split("T")[0],leaseDuration:"Semester",bio:"",isSmoker:!1,drinksAlcohol:"No",studySchedule:"Flexible",cleanliness:"Average",guestFrequency:"Rarely",hobbies:"",seekingGender:"Any",...t},[o,l]=C.useState(r),[h,d]=C.useState(!1),f=g=>{const{name:y,value:v,type:x,checked:w}=g.target;l(_=>({..._,[y]:x==="checkbox"?w:v}))},m=g=>{const{name:y,value:v}=g.target;l(x=>({...x,[y]:parseInt(v,10)||0}))},p=async g=>{g.preventDefault(),d(!0),await n(o),d(!1)};return c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8 animate-fade-in",children:[c.jsx("h2",{className:"text-2xl font-bold text-unistay-navy mb-1",children:i?"Complete Your Profile":t?"Update Your Profile":"Create Your Roommate Profile"}),c.jsx("p",{className:"text-gray-600 mb-6",children:i?"Welcome to UniStay! Please fill out the details below to start finding roommates.":"A detailed profile helps us find you the best matches!"}),c.jsxs("form",{onSubmit:p,className:"space-y-8",children:[c.jsxs("div",{children:[c.jsx(yt,{children:"Personal Details"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(W,{htmlFor:"name",children:"First Name"}),c.jsx(Ee,{id:"name",name:"name",value:o.name,onChange:f,required:!0})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"age",children:"Age"}),c.jsx(Ee,{id:"age",name:"age",type:"number",value:o.age,onChange:m,required:!0})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"gender",children:"Gender"}),c.jsx(me,{id:"gender",name:"gender",value:o.gender,onChange:f,children:Ko.map(g=>c.jsx("option",{value:g,children:g},g))})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"universityId",children:"University"}),c.jsx(me,{id:"universityId",name:"universityId",value:o.universityId,onChange:f,children:ue.map(g=>c.jsx("option",{value:g.id,children:g.name},g.id))})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"course",children:"Course of Study"}),c.jsx(Ee,{id:"course",name:"course",value:o.course,onChange:f,placeholder:"e.g., Computer Science",required:!0})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"yearOfStudy",children:"Year of Study"}),c.jsx(Ee,{id:"yearOfStudy",name:"yearOfStudy",type:"number",min:"1",max:"7",value:o.yearOfStudy,onChange:m,required:!0})]})]})]}),c.jsxs("div",{children:[c.jsx(yt,{children:"Accommodation Needs"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{children:[c.jsx(W,{htmlFor:"budget",children:"Monthly Budget (UGX)"}),c.jsx(Ee,{id:"budget",name:"budget",type:"number",step:"50000",value:o.budget,onChange:m,required:!0})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"moveInDate",children:"Move-in Date"}),c.jsx(Ee,{id:"moveInDate",name:"moveInDate",type:"date",value:o.moveInDate,onChange:f,required:!0})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"leaseDuration",children:"Lease Duration"}),c.jsx(me,{id:"leaseDuration",name:"leaseDuration",value:o.leaseDuration,onChange:f,children:Yo.map(g=>c.jsx("option",{value:g,children:g},g))})]})]})]}),c.jsxs("div",{children:[c.jsx(yt,{children:"Lifestyle & Habits"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{children:[c.jsx(W,{htmlFor:"studySchedule",children:"Study Schedule"}),c.jsx(me,{id:"studySchedule",name:"studySchedule",value:o.studySchedule,onChange:f,children:Qo.map(g=>c.jsx("option",{value:g,children:g},g))})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"cleanliness",children:"Cleanliness"}),c.jsx(me,{id:"cleanliness",name:"cleanliness",value:o.cleanliness,onChange:f,children:Xo.map(g=>c.jsx("option",{value:g,children:g},g))})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"guestFrequency",children:"Guest Frequency"}),c.jsx(me,{id:"guestFrequency",name:"guestFrequency",value:o.guestFrequency,onChange:f,children:Zo.map(g=>c.jsx("option",{value:g,children:g},g))})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"drinksAlcohol",children:"Drinking Habits"}),c.jsx(me,{id:"drinksAlcohol",name:"drinksAlcohol",value:o.drinksAlcohol,onChange:f,children:ea.map(g=>c.jsx("option",{value:g,children:g},g))})]}),c.jsxs("div",{className:"flex items-center pt-6",children:[c.jsx("input",{id:"isSmoker",name:"isSmoker",type:"checkbox",checked:o.isSmoker,onChange:f,className:"h-4 w-4 text-unistay-yellow focus:ring-unistay-yellow border-gray-300 rounded"}),c.jsx(W,{htmlFor:"isSmoker",className:"ml-2",children:"Are you a smoker?"})]})]})]}),c.jsxs("div",{children:[c.jsx(yt,{children:"About You & What You're Looking For"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(W,{htmlFor:"seekingGender",children:"Seeking Roommate Gender"}),c.jsx(me,{id:"seekingGender",name:"seekingGender",value:o.seekingGender,onChange:f,children:zo.map(g=>c.jsx("option",{value:g,children:g},g))})]}),c.jsxs("div",{children:[c.jsx(W,{htmlFor:"hobbies",children:"Hobbies (comma-separated)"}),c.jsx(Ee,{id:"hobbies",name:"hobbies",value:o.hobbies,onChange:f,placeholder:"e.g., Football, Reading, Movies"})]})]}),c.jsxs("div",{className:"mt-6",children:[c.jsx(W,{htmlFor:"bio",children:"Short Bio"}),c.jsx(nf,{id:"bio",name:"bio",value:o.bio,onChange:f,placeholder:"Tell potential roommates a little about yourself...",required:!0})]})]}),c.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[t&&!i&&c.jsx("button",{type:"button",onClick:s,className:"bg-gray-200 text-gray-800 font-bold py-2 px-6 rounded-full hover:bg-gray-300 transition-colors",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:h,className:"bg-unistay-yellow text-unistay-navy font-bold py-2 px-6 rounded-full hover:bg-yellow-400 transition-colors disabled:bg-yellow-400/70 disabled:cursor-not-allowed flex items-center justify-center min-w-[150px]",children:h?c.jsx(Q,{color:"navy",size:"sm"}):t?"Save Changes":"Create Profile & Find Matches"})]})]})]})};function rf(t,e){if(!t||!e)return 0;let n=0;const s={gender:20,budget:25,university:20,lifestyle:25,interest:10},i=t.seekingGender==="Any"||t.seekingGender===e.gender,r=e.seekingGender==="Any"||e.seekingGender===t.gender;i&&r&&(n+=s.gender);const o=Math.abs(t.budget-e.budget),l=Math.max(t.budget,1),h=Math.max(0,1-o/l);n+=h*s.budget,t.universityId===e.universityId&&(n+=s.university);let d=0;const f=5;t.isSmoker===e.isSmoker&&d++,t.studySchedule===e.studySchedule?d++:(t.studySchedule==="Flexible"||e.studySchedule==="Flexible")&&(d+=.5);const m={Tidy:2,Average:1,Relaxed:0};Math.abs(m[t.cleanliness]-m[e.cleanliness])===0?d++:Math.abs(m[t.cleanliness]-m[e.cleanliness])===1&&(d+=.5);const p={Often:2,Sometimes:1,Rarely:0};Math.abs(p[t.guestFrequency]-p[e.guestFrequency])===0?d++:Math.abs(p[t.guestFrequency]-p[e.guestFrequency])===1&&(d+=.5),t.drinksAlcohol===e.drinksAlcohol?d++:(t.drinksAlcohol==="Rarely"||e.drinksAlcohol==="Rarely")&&(d+=.5),n+=d/f*s.lifestyle;let g=0;Math.abs(t.yearOfStudy-e.yearOfStudy)<=1&&(g+=5);const y=t.hobbies.toLowerCase().split(",").map(w=>w.trim()).filter(Boolean),v=e.hobbies.toLowerCase().split(",").map(w=>w.trim()).filter(Boolean),x=y.filter(w=>v.includes(w)).length;return g+=Math.min(5,x*2.5),n+=g/10*s.interest,Math.round(n)}const of=({profile:t,score:e,universityName:n})=>{const[s,i]=C.useState(!1),r=()=>{i(!0),setTimeout(()=>{i(!1)},2e3)};return c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 h-full flex flex-col border-4 border-transparent hover:border-unistay-yellow",children:[c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:t.imageUrl,alt:t.name,className:"h-56 w-full object-cover"}),c.jsxs("div",{className:"absolute top-3 right-3 bg-unistay-navy text-white rounded-full h-16 w-16 flex flex-col items-center justify-center font-bold shadow-lg",children:[c.jsxs("span",{className:"text-2xl",children:[e,"%"]}),c.jsx("span",{className:"text-xs",children:"Match"})]})]}),c.jsxs("div",{className:"p-5 flex flex-col flex-grow",children:[c.jsxs("h3",{className:"text-xl font-bold text-unistay-navy",children:[t.name,", ",t.age]}),c.jsxs("p",{className:"text-gray-500 text-sm",children:[n," · ",t.course]}),c.jsx("p",{className:"text-gray-600 mt-3 text-sm flex-grow",children:t.bio}),c.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[c.jsx("span",{className:"bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full",children:t.studySchedule}),c.jsx("span",{className:"bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full",children:t.cleanliness}),c.jsx("span",{className:"bg-gray-200 text-gray-700 text-xs font-semibold px-2.5 py-1 rounded-full",children:t.isSmoker?"Smoker":"Non-Smoker"})]})]}),c.jsx("div",{className:"p-4 bg-gray-50 border-t",children:c.jsx("button",{onClick:r,disabled:s,className:"w-full bg-unistay-navy hover:bg-opacity-90 text-white font-bold py-2 px-4 rounded-full transition-all duration-300 flex items-center justify-center disabled:bg-opacity-70",children:s?c.jsx(Q,{color:"white",size:"sm"}):"Request to Connect"})})]})},af=({userProfile:t,profiles:e,universities:n,onEditProfile:s})=>{const i=C.useMemo(()=>new Map(n.map(o=>[o.id,o.name])),[n]),r=C.useMemo(()=>t?e.filter(o=>o.id!==t.id).map(o=>({profile:o,score:rf(t,o)})).sort((o,l)=>l.score-o.score):[],[t,e]);return c.jsxs("div",{className:"animate-fade-in",children:[c.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-8",children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-unistay-navy",children:"Your Top Roommate Matches"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Based on your profile, here are your most compatible roommates."})]}),c.jsx("button",{onClick:s,className:"bg-unistay-yellow text-unistay-navy font-bold py-2 px-6 rounded-full hover:bg-yellow-400 transition-colors flex-shrink-0",children:"Edit My Profile"})]})}),r.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.slice(0,9).map(({profile:o,score:l},h)=>c.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:`${h*100}ms`},children:c.jsx(of,{profile:o,score:l,universityName:i.get(o.universityId)||"Unknown University"})},o.id))}):c.jsxs("div",{className:"text-center py-16 bg-white rounded-lg shadow-md",children:[c.jsx("i",{className:"fas fa-users text-4xl text-gray-300 mb-4"}),c.jsx("h3",{className:"text-xl font-semibold text-unistay-navy",children:"No Matches Found Yet"}),c.jsx("p",{className:"text-gray-500 mt-2",children:"We couldn't find any compatible roommates right now. More students are signing up every day, so check back soon!"})]})]})},lf=({currentUser:t,currentUserProfile:e,onProfileUpdate:n,profiles:s,universities:i,onNavigateHome:r})=>{const[o,l]=C.useState(!1),h=!e||!e.contactNumber||!e.universityId||!e.course,d=h||o,f=async m=>{await n(m),l(!1)};return c.jsxs("div",{className:"bg-gray-100 min-h-screen",children:[c.jsx("header",{className:"bg-unistay-navy text-white shadow-lg sticky top-0 z-40",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-20",children:[c.jsx("h1",{className:"text-3xl font-bold",children:"Find a Roommate"}),c.jsxs("button",{onClick:r,className:"font-semibold hover:text-unistay-yellow transition-colors flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-arrow-left"}),"Back to Home"]})]})}),c.jsx("main",{className:"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 pt-24",children:d?c.jsx(sf,{profile:e,user:t,onProfileUpdate:f,onCancel:()=>l(!1),isProfileIncomplete:h}):c.jsx(af,{userProfile:e,profiles:s,universities:i,onEditProfile:()=>l(!0)})})]})},uf=({news:t,onClose:e})=>{const n=C.useCallback(i=>{i.key==="Escape"&&e()},[e]);C.useEffect(()=>(document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}),[n]);const s=i=>{if(!t)return;const r=encodeURIComponent(window.location.href),o=encodeURIComponent(t.title),l={twitter:`https://twitter.com/intent/tweet?text=${o}&url=${r}`,facebook:`https://www.facebook.com/sharer/sharer.php?u=${r}`,linkedin:`https://www.linkedin.com/shareArticle?mini=true&url=${r}&title=${o}`,whatsapp:`https://api.whatsapp.com/send?text=${o}%20${r}`};window.open(l[i],"_blank","noopener,noreferrer")};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto relative animate-scale-up",children:[c.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors","aria-label":"Close modal",children:c.jsx("i",{className:"fas fa-times text-xl"})}),c.jsx("div",{className:"w-full h-64 sm:h-80 relative",children:c.jsx("img",{src:t.imageUrl.replace("/100/100","/800/600"),alt:t.title,className:"w-full h-full object-cover"})}),c.jsxs("div",{className:"p-6 sm:p-8",children:[c.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 mb-4",children:[c.jsx("p",{children:Ut(t.timestamp)}),c.jsxs("p",{children:["Source: ",t.source]})]}),c.jsx("h2",{className:"text-3xl font-bold text-unistay-navy mb-6",children:t.title}),c.jsx("div",{className:"prose max-w-none",children:c.jsx("p",{className:"text-gray-600 leading-relaxed whitespace-pre-line",children:t.description})}),c.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Share this article:"}),c.jsxs("div",{className:"flex gap-4 mt-2",children:[c.jsx("button",{onClick:()=>s("twitter"),className:"text-gray-600 hover:text-[#1DA1F2] transition-colors","aria-label":"Share on Twitter",children:c.jsx("i",{className:"fab fa-twitter"})}),c.jsx("button",{onClick:()=>s("facebook"),className:"text-gray-600 hover:text-[#4267B2] transition-colors","aria-label":"Share on Facebook",children:c.jsx("i",{className:"fab fa-facebook"})}),c.jsx("button",{onClick:()=>s("linkedin"),className:"text-gray-600 hover:text-[#0077b5] transition-colors","aria-label":"Share on LinkedIn",children:c.jsx("i",{className:"fab fa-linkedin"})}),c.jsx("button",{onClick:()=>s("whatsapp"),className:"text-gray-600 hover:text-[#25D366] transition-colors","aria-label":"Share on WhatsApp",children:c.jsx("i",{className:"fab fa-whatsapp"})})]})]}),c.jsxs("button",{onClick:e,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-2 px-6 rounded-lg transition-colors flex items-center gap-2","aria-label":"Close modal",children:[c.jsx("i",{className:"fas fa-times"}),"Close"]})]})})]})]})}):null},cf=({news:t,onNavigateHome:e})=>{const[n,s]=C.useState(null),i=t.length>0?t[0]:null,r=t.length>1?t.slice(1):[];return c.jsxs("div",{className:"bg-gray-50 min-h-screen flex flex-col",children:[c.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-20",children:[c.jsx("h1",{className:"text-3xl font-bold text-unistay-navy",children:"UniStay Blog"}),c.jsxs("button",{onClick:e,className:"font-semibold text-unistay-navy hover:text-unistay-yellow transition-colors flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-arrow-left"}),"Back to Home"]})]})}),c.jsxs("main",{className:"flex-grow max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 w-full pt-24",children:[i&&c.jsx("section",{className:"mb-12 group animate-fade-in",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[c.jsx("div",{className:"rounded-2xl overflow-hidden shadow-lg group-hover:shadow-2xl transition-shadow duration-300",children:c.jsx("img",{src:i.imageUrl.replace("/100/100","/600/400"),alt:i.title,className:"w-full h-full object-cover"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-unistay-yellow font-semibold mb-2",children:"Featured Article"}),c.jsx("h2",{className:"text-4xl font-extrabold text-unistay-navy mb-4",children:i.title}),c.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-6",children:[c.jsx("p",{children:Ut(i.timestamp)}),c.jsxs("p",{children:["Source: ",i.source]})]}),c.jsxs("button",{onClick:()=>s(i),className:"mt-6 bg-unistay-navy text-white font-bold py-3 px-8 rounded-full hover:bg-opacity-90 transition-all transform hover:scale-105 flex items-center gap-2",children:["Read Full Article ",c.jsx("i",{className:"fas fa-arrow-right"})]})]})]})}),c.jsxs("section",{className:"animate-fade-in-up",style:{animationDelay:"200ms"},children:[c.jsx("h3",{className:"text-2xl font-bold text-unistay-navy mb-6 border-b pb-2",children:"Latest News"}),r.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map((o,l)=>c.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden group transform hover:-translate-y-2 transition-transform duration-300 flex flex-col",style:{animation:"fade-in-up 0.5s ease-out forwards",animationDelay:`${l*100}ms`},children:[c.jsx("img",{src:o.imageUrl.replace("/100/100","/400/300"),alt:o.title,className:"h-48 w-full object-cover"}),c.jsxs("div",{className:"p-6 flex flex-col flex-grow",children:[c.jsx("h4",{className:"text-xl font-bold text-unistay-navy flex-grow group-hover:text-unistay-yellow transition-colors",children:o.title}),c.jsxs("div",{className:"flex justify-between items-center mt-2 mb-4",children:[c.jsx("p",{className:"text-xs text-gray-400",children:Ut(o.timestamp)}),c.jsxs("p",{className:"text-xs text-gray-400",children:["Source: ",o.source]})]}),c.jsx("div",{className:"pt-4 border-t border-gray-100 flex justify-end",children:c.jsxs("button",{onClick:()=>s(o),className:"text-sm font-semibold text-unistay-yellow hover:text-unistay-navy transition-colors flex items-center gap-1",children:["Read More ",c.jsx("i",{className:"fas fa-arrow-right"})]})})]})]},o.id))}):c.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[c.jsx("i",{className:"fas fa-newspaper text-4xl text-gray-300 mb-4"}),c.jsx("h3",{className:"text-xl font-semibold text-unistay-navy",children:"No More News"}),c.jsx("p",{className:"text-gray-500 mt-2",children:"Check back later for more updates!"})]})]})]}),c.jsx(uf,{news:n,onClose:()=>s(null)})]})},df=({event:t,onClose:e})=>{const n=Array.isArray(t.contacts)?t.contacts:[];return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto relative animate-scale-up",children:[c.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-white hover:text-unistay-yellow transition-colors z-10 bg-unistay-navy rounded-full w-10 h-10 flex items-center justify-center","aria-label":"Close modal",children:c.jsx("i",{className:"fas fa-times text-xl"})}),c.jsxs("div",{className:"w-full h-96 relative",children:[c.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover"}),c.jsxs("div",{className:"absolute top-6 left-6 bg-unistay-yellow text-unistay-navy text-center rounded-xl px-4 py-2 shadow-lg",children:[c.jsx("p",{className:"font-extrabold text-3xl",children:t.day}),c.jsx("p",{className:"font-bold text-lg leading-tight",children:t.month})]})]}),c.jsxs("div",{className:"p-8",children:[c.jsx("h2",{className:"text-3xl font-bold text-unistay-navy mb-4",children:t.title}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[c.jsx("i",{className:"fas fa-map-marker-alt text-unistay-yellow text-xl w-6"}),c.jsx("span",{children:t.location})]}),c.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[c.jsx("i",{className:"fas fa-calendar text-unistay-yellow text-xl w-6"}),c.jsx("span",{children:t.date})]}),t.time&&c.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[c.jsx("i",{className:"fas fa-clock text-unistay-yellow text-xl w-6"}),c.jsx("span",{children:t.time})]}),c.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[c.jsx("i",{className:"fas fa-ticket-alt text-unistay-yellow text-xl w-6"}),c.jsx("span",{children:t.price||"Free Entry"})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-bold text-lg text-unistay-navy",children:"Contact Information"}),c.jsxs("div",{className:"space-y-3 text-gray-600",children:[n.length>0&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-unistay-navy",children:"Contact Persons:"}),n.map((s,i)=>c.jsxs("div",{className:"flex items-center gap-3 ml-4",children:[c.jsx("i",{className:"fas fa-user text-unistay-yellow text-lg w-5"}),c.jsx("span",{children:s})]},i))]}),t.phone&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("i",{className:"fas fa-phone text-unistay-yellow text-xl w-6"}),c.jsx("a",{href:`tel:${t.phone}`,className:"hover:text-unistay-navy transition-colors",children:t.phone})]}),t.email&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("i",{className:"fas fa-envelope text-unistay-yellow text-xl w-6"}),c.jsx("a",{href:`mailto:${t.email}`,className:"hover:text-unistay-navy transition-colors",children:t.email})]}),n.length===0&&!t.phone&&!t.email&&c.jsx("p",{className:"text-gray-500 italic",children:"No contact information provided"})]})]})]}),t.description?c.jsxs("div",{className:"border-t pt-8",children:[c.jsx("h3",{className:"font-bold text-lg text-unistay-navy mb-4",children:"About the Event"}),c.jsx("p",{className:"text-gray-600 whitespace-pre-line leading-relaxed",children:t.description})]}):c.jsx("div",{className:"border-t pt-8",children:c.jsx("p",{className:"text-gray-500 italic",children:"No description provided"})}),c.jsxs("div",{className:"flex flex-wrap gap-4 mt-8 pt-8 border-t",children:[t.phone&&c.jsxs("a",{href:`tel:${t.phone}`,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-opacity-90 transition-colors flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-phone"}),"Call Now"]}),t.email&&c.jsxs("a",{href:`mailto:${t.email}?subject=Regarding: ${t.title}`,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-opacity-90 transition-colors flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-envelope"}),"Send Email"]}),t.price&&t.price!=="Free Entry"&&c.jsxs("div",{className:"bg-unistay-yellow text-unistay-navy px-6 py-3 rounded-lg flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-ticket-alt"}),"Entry Fee: ",t.price]}),c.jsx("button",{onClick:e,className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200 transition-colors ml-auto",children:"Close"})]})]})]})})},hf=({events:t,onNavigateHome:e})=>{const[n,s]=C.useState(null);return c.jsxs("div",{className:"bg-gray-100 min-h-screen",children:[c.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-20",children:[c.jsx("h1",{className:"text-3xl font-bold text-unistay-navy",children:"Campus Events"}),c.jsxs("button",{onClick:e,className:"font-semibold text-unistay-navy hover:text-unistay-yellow transition-colors flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-arrow-left"}),"Back to Home"]})]})}),c.jsx("main",{className:"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 pt-24",children:t.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map((i,r)=>c.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden group transform hover:-translate-y-2 transition-transform duration-300",style:{animation:"fade-in-up 0.5s ease-out forwards",animationDelay:`${r*100}ms`},children:[c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:i.imageUrl,alt:i.title,className:"h-56 w-full object-cover"}),c.jsxs("div",{className:"absolute top-4 left-4 bg-unistay-yellow text-unistay-navy text-center rounded-lg px-4 py-2 shadow-lg",children:[c.jsx("p",{className:"font-extrabold text-2xl",children:i.day}),c.jsx("p",{className:"font-bold text-sm leading-tight",children:i.month})]})]}),c.jsxs("div",{className:"p-5",children:[c.jsx("h3",{className:"font-bold text-xl text-unistay-navy mb-2 group-hover:text-unistay-yellow transition-colors",children:i.title}),c.jsxs("p",{className:"text-sm text-gray-600",children:[c.jsx("i",{className:"fas fa-calendar-alt text-gray-400 mr-2"}),i.date]}),c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[c.jsx("i",{className:"fas fa-map-marker-alt text-gray-400 mr-2"}),i.location]}),c.jsx("button",{onClick:()=>s(i),className:"mt-4 w-full bg-unistay-navy text-white font-semibold py-2 rounded-lg hover:bg-opacity-80 transition-all transform hover:scale-105",children:"More Info"})]})]},i.id))}):c.jsxs("div",{className:"text-center py-16 bg-white rounded-lg shadow-md",children:[c.jsx("i",{className:"fas fa-calendar-times text-4xl text-gray-300 mb-4"}),c.jsx("h3",{className:"text-xl font-semibold text-unistay-navy",children:"No Upcoming Events"}),c.jsx("p",{className:"text-gray-500 mt-2",children:"Please check back soon for new events!"})]})}),n&&c.jsx(df,{event:n,onClose:()=>s(null)})]})},ff=({job:t,onClose:e})=>(C.useEffect(()=>{const n=s=>{s.key==="Escape"&&e()};return window.addEventListener("keydown",n),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",n),document.body.style.overflow="unset"}},[e]),c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 z-[100] flex items-center justify-center p-4 animate-fade-in",onClick:e,children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] flex flex-col animate-slide-in-down",onClick:n=>n.stopPropagation(),children:[c.jsxs("div",{className:"p-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-extrabold text-unistay-navy",children:t.title}),c.jsxs("p",{className:"text-gray-600 mt-1",children:[t.company," · ",c.jsx("span",{className:"text-gray-500",children:t.location})]})]}),c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-unistay-navy transition-colors h-10 w-10 flex items-center justify-center rounded-full hover:bg-gray-100 flex-shrink-0 ml-4","aria-label":"Close modal",children:c.jsx("i",{className:"fas fa-times text-xl"})})]}),c.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[c.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-1 rounded-full",children:t.type}),c.jsxs("span",{className:"bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-1 rounded-full",children:["Deadline: ",t.deadline]})]})]}),c.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto no-scrollbar flex-grow",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold text-unistay-navy mb-2",children:"Job Description"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.description})]}),t.responsibilities&&t.responsibilities.length>0&&c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold text-unistay-navy mb-2",children:"Responsibilities"}),c.jsx("ul",{className:"list-disc list-inside space-y-1 text-gray-700",children:t.responsibilities.map((n,s)=>c.jsx("li",{children:n},s))})]}),t.qualifications&&t.qualifications.length>0&&c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold text-unistay-navy mb-2",children:"Qualifications"}),c.jsx("ul",{className:"list-disc list-inside space-y-1 text-gray-700",children:t.qualifications.map((n,s)=>c.jsx("li",{children:n},s))})]})]}),c.jsx("div",{className:"p-6 border-t border-gray-200 bg-white",children:c.jsx("a",{href:t.howToApply,target:"_blank",rel:"noopener noreferrer",className:"w-full block text-center bg-unistay-navy hover:bg-opacity-90 text-white font-bold text-lg py-3 px-8 rounded-full transition-all duration-300 transform hover:scale-105",children:"Apply Now"})})]})})),mf=({jobs:t,onNavigateHome:e})=>{const[n,s]=C.useState(null),i=o=>{s(o)},r=()=>{s(null)};return c.jsxs("div",{className:"bg-gray-100 min-h-screen",children:[c.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-20",children:[c.jsx("h1",{className:"text-3xl font-bold text-unistay-navy",children:"Jobs & Internships"}),c.jsxs("button",{onClick:e,className:"font-semibold text-unistay-navy hover:text-unistay-yellow transition-colors flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-arrow-left"}),"Back to Home"]})]})}),c.jsx("main",{className:"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8 pt-24",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-unistay-navy mb-6",children:"Current Opportunities"}),t.length>0?c.jsx("div",{className:"space-y-6",children:t.map((o,l)=>c.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 p-4 border rounded-lg hover:shadow-md hover:border-unistay-yellow transition-all duration-300",style:{animation:"fade-in-up 0.5s ease-out forwards",animationDelay:`${l*100}ms`},children:[c.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:c.jsx("img",{src:o.imageUrl,alt:o.company,className:"w-16 h-16 object-contain"})}),c.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[c.jsx("p",{className:"font-bold text-lg text-unistay-navy",children:o.title}),c.jsx("p",{className:"text-md text-gray-700",children:o.company})]}),c.jsxs("div",{className:"text-center sm:text-right flex-shrink-0",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Apply by"}),c.jsx("p",{className:"font-semibold text-unistay-navy text-lg",children:o.deadline})]}),c.jsx("button",{onClick:()=>i(o),className:"w-full sm:w-auto bg-unistay-navy text-white font-semibold py-2 px-6 rounded-lg hover:bg-opacity-80 transition-all flex-shrink-0 transform hover:scale-105",children:"Details"})]},o.id))}):c.jsxs("div",{className:"text-center py-16",children:[c.jsx("i",{className:"fas fa-briefcase text-4xl text-gray-300 mb-4"}),c.jsx("h3",{className:"text-xl font-semibold text-unistay-navy",children:"No Job Openings"}),c.jsx("p",{className:"text-gray-500 mt-2",children:"New opportunities are posted regularly. Check back soon!"})]})]})}),n&&c.jsx(ff,{job:n,onClose:r})]})};var yn=function(t,e){return yn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},yn(t,e)};function br(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");yn(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Dt=function(){return Dt=Object.assign||function(e){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dt.apply(this,arguments)};function Xe(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n}function Er(t,e,n,s){var i=arguments.length,r=i<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,n):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(t,e,n,s);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(r=(i<3?o(r):i>3?o(e,n,r):o(e,n))||r);return i>3&&r&&Object.defineProperty(e,n,r),r}function Tr(t,e){return function(n,s){e(n,s,t)}}function Sr(t,e,n,s,i,r){function o(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var l=s.kind,h=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&t?s.static?t:t.prototype:null,f=e||(d?Object.getOwnPropertyDescriptor(d,s.name):{}),m,p=!1,g=n.length-1;g>=0;g--){var y={};for(var v in s)y[v]=v==="access"?{}:s[v];for(var v in s.access)y.access[v]=s.access[v];y.addInitializer=function(w){if(p)throw new TypeError("Cannot add initializers after decoration has completed");r.push(o(w||null))};var x=(0,n[g])(l==="accessor"?{get:f.get,set:f.set}:f[h],y);if(l==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(m=o(x.get))&&(f.get=m),(m=o(x.set))&&(f.set=m),(m=o(x.init))&&i.unshift(m)}else(m=o(x))&&(l==="field"?i.unshift(m):f[h]=m)}d&&Object.defineProperty(d,s.name,f),p=!0}function Cr(t,e,n){for(var s=arguments.length>2,i=0;i<e.length;i++)n=s?e[i].call(t,n):e[i].call(t);return s?n:void 0}function Nr(t){return typeof t=="symbol"?t:"".concat(t)}function Ir(t,e,n){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function Ar(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function A(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function l(f){try{d(s.next(f))}catch(m){o(m)}}function h(f){try{d(s.throw(f))}catch(m){o(m)}}function d(f){f.done?r(f.value):i(f.value).then(l,h)}d((s=s.apply(t,e||[])).next())})}function Rr(t,e){var n={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},s,i,r,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(f){return h([d,f])}}function h(d){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(n=0)),n;)try{if(s=1,i&&(r=d[0]&2?i.return:d[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,d[1])).done)return r;switch(i=0,r&&(d=[d[0]&2,r.value]),d[0]){case 0:case 1:r=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,i=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(r=n.trys,!(r=r.length>0&&r[r.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!r||d[1]>r[0]&&d[1]<r[3])){n.label=d[1];break}if(d[0]===6&&n.label<r[1]){n.label=r[1],r=d;break}if(r&&n.label<r[2]){n.label=r[2],n.ops.push(d);break}r[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(f){d=[6,f],i=0}finally{s=r=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Jt=Object.create?function(t,e,n,s){s===void 0&&(s=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,s,i)}:function(t,e,n,s){s===void 0&&(s=n),t[s]=e[n]};function Pr(t,e){for(var n in t)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&Jt(e,t,n)}function Lt(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ln(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var s=n.call(t),i,r=[],o;try{for(;(e===void 0||e-- >0)&&!(i=s.next()).done;)r.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return r}function kr(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ln(arguments[e]));return t}function Mr(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var s=Array(t),i=0,e=0;e<n;e++)for(var r=arguments[e],o=0,l=r.length;o<l;o++,i++)s[i]=r[o];return s}function Ur(t,e,n){if(n||arguments.length===2)for(var s=0,i=e.length,r;s<i;s++)(r||!(s in e))&&(r||(r=Array.prototype.slice.call(e,0,s)),r[s]=e[s]);return t.concat(r||Array.prototype.slice.call(e))}function We(t){return this instanceof We?(this.v=t,this):new We(t)}function Dr(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),i,r=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(g){return function(y){return Promise.resolve(y).then(g,m)}}function l(g,y){s[g]&&(i[g]=function(v){return new Promise(function(x,w){r.push([g,v,x,w])>1||h(g,v)})},y&&(i[g]=y(i[g])))}function h(g,y){try{d(s[g](y))}catch(v){p(r[0][3],v)}}function d(g){g.value instanceof We?Promise.resolve(g.value.v).then(f,m):p(r[0][2],g)}function f(g){h("next",g)}function m(g){h("throw",g)}function p(g,y){g(y),r.shift(),r.length&&h(r[0][0],r[0][1])}}function Lr(t){var e,n;return e={},s("next"),s("throw",function(i){throw i}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(i,r){e[i]=t[i]?function(o){return(n=!n)?{value:We(t[i](o)),done:!1}:r?r(o):o}:r}}function Fr(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Lt=="function"?Lt(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(r){n[r]=t[r]&&function(o){return new Promise(function(l,h){o=t[r](o),i(l,h,o.done,o.value)})}}function i(r,o,l,h){Promise.resolve(h).then(function(d){r({value:d,done:l})},o)}}function jr(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var pf=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},vn=function(t){return vn=Object.getOwnPropertyNames||function(e){var n=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[n.length]=s);return n},vn(t)};function $r(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n=vn(t),s=0;s<n.length;s++)n[s]!=="default"&&Jt(e,t,n[s]);return pf(e,t),e}function Or(t){return t&&t.__esModule?t:{default:t}}function qr(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}function Vr(t,e,n,s,i){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n}function Gr(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function Br(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],n&&(i=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");i&&(s=function(){try{i.call(this)}catch(r){return Promise.reject(r)}}),t.stack.push({value:e,dispose:s,async:n})}else n&&t.stack.push({async:!0});return e}var gf=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var s=new Error(n);return s.name="SuppressedError",s.error=t,s.suppressed=e,s};function Hr(t){function e(r){t.error=t.hasError?new gf(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}var n,s=0;function i(){for(;n=t.stack.pop();)try{if(!n.async&&s===1)return s=0,t.stack.push(n),Promise.resolve().then(i);if(n.dispose){var r=n.dispose.call(n.value);if(n.async)return s|=2,Promise.resolve(r).then(i,function(o){return e(o),i()})}else s|=1}catch(o){e(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}function Jr(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,s,i,r,o){return s?e?".jsx":".js":i&&(!r||!o)?n:i+r+"."+o.toLowerCase()+"js"}):t}const yf={__extends:br,__assign:Dt,__rest:Xe,__decorate:Er,__param:Tr,__esDecorate:Sr,__runInitializers:Cr,__propKey:Nr,__setFunctionName:Ir,__metadata:Ar,__awaiter:A,__generator:Rr,__createBinding:Jt,__exportStar:Pr,__values:Lt,__read:Ln,__spread:kr,__spreadArrays:Mr,__spreadArray:Ur,__await:We,__asyncGenerator:Dr,__asyncDelegator:Lr,__asyncValues:Fr,__makeTemplateObject:jr,__importStar:$r,__importDefault:Or,__classPrivateFieldGet:qr,__classPrivateFieldSet:Vr,__classPrivateFieldIn:Gr,__addDisposableResource:Br,__disposeResources:Hr,__rewriteRelativeImportExtension:Jr},vf=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Br,get __assign(){return Dt},__asyncDelegator:Lr,__asyncGenerator:Dr,__asyncValues:Fr,__await:We,__awaiter:A,__classPrivateFieldGet:qr,__classPrivateFieldIn:Gr,__classPrivateFieldSet:Vr,__createBinding:Jt,__decorate:Er,__disposeResources:Hr,__esDecorate:Sr,__exportStar:Pr,__extends:br,__generator:Rr,__importDefault:Or,__importStar:$r,__makeTemplateObject:jr,__metadata:Ar,__param:Tr,__propKey:Nr,__read:Ln,__rest:Xe,__rewriteRelativeImportExtension:Jr,__runInitializers:Cr,__setFunctionName:Ir,__spread:kr,__spreadArray:Ur,__spreadArrays:Mr,__values:Lt,default:yf},Symbol.toStringTag,{value:"Module"})),xf="modulepreload",wf=function(t){return"/unistay101/"+t},gi={},Ze=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=Promise.allSettled(n.map(h=>{if(h=wf(h),h in gi)return;gi[h]=!0;const d=h.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${f}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":xf,d||(m.as="script"),m.crossOrigin="",m.href=h,l&&m.setAttribute("nonce",l),document.head.appendChild(m),d)return new Promise((p,g)=>{m.addEventListener("load",p),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${h}`)))})}))}function r(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})},_f=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ze(async()=>{const{default:s}=await Promise.resolve().then(()=>Me);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)};class Fn extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class yi extends Fn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class vi extends Fn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class xi extends Fn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xn;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(xn||(xn={}));class bf{constructor(e,{headers:n={},customFetch:s,region:i=xn.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=_f(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return A(this,arguments,void 0,function*(n,s={}){var i;try{const{headers:r,method:o,body:l,signal:h}=s;let d={},{region:f}=s;f||(f=this.region);const m=new URL(`${this.url}/${n}`);f&&f!=="any"&&(d["x-region"]=f,m.searchParams.set("forceFunctionRegion",f));let p;l&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",p=l):typeof l=="string"?(d["Content-Type"]="text/plain",p=l):typeof FormData<"u"&&l instanceof FormData?p=l:(d["Content-Type"]="application/json",p=JSON.stringify(l)):p=l;const g=yield this.fetch(m.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),r),body:p,signal:h}).catch(w=>{throw w.name==="AbortError"?w:new yi(w)}),y=g.headers.get("x-relay-error");if(y&&y==="true")throw new vi(g);if(!g.ok)throw new xi(g);let v=((i=g.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),x;return v==="application/json"?x=yield g.json():v==="application/octet-stream"||v==="application/pdf"?x=yield g.blob():v==="text/event-stream"?x=g:v==="multipart/form-data"?x=yield g.formData():x=yield g.text(),{data:x,error:null,response:g}}catch(r){return r instanceof Error&&r.name==="AbortError"?{data:null,error:new yi(r)}:{data:null,error:r,response:r instanceof xi||r instanceof vi?r.context:void 0}}})}}var Y={};const et=Ji(vf);var vt={},xt={},wt={},_t={},bt={},Ef=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ke=Ef();const Tf=Ke.fetch,Wr=Ke.fetch.bind(Ke),Kr=Ke.Headers,Sf=Ke.Request,Cf=Ke.Response,Me=Object.freeze(Object.defineProperty({__proto__:null,Headers:Kr,Request:Sf,Response:Cf,default:Wr,fetch:Tf},Symbol.toStringTag,{value:"Module"})),Nf=Ji(Me);var Et={},wi;function zr(){if(wi)return Et;wi=1,Object.defineProperty(Et,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return Et.default=t,Et}var _i;function Yr(){if(_i)return bt;_i=1,Object.defineProperty(bt,"__esModule",{value:!0});const t=et,e=t.__importDefault(Nf),n=t.__importDefault(zr());class s{constructor(r){var o,l;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(o=r.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=r.signal,this.isMaybeSingle=(l=r.isMaybeSingle)!==null&&l!==void 0?l:!1,r.fetch?this.fetch=r.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,o){return this.headers=new Headers(this.headers),this.headers.set(r,o),this}then(r,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let h=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var f,m,p,g;let y=null,v=null,x=null,w=d.status,_=d.statusText;if(d.ok){if(this.method!=="HEAD"){const E=await d.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((f=this.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?v=E:v=JSON.parse(E))}const T=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),S=(p=d.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");T&&S&&S.length>1&&(x=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(y={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,x=null,w=406,_="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const T=await d.text();try{y=JSON.parse(T),Array.isArray(y)&&d.status===404&&(v=[],y=null,w=200,_="OK")}catch{d.status===404&&T===""?(w=204,_="No Content"):y={message:T}}if(y&&this.isMaybeSingle&&(!((g=y?.details)===null||g===void 0)&&g.includes("0 rows"))&&(y=null,w=200,_="OK"),y&&this.shouldThrowOnError)throw new n.default(y)}return{error:y,data:v,count:x,status:w,statusText:_}});return this.shouldThrowOnError||(h=h.catch(d=>{var f,m,p;return{error:{message:`${(f=d?.name)!==null&&f!==void 0?f:"FetchError"}: ${d?.message}`,details:`${(m=d?.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(p=d?.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),h.then(r,o)}returns(){return this}overrideTypes(){return this}}return bt.default=s,bt}var bi;function Qr(){if(bi)return _t;bi=1,Object.defineProperty(_t,"__esModule",{value:!0});const e=et.__importDefault(Yr());class n extends e.default{select(i){let r=!1;const o=(i??"*").split("").map(l=>/\s/.test(l)&&!r?"":(l==='"'&&(r=!r),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:r=!0,nullsFirst:o,foreignTable:l,referencedTable:h=l}={}){const d=h?`${h}.order`:"order",f=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${f?`${f},`:""}${i}.${r?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:r,referencedTable:o=r}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,r,{foreignTable:o,referencedTable:l=o}={}){const h=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(h,`${i}`),this.url.searchParams.set(d,`${r-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:r=!1,settings:o=!1,buffers:l=!1,wal:h=!1,format:d="text"}={}){var f;const m=[i?"analyze":null,r?"verbose":null,o?"settings":null,l?"buffers":null,h?"wal":null].filter(Boolean).join("|"),p=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${p}"; options=${m};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return _t.default=n,_t}var Ei;function jn(){if(Ei)return wt;Ei=1,Object.defineProperty(wt,"__esModule",{value:!0});const e=et.__importDefault(Qr()),n=new RegExp("[,()]");class s extends e.default{eq(r,o){return this.url.searchParams.append(r,`eq.${o}`),this}neq(r,o){return this.url.searchParams.append(r,`neq.${o}`),this}gt(r,o){return this.url.searchParams.append(r,`gt.${o}`),this}gte(r,o){return this.url.searchParams.append(r,`gte.${o}`),this}lt(r,o){return this.url.searchParams.append(r,`lt.${o}`),this}lte(r,o){return this.url.searchParams.append(r,`lte.${o}`),this}like(r,o){return this.url.searchParams.append(r,`like.${o}`),this}likeAllOf(r,o){return this.url.searchParams.append(r,`like(all).{${o.join(",")}}`),this}likeAnyOf(r,o){return this.url.searchParams.append(r,`like(any).{${o.join(",")}}`),this}ilike(r,o){return this.url.searchParams.append(r,`ilike.${o}`),this}ilikeAllOf(r,o){return this.url.searchParams.append(r,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(r,o){return this.url.searchParams.append(r,`ilike(any).{${o.join(",")}}`),this}is(r,o){return this.url.searchParams.append(r,`is.${o}`),this}in(r,o){const l=Array.from(new Set(o)).map(h=>typeof h=="string"&&n.test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(r,`in.(${l})`),this}contains(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cs.{${o.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(o)}`),this}containedBy(r,o){return typeof o=="string"?this.url.searchParams.append(r,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(r,`cd.{${o.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(o)}`),this}rangeGt(r,o){return this.url.searchParams.append(r,`sr.${o}`),this}rangeGte(r,o){return this.url.searchParams.append(r,`nxl.${o}`),this}rangeLt(r,o){return this.url.searchParams.append(r,`sl.${o}`),this}rangeLte(r,o){return this.url.searchParams.append(r,`nxr.${o}`),this}rangeAdjacent(r,o){return this.url.searchParams.append(r,`adj.${o}`),this}overlaps(r,o){return typeof o=="string"?this.url.searchParams.append(r,`ov.${o}`):this.url.searchParams.append(r,`ov.{${o.join(",")}}`),this}textSearch(r,o,{config:l,type:h}={}){let d="";h==="plain"?d="pl":h==="phrase"?d="ph":h==="websearch"&&(d="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(r,`${d}fts${f}.${o}`),this}match(r){return Object.entries(r).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(r,o,l){return this.url.searchParams.append(r,`not.${o}.${l}`),this}or(r,{foreignTable:o,referencedTable:l=o}={}){const h=l?`${l}.or`:"or";return this.url.searchParams.append(h,`(${r})`),this}filter(r,o,l){return this.url.searchParams.append(r,`${o}.${l}`),this}}return wt.default=s,wt}var Ti;function Xr(){if(Ti)return xt;Ti=1,Object.defineProperty(xt,"__esModule",{value:!0});const e=et.__importDefault(jn());class n{constructor(i,{headers:r={},schema:o,fetch:l}){this.url=i,this.headers=new Headers(r),this.schema=o,this.fetch=l}select(i,r){const{head:o=!1,count:l}=r??{},h=o?"HEAD":"GET";let d=!1;const f=(i??"*").split("").map(m=>/\s/.test(m)&&!d?"":(m==='"'&&(d=!d),m)).join("");return this.url.searchParams.set("select",f),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:r,defaultToNull:o=!0}={}){var l;const h="POST";if(r&&this.headers.append("Prefer",`count=${r}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(d.length>0){const f=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:r,ignoreDuplicates:o=!1,count:l,defaultToNull:h=!0}={}){var d;const f="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),l&&this.headers.append("Prefer",`count=${l}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const m=i.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(m.length>0){const p=[...new Set(m)].map(g=>`"${g}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(i,{count:r}={}){var o;const l="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:i}={}){var r;const o="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}}return xt.default=n,xt}var Si;function If(){if(Si)return vt;Si=1,Object.defineProperty(vt,"__esModule",{value:!0});const t=et,e=t.__importDefault(Xr()),n=t.__importDefault(jn());class s{constructor(r,{headers:o={},schema:l,fetch:h}={}){this.url=r,this.headers=new Headers(o),this.schemaName=l,this.fetch=h}from(r){const o=new URL(`${this.url}/${r}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new s(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,o={},{head:l=!1,get:h=!1,count:d}={}){var f;let m;const p=new URL(`${this.url}/rpc/${r}`);let g;l||h?(m=l?"HEAD":"GET",Object.entries(o).filter(([v,x])=>x!==void 0).map(([v,x])=>[v,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([v,x])=>{p.searchParams.append(v,x)})):(m="POST",g=o);const y=new Headers(this.headers);return d&&y.set("Prefer",`count=${d}`),new n.default({method:m,url:p,headers:y,schema:this.schemaName,body:g,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}}return vt.default=s,vt}Object.defineProperty(Y,"__esModule",{value:!0});var Zr=Y.PostgrestError=uo=Y.PostgrestBuilder=ao=Y.PostgrestTransformBuilder=ro=Y.PostgrestFilterBuilder=so=Y.PostgrestQueryBuilder=to=Y.PostgrestClient=void 0;const tt=et,eo=tt.__importDefault(If());var to=Y.PostgrestClient=eo.default;const no=tt.__importDefault(Xr());var so=Y.PostgrestQueryBuilder=no.default;const io=tt.__importDefault(jn());var ro=Y.PostgrestFilterBuilder=io.default;const oo=tt.__importDefault(Qr());var ao=Y.PostgrestTransformBuilder=oo.default;const lo=tt.__importDefault(Yr());var uo=Y.PostgrestBuilder=lo.default;const co=tt.__importDefault(zr());Zr=Y.PostgrestError=co.default;var ho=Y.default={PostgrestClient:eo.default,PostgrestQueryBuilder:no.default,PostgrestFilterBuilder:io.default,PostgrestTransformBuilder:oo.default,PostgrestBuilder:lo.default,PostgrestError:co.default};const Af=Uo({__proto__:null,get PostgrestBuilder(){return uo},get PostgrestClient(){return to},get PostgrestError(){return Zr},get PostgrestFilterBuilder(){return ro},get PostgrestQueryBuilder(){return so},get PostgrestTransformBuilder(){return ao},default:ho},[Y]),{PostgrestClient:Rf,PostgrestQueryBuilder:ug,PostgrestFilterBuilder:cg,PostgrestTransformBuilder:dg,PostgrestBuilder:hg,PostgrestError:fg}=ho||Af;class Pf{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const s=n.node,i=parseInt(s.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const kf="2.77.0",Mf=`realtime-js/${kf}`,Uf="1.0.0",wn=1e4,Df=1e3,Lf=100;var at;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(at||(at={}));var J;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(J||(J={}));var ae;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ae||(ae={}));var _n;(function(t){t.websocket="websocket"})(_n||(_n={}));var Ne;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ne||(Ne={}));class Ff{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const i=n.getUint8(1),r=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+i));o=o+i;const h=s.decode(e.slice(o,o+r));o=o+r;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:h,payload:d}}}class fo{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var F;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(F||(F={}));const Ci=(t,e,n={})=>{var s;const i=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((r,o)=>(r[o]=jf(o,t,e,i),r),{}):{}},jf=(t,e,n,s)=>{const i=e.find(l=>l.name===t),r=i?.type,o=n[t];return r&&!s.includes(r)?mo(r,o):bn(o)},mo=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Vf(e,n)}switch(t){case F.bool:return $f(e);case F.float4:case F.float8:case F.int2:case F.int4:case F.int8:case F.numeric:case F.oid:return Of(e);case F.json:case F.jsonb:return qf(e);case F.timestamp:return Gf(e);case F.abstime:case F.date:case F.daterange:case F.int4range:case F.int8range:case F.money:case F.reltime:case F.text:case F.time:case F.timestamptz:case F.timetz:case F.tsrange:case F.tstzrange:return bn(e);default:return bn(e)}},bn=t=>t,$f=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Of=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},qf=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Vf=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let r;const o=t.slice(1,n);try{r=JSON.parse("["+o+"]")}catch{r=o?o.split(","):[]}return r.map(l=>mo(e,l))}return t},Gf=t=>typeof t=="string"?t.replace(" ","T"):t,po=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Qt{constructor(e,n,s={},i=wn){this.channel=e,this.event=n,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ni;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ni||(Ni={}));class lt{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:r,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lt.syncState(this.state,i,r,o),this.pendingDiffs.forEach(h=>{this.state=lt.syncDiff(this.state,h,r,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},i=>{const{onJoin:r,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=lt.syncDiff(this.state,i,r,o),l())}),this.onJoin((i,r,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:r,newPresences:o})}),this.onLeave((i,r,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:r,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,i){const r=this.cloneDeep(e),o=this.transformState(n),l={},h={};return this.map(r,(d,f)=>{o[d]||(h[d]=f)}),this.map(o,(d,f)=>{const m=r[d];if(m){const p=f.map(x=>x.presence_ref),g=m.map(x=>x.presence_ref),y=f.filter(x=>g.indexOf(x.presence_ref)<0),v=m.filter(x=>p.indexOf(x.presence_ref)<0);y.length>0&&(l[d]=y),v.length>0&&(h[d]=v)}else l[d]=f}),this.syncDiff(r,{joins:l,leaves:h},s,i)}static syncDiff(e,n,s,i){const{joins:r,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(r,(l,h)=>{var d;const f=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(h),f.length>0){const m=e[l].map(g=>g.presence_ref),p=f.filter(g=>m.indexOf(g.presence_ref)<0);e[l].unshift(...p)}s(l,f,h)}),this.map(o,(l,h)=>{let d=e[l];if(!d)return;const f=h.map(m=>m.presence_ref);d=d.filter(m=>f.indexOf(m.presence_ref)<0),e[l]=d,i(l,d,h),d.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const i=e[s];return"metas"in i?n[s]=i.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):n[s]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ii;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ii||(Ii={}));var ut;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ut||(ut={}));var de;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(de||(de={}));class $n{constructor(e,n={config:{}},s){var i,r;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=J.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Qt(this,ae.join,this.params,this.timeout),this.rejoinTimer=new fo(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=J.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=J.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ae.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new lt(this),this.broadcastEndpointURL=po(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((r=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||r===void 0)&&r.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,i,r;if(this.socket.isConnected()||this.socket.connect(),this.state==J.closed){const{config:{broadcast:o,presence:l,private:h}}=this.params,d=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(g=>g.filter))!==null&&i!==void 0?i:[],f=!!this.bindings[ut.PRESENCE]&&this.bindings[ut.PRESENCE].length>0||((r=this.params.config.presence)===null||r===void 0?void 0:r.enabled)===!0,m={},p={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:f}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(g=>e?.(de.CHANNEL_ERROR,g)),this._onClose(()=>e?.(de.CLOSED)),this.updateJoinPayload(Object.assign({config:p},m)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var y;if(this.socket.setAuth(),g===void 0){e?.(de.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,x=(y=v?.length)!==null&&y!==void 0?y:0,w=[];for(let _=0;_<x;_++){const b=v[_],{filter:{event:T,schema:S,table:E,filter:N}}=b,M=g&&g[_];if(M&&M.event===T&&M.schema===S&&M.table===E&&M.filter===N)w.push(Object.assign(Object.assign({},b),{id:M.id}));else{this.unsubscribe(),this.state=J.errored,e?.(de.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(de.SUBSCRIBED);return}}).receive("error",g=>{this.state=J.errored,e?.(de.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e?.(de.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===J.joined&&e===ut.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var i;const r=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:r,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=s.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let h=l.statusText;try{const d=await l.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(e,n={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){const{event:r,payload:o}=e,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var o,l,h;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||h===void 0)&&h.ack)&&r("ok"),d.receive("ok",()=>r("ok")),d.receive("error",()=>r("error")),d.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=J.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ae.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new Qt(this,ae.leave,{},e),s.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=J.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const i=new AbortController,r=setTimeout(()=>i.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(r),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Qt(this,e,n,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Lf){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var i,r;const o=e.toLocaleLowerCase(),{close:l,error:h,leave:d,join:f}=ae;if(s&&[l,h,d,f].indexOf(o)>=0&&s!==this._joinRef())return;let p=this._onMessage(o,n,s);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(g=>{var y,v,x;return((y=g.filter)===null||y===void 0?void 0:y.event)==="*"||((x=(v=g.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(g=>g.callback(p,s)):(r=this.bindings[o])===null||r===void 0||r.filter(g=>{var y,v,x,w,_,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const T=g.id,S=(y=g.filter)===null||y===void 0?void 0:y.event;return T&&((v=n.ids)===null||v===void 0?void 0:v.includes(T))&&(S==="*"||S?.toLocaleLowerCase()===((x=n.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const T=(_=(w=g?.filter)===null||w===void 0?void 0:w.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return T==="*"||T===((b=n?.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:v,table:x,commit_timestamp:w,type:_,errors:b}=y;p=Object.assign(Object.assign({},{schema:v,table:x,commit_timestamp:w,eventType:_,new:{},old:{},errors:b}),this._getPayloadRecords(y))}g.callback(p,s)})}_isClosed(){return this.state===J.closed}_isJoined(){return this.state===J.joined}_isJoining(){return this.state===J.joining}_isLeaving(){return this.state===J.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const i=e.toLocaleLowerCase(),r={type:i,filter:n,callback:s};return this.bindings[i]?this.bindings[i].push(r):this.bindings[i]=[r],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var r;return!(((r=i.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===s&&$n.isEqual(i.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ae.close,{},e)}_onError(e){this._on(ae.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=J.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Ci(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Ci(e.columns,e.old_record)),n}}const Xt=()=>{},Tt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Bf=[1e3,2e3,5e3,1e4],Hf=1e4,Jf=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Wf{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=wn,this.transport=null,this.heartbeatIntervalMs=Tt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Xt,this.ref=0,this.reconnectTimer=null,this.logger=Xt,this.conn=null,this.sendBuffer=[],this.serializer=new Ff,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let r;return i?r=i:typeof fetch>"u"?r=(...o)=>Ze(async()=>{const{default:l}=await Promise.resolve().then(()=>Me);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):r=fetch,(...o)=>r(...o)},!(!((s=n?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${_n.websocket}`,this.httpEndpoint=po(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Pf.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Uf}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case at.connecting:return Ne.Connecting;case at.open:return Ne.Open;case at.closing:return Ne.Closing;default:return Ne.Closed}}isConnected(){return this.connectionState()===Ne.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,i=this.getChannels().find(r=>r.topic===s);if(i)return i;{const r=new $n(`realtime:${e}`,n,this);return this.channels.push(r),r}}push(e){const{topic:n,event:s,payload:i,ref:r}=e,o=()=>{this.encode(e,l=>{var h;(h=this.conn)===null||h===void 0||h.send(l)})};this.log("push",`${n} ${s} (${r})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Df,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Tt.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:i,payload:r,ref:o}=n,l=o?`(${o})`:"",h=r.status||"";this.log("receive",`${h} ${s} ${i} ${l}`.trim(),r),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(i,r,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ae.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${s}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([Jf],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const i={access_token:n,version:Mf};n&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(ae.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new fo(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Tt.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,i,r,o,l,h,d,f;if(this.transport=(n=e?.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:wn,this.heartbeatIntervalMs=(i=e?.heartbeatIntervalMs)!==null&&i!==void 0?i:Tt.HEARTBEAT_INTERVAL,this.worker=(r=e?.worker)!==null&&r!==void 0?r:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:Xt,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:m=>Bf[m-1]||Hf,this.encode=(d=e?.encode)!==null&&d!==void 0?d:(m,p)=>p(JSON.stringify(m)),this.decode=(f=e?.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class On extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function O(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Kf extends On{constructor(e,n,s){super(e),this.name="StorageApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class En extends On{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}const qn=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ze(async()=>{const{default:s}=await Promise.resolve().then(()=>Me);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},zf=()=>A(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ze(()=>Promise.resolve().then(()=>Me),void 0)).Response:Response}),Tn=t=>{if(Array.isArray(t))return t.map(n=>Tn(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const i=n.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));e[i]=Tn(s)}),e},Yf=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Zt=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Qf=(t,e,n)=>A(void 0,void 0,void 0,function*(){const s=yield zf();t instanceof s&&!n?.noResolveJson?t.json().then(i=>{const r=t.status||500,o=i?.statusCode||r+"";e(new Kf(Zt(i),r,o))}).catch(i=>{e(new En(Zt(i),i))}):e(new En(Zt(t),t))}),Xf=(t,e,n,s)=>{const i={method:t,headers:e?.headers||{}};return t==="GET"||!s?i:(Yf(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e?.headers),i.body=JSON.stringify(s)):i.body=s,e?.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),n))};function pt(t,e,n,s,i,r){return A(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,Xf(e,s,i,r)).then(h=>{if(!h.ok)throw h;return s?.noResolveJson?h:h.json()}).then(h=>o(h)).catch(h=>Qf(h,l,s))})})}function dt(t,e,n,s){return A(this,void 0,void 0,function*(){return pt(t,"GET",e,n,s)})}function oe(t,e,n,s,i){return A(this,void 0,void 0,function*(){return pt(t,"POST",e,s,i,n)})}function Sn(t,e,n,s,i){return A(this,void 0,void 0,function*(){return pt(t,"PUT",e,s,i,n)})}function Zf(t,e,n,s){return A(this,void 0,void 0,function*(){return pt(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function Vn(t,e,n,s,i){return A(this,void 0,void 0,function*(){return pt(t,"DELETE",e,s,i,n)})}class em{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return A(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(O(e))return{data:null,error:e};throw e}})}}var go;class tm{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n,this[go]="BlobDownloadBuilder",this.promise=null}asStream(){return new em(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.getPromise().then(e,n)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return A(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(O(e))return{data:null,error:e};throw e}})}}go=Symbol.toStringTag;const nm={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ai={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class sm{constructor(e,n={},s,i){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=s,this.fetch=qn(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,s,i){return A(this,void 0,void 0,function*(){try{let r;const o=Object.assign(Object.assign({},Ai),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const h=o.metadata;typeof Blob<"u"&&s instanceof Blob?(r=new FormData,r.append("cacheControl",o.cacheControl),h&&r.append("metadata",this.encodeMetadata(h)),r.append("",s)):typeof FormData<"u"&&s instanceof FormData?(r=s,r.append("cacheControl",o.cacheControl),h&&r.append("metadata",this.encodeMetadata(h))):(r=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,h&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),i?.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(n),f=this._getFinalPath(d),m=yield(e=="PUT"?Sn:oe)(this.fetch,`${this.url}/object/${f}`,r,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:m.Id,fullPath:m.Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(O(r))return{data:null,error:r};throw r}})}upload(e,n,s){return A(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,i){return A(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),o=this._getFinalPath(r),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let h;const d=Object.assign({upsert:Ai.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",s)):typeof FormData<"u"&&s instanceof FormData?(h=s,h.append("cacheControl",d.cacheControl)):(h=s,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType);const m=yield Sn(this.fetch,l.toString(),h,{headers:f});return{data:{path:r,fullPath:m.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(O(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(e,n){return A(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);n?.upsert&&(i["x-upsert"]="true");const r=yield oe(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),o=new URL(this.url+r.url),l=o.searchParams.get("token");if(!l)throw new On("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(O(s))return{data:null,error:s};throw s}})}update(e,n,s){return A(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return A(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(O(i))return{data:null,error:i};throw i}})}copy(e,n,s){return A(this,void 0,void 0,function*(){try{return{data:{path:(yield oe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(O(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,s){return A(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),r=yield oe(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s?.download?`&download=${s.download===!0?"":s.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${o}`)},{data:r,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(O(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,s){return A(this,void 0,void 0,function*(){try{const i=yield oe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),r=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${r}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(O(i))return{data:null,error:i};throw i}})}download(e,n){const i=typeof n?.transform<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString(n?.transform||{}),o=r?`?${r}`:"",l=this._getFinalPath(e),h=()=>dt(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new tm(h,this.shouldThrowOnError)}info(e){return A(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield dt(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Tn(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(O(s))return{data:null,error:s};throw s}})}exists(e){return A(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Zf(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(O(s)&&s instanceof En){const i=s.originalError;if([400,404].includes(i?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),i=[],r=n?.download?`download=${n.download===!0?"":n.download}`:"";r!==""&&i.push(r);const l=typeof n?.transform<"u"?"render/image":"object",h=this.transformOptsToQueryString(n?.transform||{});h!==""&&i.push(h);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return A(this,void 0,void 0,function*(){try{return{data:yield Vn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(O(n))return{data:null,error:n};throw n}})}list(e,n,s){return A(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},nm),n),{prefix:e||""});return{data:yield oe(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(O(i))return{data:null,error:i};throw i}})}listV2(e,n){return A(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield oe(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(O(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const yo="2.77.0",vo={"X-Client-Info":`storage-js/${yo}`};class im{constructor(e,n={},s,i){this.shouldThrowOnError=!1;const r=new URL(e);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},vo),n),this.fetch=qn(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return A(this,void 0,void 0,function*(){try{const n=this.listBucketOptionsToQueryString(e);return{data:yield dt(this.fetch,`${this.url}/bucket${n}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(O(n))return{data:null,error:n};throw n}})}getBucket(e){return A(this,void 0,void 0,function*(){try{return{data:yield dt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(O(n))return{data:null,error:n};throw n}})}createBucket(e){return A(this,arguments,void 0,function*(n,s={public:!1}){try{return{data:yield oe(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(O(i))return{data:null,error:i};throw i}})}updateBucket(e,n){return A(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(O(s))return{data:null,error:s};throw s}})}emptyBucket(e){return A(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(O(n))return{data:null,error:n};throw n}})}deleteBucket(e){return A(this,void 0,void 0,function*(){try{return{data:yield Vn(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(O(n))return{data:null,error:n};throw n}})}listBucketOptionsToQueryString(e){const n={};return e&&("limit"in e&&(n.limit=String(e.limit)),"offset"in e&&(n.offset=String(e.offset)),e.search&&(n.search=e.search),e.sortColumn&&(n.sortColumn=e.sortColumn),e.sortOrder&&(n.sortOrder=e.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}}class rm{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},vo),n),this.fetch=qn(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return A(this,void 0,void 0,function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(O(n))return{data:null,error:n};throw n}})}listBuckets(e){return A(this,void 0,void 0,function*(){try{const n=new URLSearchParams;e?.limit!==void 0&&n.set("limit",e.limit.toString()),e?.offset!==void 0&&n.set("offset",e.offset.toString()),e?.sortColumn&&n.set("sortColumn",e.sortColumn),e?.sortOrder&&n.set("sortOrder",e.sortOrder),e?.search&&n.set("search",e.search);const s=n.toString(),i=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield dt(this.fetch,i,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(O(n))return{data:null,error:n};throw n}})}deleteBucket(e){return A(this,void 0,void 0,function*(){try{return{data:yield Vn(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(O(n))return{data:null,error:n};throw n}})}}const Gn={"X-Client-Info":`storage-js/${yo}`,"Content-Type":"application/json"};class xo extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Z(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class en extends xo{constructor(e,n,s){super(e),this.name="StorageVectorsApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class om extends xo{constructor(e,n){super(e),this.name="StorageVectorsUnknownError",this.originalError=n}}var Ri;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Ri||(Ri={}));const Bn=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ze(async()=>{const{default:s}=await Promise.resolve().then(()=>Me);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},am=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Pi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),lm=(t,e,n)=>A(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!n?.noResolveJson){const i=t.status||500,r=t;if(typeof r.json=="function")r.json().then(o=>{const l=o?.statusCode||o?.code||i+"";e(new en(Pi(o),i,l))}).catch(()=>{const o=i+"",l=r.statusText||`HTTP ${i} error`;e(new en(l,i,o))});else{const o=i+"",l=r.statusText||`HTTP ${i} error`;e(new en(l,i,o))}}else e(new om(Pi(t),t))}),um=(t,e,n,s)=>{const i={method:t,headers:e?.headers||{}};return s?(am(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e?.headers),i.body=JSON.stringify(s)):i.body=s,Object.assign(Object.assign({},i),n)):i};function cm(t,e,n,s,i,r){return A(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,um(e,s,i,r)).then(h=>{if(!h.ok)throw h;if(s?.noResolveJson)return h;const d=h.headers.get("content-type");return!d||!d.includes("application/json")?{}:h.json()}).then(h=>o(h)).catch(h=>lm(h,l,s))})})}function ee(t,e,n,s,i){return A(this,void 0,void 0,function*(){return cm(t,"POST",e,s,i,n)})}class dm{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gn),n),this.fetch=Bn(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return A(this,void 0,void 0,function*(){try{return{data:(yield ee(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}getIndex(e,n){return A(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Z(s))return{data:null,error:s};throw s}})}listIndexes(e){return A(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}deleteIndex(e,n){return A(this,void 0,void 0,function*(){try{return{data:(yield ee(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:n},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Z(s))return{data:null,error:s};throw s}})}}class hm{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gn),n),this.fetch=Bn(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return A(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ee(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}getVectors(e){return A(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}listVectors(e){return A(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield ee(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}queryVectors(e){return A(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}deleteVectors(e){return A(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ee(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}}class fm{constructor(e,n={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gn),n),this.fetch=Bn(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return A(this,void 0,void 0,function*(){try{return{data:(yield ee(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}getBucket(e){return A(this,void 0,void 0,function*(){try{return{data:yield ee(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}listBuckets(){return A(this,arguments,void 0,function*(e={}){try{return{data:yield ee(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}deleteBucket(e){return A(this,void 0,void 0,function*(){try{return{data:(yield ee(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}}class mm extends fm{constructor(e,n={}){super(e,n.headers||{},n.fetch)}from(e){return new pm(this.url,this.headers,e,this.fetch)}}class pm extends dm{constructor(e,n,s,i){super(e,n,i),this.vectorBucketName=s}createIndex(e){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return A(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return A(this,arguments,void 0,function*(n={}){return e.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return A(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return A(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new gm(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class gm extends hm{constructor(e,n,s,i,r){super(e,n,r),this.vectorBucketName=s,this.indexName=i}putVectors(e){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return A(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return A(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return A(this,arguments,void 0,function*(n={}){return e.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return A(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return A(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class ym extends im{constructor(e,n={},s,i){super(e,n,s,i)}from(e){return new sm(this.url,this.headers,e,this.fetch)}get vectors(){return new mm(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new rm(this.url+"/iceberg",this.headers,this.fetch)}}const vm="2.77.0";let rt="";typeof Deno<"u"?rt="deno":typeof document<"u"?rt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?rt="react-native":rt="node";const xm={"X-Client-Info":`supabase-js-${rt}/${vm}`},wm={headers:xm},_m={schema:"public"},bm={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Em={},Tm=t=>{let e;return t?e=t:typeof fetch>"u"?e=Wr:e=fetch,(...n)=>e(...n)},Sm=()=>typeof Headers>"u"?Kr:Headers,Cm=(t,e,n)=>{const s=Tm(n),i=Sm();return async(r,o)=>{var l;const h=(l=await e())!==null&&l!==void 0?l:t;let d=new i(o?.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),s(r,Object.assign(Object.assign({},o),{headers:d}))}};function Nm(t){return t.endsWith("/")?t:t+"/"}function Im(t,e){var n,s;const{db:i,auth:r,realtime:o,global:l}=t,{db:h,auth:d,realtime:f,global:m}=e,p={db:Object.assign(Object.assign({},h),i),auth:Object.assign(Object.assign({},d),r),realtime:Object.assign(Object.assign({},f),o),storage:{},global:Object.assign(Object.assign(Object.assign({},m),l),{headers:Object.assign(Object.assign({},(n=m?.headers)!==null&&n!==void 0?n:{}),(s=l?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}function Am(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Nm(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const wo="2.77.0",Oe=30*1e3,Cn=3,tn=Cn*Oe,Rm="http://localhost:9999",Pm="supabase.auth.token",km={"X-Client-Info":`gotrue-js/${wo}`},Nn="X-Supabase-Api-Version",_o={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Mm=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Um=10*60*1e3;class ht extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function P(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Dm extends ht{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function Lm(t){return P(t)&&t.name==="AuthApiError"}class Ie extends ht{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class _e extends ht{constructor(e,n,s,i){super(e,s,i),this.name=n,this.status=s}}class ge extends _e{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Fm(t){return P(t)&&t.name==="AuthSessionMissingError"}class De extends _e{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class St extends _e{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ct extends _e{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function jm(t){return P(t)&&t.name==="AuthImplicitGrantRedirectError"}class ki extends _e{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class In extends _e{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function nn(t){return P(t)&&t.name==="AuthRetryableFetchError"}class Mi extends _e{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class An extends _e{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ft="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ui=` 	
\r=`.split(""),$m=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Ui.length;e+=1)t[Ui[e].charCodeAt(0)]=-2;for(let e=0;e<Ft.length;e+=1)t[Ft[e].charCodeAt(0)]=e;return t})();function Di(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ft[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ft[s]),e.queuedBits-=6}}function bo(t,e,n){const s=$m[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Li(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},r=o=>{Vm(o,s,n)};for(let o=0;o<t.length;o+=1)bo(t.charCodeAt(o),i,r);return e.join("")}function Om(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function qm(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}Om(s,e)}}function Vm(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Je(t){const e=[],n={queue:0,queuedBits:0},s=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)bo(t.charCodeAt(i),n,s);return new Uint8Array(e)}function Gm(t){const e=[];return qm(t,n=>e.push(n)),new Uint8Array(e)}function Ae(t){const e=[],n={queue:0,queuedBits:0},s=i=>{e.push(i)};return t.forEach(i=>Di(i,n,s)),Di(null,n,s),e.join("")}function Bm(t){return Math.round(Date.now()/1e3)+t}function Hm(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const X=()=>typeof window<"u"&&typeof document<"u",Te={tested:!1,writable:!1},Eo=()=>{if(!X())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Te.tested)return Te.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Te.tested=!0,Te.writable=!0}catch{Te.tested=!0,Te.writable=!1}return Te.writable};function Jm(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,r)=>{e[r]=i})}catch{}return n.searchParams.forEach((s,i)=>{e[i]=s}),e}const To=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ze(async()=>{const{default:s}=await Promise.resolve().then(()=>Me);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},Wm=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",qe=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Se=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},pe=async(t,e)=>{await t.removeItem(e)};class Wt{constructor(){this.promise=new Wt.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Wt.promiseConstructor=Promise;function sn(t){const e=t.split(".");if(e.length!==3)throw new An("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Mm.test(e[s]))throw new An("JWT not in base64url format");return{header:JSON.parse(Li(e[0])),payload:JSON.parse(Li(e[1])),signature:Je(e[2]),raw:{header:e[0],payload:e[1]}}}async function Km(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function zm(t,e){return new Promise((s,i)=>{(async()=>{for(let r=0;r<1/0;r++)try{const o=await t(r);if(!e(r,null,o)){s(o);return}}catch(o){if(!e(r,o)){i(o);return}}})()})}function Ym(t){return("0"+t.toString(16)).substr(-2)}function Qm(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let i="";for(let r=0;r<56;r++)i+=n.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,Ym).join("")}async function Xm(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(s);return Array.from(i).map(r=>String.fromCharCode(r)).join("")}async function Zm(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return t;const n=await Xm(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Le(t,e,n=!1){const s=Qm();let i=s;n&&(i+="/PASSWORD_RECOVERY"),await qe(t,`${e}-code-verifier`,i);const r=await Zm(s);return[r,s===r?"plain":"s256"]}const ep=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function tp(t){const e=t.headers.get(Nn);if(!e||!e.match(ep))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function np(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function sp(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ip=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Fe(t){if(!ip.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function rn(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Fi(t){return JSON.parse(JSON.stringify(t))}const Ce=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),rp=[502,503,504];async function ji(t){var e;if(!Wm(t))throw new In(Ce(t),0);if(rp.includes(t.status))throw new In(Ce(t),t.status);let n;try{n=await t.json()}catch(r){throw new Ie(Ce(r),r)}let s;const i=tp(t);if(i&&i.getTime()>=_o["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new Mi(Ce(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new ge}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((r,o)=>r&&typeof o=="string",!0))throw new Mi(Ce(n),t.status,n.weak_password.reasons);throw new Dm(Ce(n),t.status||500,s)}const op=(t,e,n,s)=>{const i={method:t,headers:e?.headers||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),n))};async function k(t,e,n,s){var i;const r=Object.assign({},s?.headers);r[Nn]||(r[Nn]=_o["2024-01-01"].name),s?.jwt&&(r.Authorization=`Bearer ${s.jwt}`);const o=(i=s?.query)!==null&&i!==void 0?i:{};s?.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",h=await ap(t,e,n+l,{headers:r,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(h):{data:Object.assign({},h),error:null}}async function ap(t,e,n,s,i,r){const o=op(e,s,i,r);let l;try{l=await t(n,Object.assign({},o))}catch(h){throw new In(Ce(h),0)}if(l.ok||await ji(l),s?.noResolveJson)return l;try{return await l.json()}catch(h){await ji(h)}}function re(t){var e;let n=null;cp(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=Bm(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function $i(t){const e=re(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ye(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function lp(t){return{data:t,error:null}}function up(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:i,verification_type:r}=t,o=Xe(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:s,redirect_to:i,verification_type:r},h=Object.assign({},o);return{data:{properties:l,user:h},error:null}}function Oi(t){return t}function cp(t){return t.access_token&&t.refresh_token&&t.expires_in}const on=["global","local","others"];class dp{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=To(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=on[0]){if(on.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${on.join(", ")}`);try{return await k(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(P(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await k(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ye})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=Xe(e,["options"]),i=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(i.new_email=s?.newEmail,delete i.newEmail),await k(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:up,redirectTo:n?.redirectTo})}catch(n){if(P(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await k(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ye})}catch(n){if(P(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,i,r,o,l,h;try{const d={nextPage:null,lastPage:0,total:0},f=await k(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(r=(i=e?.perPage)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:""},xform:Oi});if(f.error)throw f.error;const m=await f.json(),p=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(h=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&h!==void 0?h:[];return g.length>0&&(g.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(y.split(";")[1].split("=")[1]);d[`${x}Page`]=v}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(P(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Fe(e);try{return await k(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ye})}catch(n){if(P(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Fe(e);try{return await k(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:ye})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){Fe(e);try{return await k(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:ye})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Fe(e.userId);try{const{data:n,error:s}=await k(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:s}}catch(n){if(P(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Fe(e.userId),Fe(e.id);try{return{data:await k(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(P(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,i,r,o,l,h;try{const d={nextPage:null,lastPage:0,total:0},f=await k(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(r=(i=e?.perPage)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:""},xform:Oi});if(f.error)throw f.error;const m=await f.json(),p=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(h=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&h!==void 0?h:[];return g.length>0&&(g.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(y.split(";")[1].split("=")[1]);d[`${x}Page`]=v}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(P(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await k(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(P(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await k(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(P(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await k(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(P(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await k(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(P(n))return{data:null,error:n};throw n}}}function qi(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const je={debug:!!(globalThis&&Eo()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class So extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class hp extends So{}async function fp(t,e,n){je.debug;const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),je.debug},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){je.debug;try{return await n()}finally{je.debug}}else{if(e===0)throw je.debug,new hp(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(je.debug)try{const r=await globalThis.navigator.locks.query()}catch{}return await n()}}))}function mp(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Co(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function pp(t){return parseInt(t,16)}function gp(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function yp(t){var e;const{chainId:n,domain:s,expirationTime:i,issuedAt:r=new Date,nonce:o,notBefore:l,requestId:h,resources:d,scheme:f,uri:m,version:p}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=Co(t.address),y=f?`${f}://${s}`:s,v=t.statement?`${t.statement}
`:"",x=`${y} wants you to sign in with your Ethereum account:
${g}

${v}`;let w=`URI: ${m}
Version: ${p}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${r.toISOString()}`;if(i&&(w+=`
Expiration Time: ${i.toISOString()}`),l&&(w+=`
Not Before: ${l.toISOString()}`),h&&(w+=`
Request ID: ${h}`),d){let _=`
Resources:`;for(const b of d){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);_+=`
- ${b}`}w+=_}return`${x}
${w}`}class H extends Error{constructor({message:e,code:n,cause:s,name:i}){var r;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(r=i??(s instanceof Error?s.name:void 0))!==null&&r!==void 0?r:"Unknown Error",this.code=n}}class jt extends H{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function vp({error:t,options:e}){var n,s,i;const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new H({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=r.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new H({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=r.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new H({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((i=r.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new H({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new H({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new H({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return r.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new H({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new H({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(No(o)){if(r.rp.id!==o)return new H({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new H({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new H({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new H({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new H({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function xp({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new H({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new H({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(No(s)){if(n.rpId!==s)return new H({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new H({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new H({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new H({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class wp{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const _p=new wp;function bp(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,i=Xe(t,["challenge","user","excludeCredentials"]),r=Je(e).buffer,o=Object.assign(Object.assign({},n),{id:Je(n.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:r,user:o});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let h=0;h<s.length;h++){const d=s[h];l.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:Je(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function Ep(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=Xe(t,["challenge","allowCredentials"]),i=Je(e).buffer,r=Object.assign(Object.assign({},s),{challenge:i});if(n&&n.length>0){r.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const l=n[o];r.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Je(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return r}function Tp(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Ae(new Uint8Array(t.response.attestationObject)),clientDataJSON:Ae(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Sp(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),i=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Ae(new Uint8Array(i.authenticatorData)),clientDataJSON:Ae(new Uint8Array(i.clientDataJSON)),signature:Ae(new Uint8Array(i.signature)),userHandle:i.userHandle?Ae(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function No(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Vi(){var t,e;return!!(X()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Cp(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new jt("Browser returned unexpected credential type",e)}:{data:null,error:new jt("Empty credential response",e)}}catch(e){return{data:null,error:vp({error:e,options:t})}}}async function Np(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new jt("Browser returned unexpected credential type",e)}:{data:null,error:new jt("Empty credential response",e)}}catch(e){return{data:null,error:xp({error:e,options:t})}}}const Ip={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Ap={userVerification:"preferred",hints:["security-key"]};function $t(...t){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),n=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),s={};for(const i of t)if(i)for(const r in i){const o=i[r];if(o!==void 0)if(Array.isArray(o))s[r]=o;else if(n(o))s[r]=o;else if(e(o)){const l=s[r];e(l)?s[r]=$t(l,o):s[r]=$t(o)}else s[r]=o}return s}function Rp(t,e){return $t(Ip,t,e||{})}function Pp(t,e){return $t(Ap,t,e||{})}class kp{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:i},r){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!o)return{data:null,error:l};const h=i??_p.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${s}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=Rp(o.webauthn.credential_options.publicKey,r?.create),{data:f,error:m}=await Cp({publicKey:d,signal:h});return f?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:m}}case"request":{const d=Pp(o.webauthn.credential_options.publicKey,r?.request),{data:f,error:m}=await Np(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:h}));return f?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:m}}}}catch(o){return P(o)?{data:null,error:o}:{data:null,error:new Ie("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}},r){if(!n)return{data:null,error:new ht("rpId is required for WebAuthn authentication")};try{if(!Vi())return{data:null,error:new Ie("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:i},{request:r});if(!o)return{data:null,error:l};const{webauthn:h}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:h.type,rpId:n,rpOrigins:s,credential_response:h.credential_response}})}catch(o){return P(o)?{data:null,error:o}:{data:null,error:new Ie("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i},r){if(!n)return{data:null,error:new ht("rpId is required for WebAuthn registration")};try{if(!Vi())return{data:null,error:new Ie("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(f=>{var m;return(m=f.data)===null||m===void 0?void 0:m.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===e&&p.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f?.id}):void 0),{data:null,error:l};const{data:h,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:i},{create:r});return h?this._verify({factorId:o.id,challengeId:h.challengeId,webauthn:{rpId:n,rpOrigins:s,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(o){return P(o)?{data:null,error:o}:{data:null,error:new Ie("Unexpected error in register",o)}}}}mp();const Mp={url:Rm,storageKey:Pm,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:km,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Gi(t,e,n){return await n()}const $e={};class ft{get jwks(){var e,n;return(n=(e=$e[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){$e[this.storageKey]=Object.assign(Object.assign({},$e[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=$e[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){$e[this.storageKey]=Object.assign(Object.assign({},$e[this.storageKey]),{cachedAt:e})}constructor(e){var n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ft.nextInstanceID,ft.nextInstanceID+=1,this.instanceID>0&&X();const i=Object.assign(Object.assign({},Mp),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new dp({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=To(i.fetch),this.lock=i.lock||Gi,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:X()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=fp:this.lock=Gi,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new kp(this)},this.persistSession?(i.storage?this.storage=i.storage:Eo()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=qi(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=qi(this.memoryStorage)),X()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch{}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wo}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=Jm(window.location.href);let s="none";if(this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce"),X()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:r}=await this._getSessionFromURL(n,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),jm(r)){const h=(e=r.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:r}}return await this._removeSession(),{error:r}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return P(n)?{error:n}:{error:new Ie("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,i;try{const r=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e?.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e?.options)===null||i===void 0?void 0:i.captchaToken}},xform:re}),{data:o,error:l}=r;if(l||!o)return{data:{user:null,session:null},error:l};const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:d,session:h},error:null}}catch(r){if(P(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var n,s,i;try{let r;if("email"in e){const{email:f,password:m,options:p}=e;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await Le(this.storage,this.storageKey)),r=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p?.emailRedirectTo,body:{email:f,password:m,data:(n=p?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:g,code_challenge_method:y},xform:re})}else if("phone"in e){const{phone:f,password:m,options:p}=e;r=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:m,data:(s=p?.data)!==null&&s!==void 0?s:{},channel:(i=p?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:re})}else throw new St("You must provide either an email or phone number and a password");const{data:o,error:l}=r;if(l||!o)return{data:{user:null,session:null},error:l};const h=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:d,session:h},error:null}}catch(r){if(P(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let n;if("email"in e){const{email:r,password:o,options:l}=e;n=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:$i})}else if("phone"in e){const{phone:r,password:o,options:l}=e;n=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:$i})}else throw new St("You must provide either an email or phone number and a password");const{data:s,error:i}=n;return i?{data:{user:null,session:null},error:i}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new De}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(n){if(P(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,s,i,r;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,i,r,o,l,h,d,f,m,p;let g,y;if("message"in e)g=e.message,y=e.signature;else{const{chain:v,wallet:x,statement:w,options:_}=e;let b;if(X())if(typeof x=="object")b=x;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")b=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=x}const T=new URL((n=_?.url)!==null&&n!==void 0?n:window.location.href),S=await b.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=Co(S[0]);let N=(s=_?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!N){const R=await b.request({method:"eth_chainId"});N=pp(R)}const M={domain:T.host,address:E,statement:w,uri:T.href,version:"1",chainId:N,nonce:(i=_?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(r=_?.signInWithEthereum)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=_?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(h=_?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=_?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(f=_?.signInWithEthereum)===null||f===void 0?void 0:f.resources};g=yp(M),y=await b.request({method:"personal_sign",params:[gp(g),E]})}try{const{data:v,error:x}=await k(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:y},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:re});if(x)throw x;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new De}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:x})}catch(v){if(P(v))return{data:{user:null,session:null},error:v};throw v}}async signInWithSolana(e){var n,s,i,r,o,l,h,d,f,m,p,g;let y,v;if("message"in e)y=e.message,v=e.signature;else{const{chain:x,wallet:w,statement:_,options:b}=e;let T;if(X())if(typeof w=="object")T=w;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))T=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=w}const S=new URL((n=b?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in T&&T.signIn){const E=await T.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b?.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),_?{statement:_}:null));let N;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")N=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)N=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)y=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),v=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in T)||typeof T.signMessage!="function"||!("publicKey"in T)||typeof T!="object"||!T.publicKey||!("toBase58"in T.publicKey)||typeof T.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${S.host} wants you to sign in with your Solana account:`,T.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(i=(s=b?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((r=b?.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((h=b?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((d=b?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((m=(f=b?.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||m===void 0)&&m.length?["Resources",...b.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const E=await T.signMessage(new TextEncoder().encode(y),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=E}}try{const{data:x,error:w}=await k(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Ae(v)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:re});if(w)throw w;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new De}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:w})}catch(x){if(P(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(e){const n=await Se(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(n??"").split("/");try{const{data:r,error:o}=await k(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:re});if(await pe(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!r||!r.session||!r.user?{data:{user:null,session:null,redirectType:null},error:new De}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign(Object.assign({},r),{redirectType:i??null}),error:o})}catch(r){if(P(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:n,provider:s,token:i,access_token:r,nonce:o}=e,l=await k(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:r,nonce:o,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:re}),{data:h,error:d}=l;return d?{data:{user:null,session:null},error:d}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new De}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:d})}catch(n){if(P(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,s,i,r,o;try{if("email"in e){const{email:l,options:h}=e;let d=null,f=null;this.flowType==="pkce"&&([d,f]=await Le(this.storage,this.storageKey));const{error:m}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=h?.data)!==null&&n!==void 0?n:{},create_user:(s=h?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:f},redirectTo:h?.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in e){const{phone:l,options:h}=e,{data:d,error:f}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=h?.data)!==null&&i!==void 0?i:{},create_user:(r=h?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(o=h?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:f}}throw new St("You must provide either an email or phone number.")}catch(l){if(P(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,s;try{let i,r;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,r=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await k(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:i,xform:re});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const h=o.session,d=o.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:d,session:h},error:null}}catch(i){if(P(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,s,i;try{let r=null,o=null;return this.flowType==="pkce"&&([r,o]=await Le(this.storage,this.storageKey)),await k(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:o}),headers:this.headers,xform:lp})}catch(r){if(P(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new ge;const{error:i}=await k(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(P(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:r}=e,{error:o}=await k(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},redirectTo:r?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:i,options:r}=e,{data:o,error:l}=await k(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:r?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:l}}throw new St("You must provide either an email or phone number and a type")}catch(n){if(P(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Se(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<tn:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Se(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=rn()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(h,d,f)=>(!o&&d==="user"&&(o=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,d,f))})}return{data:{session:e},error:null}}const{data:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ye}):await this._useSession(async n=>{var s,i,r;const{data:o,error:l}=n;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ge}:await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0,xform:ye})})}catch(n){if(P(n))return Fm(n)&&(await this._removeSession(),await pe(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:i,error:r}=s;if(r)throw r;if(!i.session)throw new ge;const o=i.session;let l=null,h=null;this.flowType==="pkce"&&e.email!=null&&([l,h]=await Le(this.storage,this.storageKey));const{data:d,error:f}=await k(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:h}),jwt:o.access_token,xform:ye});if(f)throw f;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ge;const n=Date.now()/1e3;let s=n,i=!0,r=null;const{payload:o}=sn(e.access_token);if(o.exp&&(s=o.exp,i=s<=n),i){const{data:l,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!l)return{data:{user:null,session:null},error:null};r=l}else{const{data:l,error:h}=await this._getUser(e.access_token);if(h)throw h;r={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(n){if(P(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new ge;const{data:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(P(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!X())throw new Ct("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ct(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new ki("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ct("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ki("No code detected.");const{data:_,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const T=new URL(window.location.href);return T.searchParams.delete("code"),window.history.replaceState(window.history.state,"",T.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:r,refresh_token:o,expires_in:l,expires_at:h,token_type:d}=e;if(!r||!l||!o||!d)throw new Ct("No session defined in URL");const f=Math.round(Date.now()/1e3),m=parseInt(l);let p=f+m;h&&(p=parseInt(h)),(p-f)*1e3<=Oe;const y=p-m;f-y>=120||f-y<0;const{data:v,error:x}=await this._getUser(r);if(x)throw x;const w={provider_token:s,provider_refresh_token:i,access_token:r,expires_in:m,expires_at:p,refresh_token:o,token_type:d,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(s){if(P(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Se(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:i,error:r}=n;if(r)return{error:r};const o=(s=i.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Lm(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await pe(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=Hm(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,i;try{const{data:{session:r},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r)}})}async resetPasswordForEmail(e,n={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await Le(this.storage,this.storageKey,!0));try{return await k(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(r){if(P(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(P(n))return{data:null,error:n};throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:i}=await this._useSession(async r=>{var o,l,h,d,f;const{data:m,error:p}=r;if(p)throw p;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await k(this.fetch,"GET",g,{headers:this.headers,jwt:(f=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return X()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(P(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:i,data:{session:r}}=n;if(i)throw i;const{options:o,provider:l,token:h,access_token:d,nonce:f}=e,m=await k(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=r?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:h,access_token:d,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:re}),{data:p,error:g}=m;return g?{data:{user:null,session:null},error:g}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new De}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),{data:p,error:g})}catch(i){if(P(i))return{data:{user:null,session:null},error:i};throw i}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,i;const{data:r,error:o}=n;if(o)throw o;return await k(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(P(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await zm(async i=>(i>0&&await Km(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await k(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:re})),(i,r)=>{const o=200*Math.pow(2,i);return r&&nn(r)&&Date.now()+o-s<Oe})}catch(s){if(this._debug(n,"error",s),P(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),X()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await Se(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Se(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await qe(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o?.user)!==null&&e!==void 0?e:rn()}else if(i&&!i.user&&!i.user){const o=await Se(this.storage,this.storageKey+"-user");o&&o?.user?(i.user=o.user,await pe(this.storage,this.storageKey+"-user"),await qe(this.storage,this.storageKey,i)):i.user=rn()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const r=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<tn;if(this._debug(s,`session has${r?"":" not"} expired with margin of ${tn}s`),r){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(nn(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&o?.user?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new ge;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Wt;const{data:r,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!r.session)throw new ge;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const l={data:r.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(r){if(this._debug(i,"error",r),P(r)){const o={data:null,error:r};return nn(r)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const r=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(h){r.push(h)}});if(await Promise.all(o),r.length>0){for(let l=0;l<r.length;l+=1);throw r[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await qe(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const r=Fi(i);await qe(this.storage,this.storageKey,r)}else{const i=Fi(n);await qe(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await pe(this.storage,this.storageKey),await pe(this.storage,this.storageKey+"-code-verifier"),await pe(this.storage,this.storageKey+"-user"),this.userStorage&&await pe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&X()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch{}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Oe);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/Oe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Oe}ms, refresh threshold is ${Cn} ticks`),i<=Cn&&await this._callRefreshToken(s.refresh_token)})}catch{}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof So)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!X()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch{}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const i=[`provider=${encodeURIComponent(n)}`];if(s?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[r,o]=await Le(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(s?.queryParams){const r=new URLSearchParams(s.queryParams);i.push(r.toString())}return s?.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:i,error:r}=n;return r?{data:null,error:r}:await k(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(P(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,i;const{data:r,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:d}=await k(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&h.type==="totp"&&(!((i=h?.totp)===null||i===void 0)&&i.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(n){if(P(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:i,error:r}=n;if(r)return{data:null,error:r};const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Tp(e.webauthn.credential_response):Sp(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:h}=await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:h})})}catch(n){if(P(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:i,error:r}=n;if(r)return{data:null,error:r};const o=await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:bp(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Ep(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(P(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const i={all:[],phone:[],totp:[],webauthn:[]};for(const r of(e=n?.factors)!==null&&e!==void 0?e:[])i.all.push(r),r.status==="verified"&&i[r.factor_type].push(r);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,s;const{data:{session:i},error:r}=e;if(r)return{data:null,error:r};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=sn(i.access_token);let l=null;o.aal&&(l=o.aal);let h=l;((s=(n=i.user.factors)===null||n===void 0?void 0:n.filter(m=>m.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(h="aal2");const f=o.amr||[];return{data:{currentLevel:l,nextLevel:h,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(l=>l.kid===e);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+Um>i)return s;const{data:r,error:o}=await k(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=i,s=r.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:g,error:y}=await this.getSession();if(y||!g.session)return{data:null,error:y};s=g.session.access_token}const{header:i,payload:r,signature:o,raw:{header:l,payload:h}}=sn(s);n?.allowExpired||np(r.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!d){const{error:g}=await this.getUser(s);if(g)throw g;return{data:{claims:r,header:i,signature:o},error:null}}const f=sp(i.alg),m=await crypto.subtle.importKey("jwk",d,f,!0,["verify"]);if(!await crypto.subtle.verify(f,m,o,Gm(`${l}.${h}`)))throw new An("Invalid JWT signature");return{data:{claims:r,header:i,signature:o},error:null}}catch(s){if(P(s))return{data:null,error:s};throw s}}}ft.nextInstanceID=0;const Up=ft;class Dp extends Up{constructor(e){super(e)}}class Lp{constructor(e,n,s){var i,r,o;this.supabaseUrl=e,this.supabaseKey=n;const l=Am(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const h=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:_m,realtime:Em,auth:Object.assign(Object.assign({},bm),{storageKey:h}),global:wm},f=Im(s??{},d);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(r=f.global.headers)!==null&&r!==void 0?r:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(m,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=f.auth)!==null&&o!==void 0?o:{},this.headers,f.global.fetch),this.fetch=Cm(n,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new Rf(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new ym(this.storageUrl.href,this.headers,this.fetch,s?.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new bf(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,n;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:i,userStorage:r,storageKey:o,flowType:l,lock:h,debug:d},f,m){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Dp({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),f),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:i,userStorage:r,flowType:l,lock:h,debug:d,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Wf(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s?.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Fp=(t,e,n)=>new Lp(t,e,n);function jp(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}jp();const $p="https://vuhbxceybywwnwzfsvpg.supabase.co",Op="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ1aGJ4Y2V5Ynl3d253emZzdnBnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1OTYyNjQsImV4cCI6MjA3NzE3MjI2NH0.dvhx9PtbMv0yBu8OVj36wi5KkQeHzt3wFpEAiyhGIG0",B=Fp($p,Op),Ot=t=>t?{id:t.id,name:t.user_metadata?.full_name||t.email,email:t.email}:null,ct={async signUp(t,e,n,s,i,r,o,l){const{data:h,error:d}=await B.auth.signUp({email:e,password:n,options:{data:{full_name:t}}});if(d)throw d;if(!h.user)throw new Error("Signup successful, but no user data returned.");let f=`https://picsum.photos/seed/${t.toLowerCase().replace(/\s/g,"")}/400/400`;if(l){const p=`${h.user.id}/${Date.now()}_${l.name}`,{error:g}=await B.storage.from("profile-photos").upload(p,l,{cacheControl:"3600",upsert:!0});if(!g){const{data:y}=B.storage.from("profile-photos").getPublicUrl(p);y.publicUrl&&(f=y.publicUrl)}}const{error:m}=await B.from("profiles").upsert({id:h.user.id,name:t.split(" ")[0]||t,email:h.user.email,universityId:s,contactNumber:i,studentNumber:r,imageUrl:f,dateOfBirth:o},{onConflict:"id"});if(m)throw m;return Ot(h.user)},async login(t,e){const{data:n,error:s}=await B.auth.signInWithPassword({email:t,password:e});if(s)throw s;if(!n.user)throw new Error("Login successful, but no user data returned.");return Ot(n.user)},async socialLoginRedirect(t){const{error:e}=await B.auth.signInWithOAuth({provider:t,options:{redirectTo:window.location.origin}});if(e)throw e},async updateProfilePhoto(t,e){if(!e)throw new Error("No photo provided.");if(e.size>2*1024*1024)throw new Error("Image file is too large. Please use a file under 2MB.");const n=`${t}/${Date.now()}_${e.name}`,{error:s}=await B.storage.from("profile-photos").upload(n,e,{upsert:!0});if(s)throw new Error("Failed to upload new photo.");const{data:i}=B.storage.from("profile-photos").getPublicUrl(n);if(!i.publicUrl)throw new Error("Failed to get public URL for the new photo.");const r=i.publicUrl,{error:o}=await B.from("profiles").update({imageUrl:r}).eq("id",t);if(o)throw new Error("Failed to update profile with new photo.");return r},async logout(){const{error:t}=await B.auth.signOut();if(t)throw t}},Io=C.createContext(void 0),qp=({children:t})=>{const[e,n]=C.useState([]),s=C.useCallback(r=>{n(o=>o.filter(l=>l.id!==r))},[]),i=C.useCallback(({message:r,type:o,duration:l=5e3})=>{const h=Date.now();let d="An unknown error occurred.";typeof r=="string"?d=r:typeof r=="object"&&r!==null&&r.message?d=r.message:typeof r=="object"&&r!==null&&(d=JSON.stringify(r)),n(f=>[...f,{id:h,message:d,type:o,duration:l}]),setTimeout(()=>{s(h)},l)},[s]);return c.jsx(Io.Provider,{value:{notifications:e,notify:i,removeNotification:s},children:t})},Kt=()=>{const t=C.useContext(Io);if(t===void 0)throw new Error("useNotifier must be used within a NotificationProvider");return t},Vp=({provider:t,icon:e,onClick:n,disabled:s,isLoading:i})=>c.jsx("button",{type:"button",onClick:n,disabled:s,className:"w-full flex items-center justify-center gap-3 py-3 px-4 border border-gray-300 rounded-full shadow-sm text-md font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-unistay-yellow transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:i?c.jsx(Q,{color:"navy",size:"md"}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:`fab ${e} text-xl`}),c.jsxs("span",{children:["Continue with ",t]})]})}),Gp=({onAuthSuccess:t,onNavigateHome:e})=>{const[n,s]=C.useState(!0),[i,r]=C.useState({name:"",email:"",password:"",confirmPassword:"",dateOfBirth:"",contactNumber:"",universityId:ue[0]?.id||"other",studentNumber:""}),[o,l]=C.useState(null),[h,d]=C.useState(null),[f,m]=C.useState(null),[p,g]=C.useState({password:!1,confirmPassword:!1}),{notify:y}=Kt(),v=S=>{r({...i,[S.target.name]:S.target.value})},x=S=>{if(S.target.files&&S.target.files[0]){const E=S.target.files[0];if(E.size>2*1024*1024){y({message:"Image file is too large. Please use a file under 2MB.",type:"error"});return}l(E),d(URL.createObjectURL(E))}},w=async S=>{if(S.preventDefault(),m("email"),n){if(!i.email||!i.password){y({message:"Please enter both email and password.",type:"error"}),m(null);return}}else{if(i.password!==i.confirmPassword){y({message:"Passwords do not match.",type:"error"}),m(null);return}const E=["name","email","password","contactNumber","universityId","studentNumber","dateOfBirth"];for(const N of E)if(!i[N]){y({message:`Please fill out all fields. ${N.replace(/([A-Z])/g," $1")} is missing.`,type:"error"}),m(null);return}}try{n?await ct.login(i.email,i.password):await ct.signUp(i.name,i.email,i.password,i.universityId,i.contactNumber,i.studentNumber,i.dateOfBirth,o),t()}catch(E){y({message:E,type:"error"})}finally{m(null)}},_=async S=>{m(S);try{await ct.socialLoginRedirect(S)}catch(E){y({message:E,type:"error"}),m(null)}},b=S=>{g(E=>({...E,[S]:!E[S]}))},T=f!==null;return c.jsx("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4",children:c.jsxs("div",{className:"max-w-md w-full",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("a",{href:"/",onClick:S=>{S.preventDefault(),e()},className:"inline-block hover:opacity-90 transition-opacity","aria-label":"Go to homepage",children:c.jsx("img",{src:"/images/hostels/unistay.png",alt:"UniStay Logo",className:"h-12 w-auto rounded-lg shadow-sm"})}),c.jsx("p",{className:"text-gray-600 mt-2",children:"Your partner in finding the perfect student accommodation."})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[c.jsx("h2",{className:"text-3xl font-bold text-center text-unistay-navy mb-6",children:n?"Welcome Back!":"Create Your Account"}),c.jsx("div",{className:"space-y-4",children:c.jsx(Vp,{provider:"Google",icon:"fa-google",onClick:()=>_("google"),disabled:T,isLoading:f==="google"})}),c.jsxs("div",{className:"my-6 flex items-center",children:[c.jsx("div",{className:"flex-grow border-t border-gray-200"}),c.jsx("span",{className:"flex-shrink mx-4 text-gray-500 text-sm font-semibold",children:"OR"}),c.jsx("div",{className:"flex-grow border-t border-gray-200"})]}),c.jsxs("form",{onSubmit:w,className:"space-y-4",children:[!n&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"photo-upload",className:"block text-sm font-medium text-gray-700",children:"Profile Photo"}),c.jsxs("div",{className:"mt-1 flex items-center gap-4",children:[c.jsx("span",{className:"inline-block h-16 w-16 rounded-full overflow-hidden bg-gray-100",children:h?c.jsx("img",{src:h,alt:"Profile preview",className:"h-full w-full object-cover"}):c.jsx("svg",{className:"h-full w-full text-gray-300",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M24 20.993V24H0v-2.997A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})})}),c.jsxs("label",{htmlFor:"photo-upload",className:"cursor-pointer bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-unistay-yellow",children:[c.jsx("span",{children:"Upload Photo"}),c.jsx("input",{id:"photo-upload",name:"photo-upload",type:"file",className:"sr-only",accept:"image/*",onChange:x,disabled:T})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),c.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:i.name,onChange:v,disabled:T,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-50"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"contactNumber",className:"block text-sm font-medium text-gray-700",children:"Contact Number"}),c.jsx("input",{id:"contactNumber",name:"contactNumber",type:"tel",required:!0,value:i.contactNumber,onChange:v,disabled:T,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-50"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"universityId",className:"block text-sm font-medium text-gray-700",children:"University"}),c.jsxs("select",{id:"universityId",name:"universityId",required:!0,value:i.universityId,onChange:v,disabled:T,className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-50",children:[ue.map(S=>c.jsx("option",{value:S.id,children:S.name},S.id)),c.jsx("option",{value:"other",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"studentNumber",className:"block text-sm font-medium text-gray-700",children:"Student Number"}),c.jsx("input",{id:"studentNumber",name:"studentNumber",type:"text",required:!0,value:i.studentNumber,onChange:v,disabled:T,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-50"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"dateOfBirth",className:"block text-sm font-medium text-gray-700",children:"Date of Birth"}),c.jsx("input",{id:"dateOfBirth",name:"dateOfBirth",type:"date",required:!0,value:i.dateOfBirth,onChange:v,disabled:T,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-50"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),c.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:i.email,onChange:v,disabled:T,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-50"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),c.jsxs("div",{className:"relative mt-1",children:[c.jsx("input",{id:"password",name:"password",type:p.password?"text":"password",autoComplete:n?"current-password":"new-password",required:!0,value:i.password,onChange:v,disabled:T,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-50 pr-10"}),c.jsx("button",{type:"button",onClick:()=>b("password"),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600","aria-label":p.password?"Hide password":"Show password",children:c.jsx("i",{className:`fas ${p.password?"fa-eye-slash":"fa-eye"}`})})]})]}),!n&&c.jsxs("div",{children:[c.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),c.jsxs("div",{className:"relative mt-1",children:[c.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:p.confirmPassword?"text":"password",autoComplete:"new-password",required:!0,value:i.confirmPassword,onChange:v,disabled:T,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-unistay-yellow focus:border-unistay-yellow disabled:bg-gray-50 pr-10"}),c.jsx("button",{type:"button",onClick:()=>b("confirmPassword"),className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600","aria-label":p.confirmPassword?"Hide password":"Show password",children:c.jsx("i",{className:`fas ${p.confirmPassword?"fa-eye-slash":"fa-eye"}`})})]})]}),c.jsx("div",{className:"pt-2",children:c.jsx("button",{type:"submit",disabled:T,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-full shadow-sm text-lg font-bold text-unistay-navy bg-unistay-yellow hover:bg-yellow-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 transition-all duration-300 disabled:bg-yellow-400/70 disabled:cursor-not-allowed",children:f==="email"?c.jsx(Q,{color:"navy"}):n?"Sign In":"Create Account"})})]}),c.jsxs("p",{className:"mt-6 text-center text-sm text-gray-600",children:[n?"Don't have an account? ":"Already have an account? ",c.jsx("button",{onClick:()=>{T||s(!n)},className:"font-medium text-unistay-navy hover:text-unistay-yellow disabled:text-gray-400",disabled:T,children:n?"Sign up":"Sign in"})]})]})]})})},gt=t=>({async getAll(){const{data:e,error:n}=await B.from(t).select("*");if(n)throw n;return e},async getCounts(){const{count:e,error:n}=await B.from(t).select("*",{count:"exact",head:!0});if(n)throw n;return e||0},async add(e){const{data:n,error:s}=await B.from(t).insert([e]).select();if(s)throw s;return n[0]},async update(e,n){const{error:s}=await B.from(t).update(n).eq("id",e);if(s)throw s},async set(e){const{error:n}=await B.from(t).upsert(e,{onConflict:"id"});if(n)throw n},async remove(e){const{error:n}=await B.from(t).delete().eq("id",e);if(n)throw n}}),Hn=gt("hostels"),Jn=gt("news"),Wn=gt("events"),Kn=gt("jobs"),Rt=gt("profiles"),zt=t=>({add:async e=>{await t.add(e)},update:async e=>{await t.update(e.id,e)},remove:async e=>{await t.remove(e)}}),Bp=zt(Hn),Hp=zt(Jn),Jp=zt(Wn),Wp=zt(Kn);function Bi(t){switch(t){case"news":return"news_uploads";default:return"uploads"}}function Kp(t){return t==="news"?"":t}const xe={async uploadImage(t,e,n){try{if(!t||!(t instanceof File))throw new Error("Invalid file provided");if(!t.type.startsWith("image/"))throw new Error("File must be an image");const s=5*1024*1024;if(t.size>s)throw new Error("File size must be less than 5MB");const i=t.name.split(".").pop()?.toLowerCase();if(!i||!["jpg","jpeg","png","gif","webp","avif"].includes(i))throw new Error("Invalid file type. Supported types: jpg, jpeg, png, gif, webp, avif");const r=new Date().getTime(),o=Math.random().toString(36).substring(2),l=`${r}-${o}.${i}`,h=Kp(e),d=n?`${h}/${n}/${l}`:`${h}/${l}`,f=Bi(e),{data:m,error:p}=await B.storage.from(f).upload(d,t,{cacheControl:"3600",upsert:!0,contentType:t.type});if(p)throw new Error(`Failed to upload image: ${p.message}`);if(!m?.path)throw new Error("Upload succeeded but no path returned");const{data:{publicUrl:g}}=B.storage.from(f).getPublicUrl(m.path);if(!g)throw new Error("Failed to get public URL for uploaded file");return g}catch(s){const i=s instanceof Error?s.message:"Unknown upload error";throw new Error(i)}},async uploadMultipleImages(t,e,n){const s=t.map(i=>this.uploadImage(i,e,n));return Promise.all(s)},async deleteImage(t,e){try{const n=Bi(e),s=t.split("/"),i=s.indexOf(n);if(i===-1)throw new Error("Invalid storage URL format");const r=s.slice(i+1).join("/");if(!r)throw new Error("Invalid image path");if(e!=="news"&&!r.startsWith(e+"/"))throw new Error(`Image path does not match content type ${e}`);const{error:o}=await B.storage.from(n).remove([r]);if(o)throw new Error(`Failed to delete image: ${o.message}`)}catch(n){const s=n instanceof Error?n.message:"Unknown deletion error";throw new Error(s)}}},q=t=>c.jsx("input",{...t,className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-unistay-yellow focus:border-unistay-yellow"}),zn=t=>c.jsx("textarea",{...t,rows:4,className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-unistay-yellow focus:border-unistay-yellow"}),zp=t=>c.jsx("select",{...t,className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-unistay-yellow focus:border-unistay-yellow"}),ce=({children:t,onClick:e,className:n="bg-unistay-navy text-white hover:bg-opacity-90",type:s="button",disabled:i=!1,loading:r=!1})=>c.jsx("button",{type:s,onClick:e,disabled:i||r,className:`px-4 py-2 font-semibold rounded-md transition-all duration-200 disabled:bg-opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${n}`,children:r?c.jsx(Q,{color:n.includes("text-unistay-navy")?"navy":"white",size:"sm"}):t}),Hi=({icon:t,onClick:e,colorClass:n="text-gray-500 hover:text-unistay-navy",loading:s=!1})=>c.jsx("button",{onClick:e,disabled:s,className:`p-1 ${n} transition-colors disabled:text-gray-400 disabled:cursor-not-allowed w-6 h-6 flex items-center justify-center`,children:s?c.jsx(Q,{color:"navy",size:"sm"}):c.jsx("i",{className:`fas ${t}`})}),Yp=({icon:t,title:e,value:n})=>c.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg flex items-center gap-6 transform hover:-translate-y-1 transition-transform duration-300",children:[c.jsx("div",{className:"bg-unistay-yellow/20 text-unistay-navy rounded-full h-16 w-16 flex items-center justify-center flex-shrink-0",children:c.jsx("i",{className:`fas ${t} text-3xl`})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500 font-semibold",children:e}),c.jsx("p",{className:"text-4xl font-extrabold text-unistay-navy",children:n})]})]}),Qp=({stats:t,isLoading:e})=>{if(e)return c.jsx("div",{className:"flex justify-center items-center h-64",children:c.jsx(Q,{size:"lg"})});const n=[{icon:"fa-hotel",title:"Total Hostels",value:t.hostels},{icon:"fa-users",title:"Roommate Profiles",value:t.roommateProfiles},{icon:"fa-newspaper",title:"News Articles",value:t.news},{icon:"fa-calendar-alt",title:"Upcoming Events",value:t.events},{icon:"fa-briefcase",title:"Job Listings",value:t.jobs}];return c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-bold text-unistay-navy mb-6",children:"Dashboard Overview"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map((s,i)=>c.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:`${i*100}ms`},children:c.jsx(Yp,{...s})},s.title))})]})},Xp=({item:t,onSubmit:e,onCancel:n,isSubmitting:s})=>{const[i,r]=C.useState({title:t?.title||"",description:t?.description||"",source:t?.source||"",images:t?.imageUrl?[{file:null,previewUrl:t.imageUrl}]:[]}),o=f=>{const{name:m,value:p}=f.target;r(g=>({...g,[m]:p}))},l=f=>{const m=f.target.files;m&&Array.from(m).forEach(p=>{const g=URL.createObjectURL(p);r(y=>({...y,images:[...y.images,{file:p,previewUrl:g}]}))})},h=f=>{r(m=>({...m,images:m.images.filter((p,g)=>g!==f)}))},d=async f=>{if(f.preventDefault(),i.images.length===0){alert("Please upload at least one image");return}try{const m=i.images.filter(g=>g.file);let p=t?.imageUrl;if(m.length>0){const g=m.map(w=>w.file),y=new Date().getTime(),v=`${t?.id||y}`;if(p=(await xe.uploadMultipleImages(g,"news",v))[0],t?.id&&t.imageUrl)try{await xe.deleteImage(t.imageUrl,"news")}catch{}}e({...i,imageUrl:p,images:void 0})}catch{alert("Failed to upload images. Please try again.")}};return c.jsxs("form",{onSubmit:d,className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[c.jsx(q,{name:"title",value:i.title,onChange:o,placeholder:"Title",required:!0}),c.jsx(zn,{name:"description",value:i.description,onChange:o,placeholder:"Description",required:!0}),c.jsxs("div",{className:"space-y-4",children:[c.jsx(q,{type:"file",accept:"image/*",onChange:l,className:"w-full",required:i.images.length===0}),i.images.length>0&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:i.images.map((f,m)=>c.jsxs("div",{className:"relative group",children:[c.jsx("img",{src:f.previewUrl,alt:`Preview ${m+1}`,className:"w-full h-32 object-cover rounded-lg"}),c.jsx("button",{type:"button",onClick:()=>h(m),className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("i",{className:"fas fa-times"})})]},m))})]}),c.jsx(q,{name:"source",value:i.source,onChange:o,placeholder:"Source",required:!0}),c.jsxs("div",{className:"flex gap-2 justify-end",children:[c.jsx(ce,{onClick:n,className:"bg-gray-200 text-gray-800 hover:bg-gray-300",children:"Cancel"}),c.jsxs(ce,{type:"submit",loading:s,children:[t?"Update":"Add"," News"]})]})]})},Zp=({item:t,onSubmit:e,onCancel:n,isSubmitting:s})=>{const i=y=>y?new Date(y).toISOString().split("T")[0]:"",[r,o]=C.useState({title:t?.title||"",dateInput:t?i(t.date):"",location:t?.location||"",price:t?.price||"Free Entry",description:t?.description||"",contacts:t?.contacts||[""],phone:t?.phone||"",email:t?.email||"",time:t?.time||"",images:t?.imageUrl?[{file:null,previewUrl:t.imageUrl}]:[]}),l=y=>{const{name:v,value:x}=y.target;o(w=>({...w,[v]:x}))},h=y=>{const v=y.target.files;v&&Array.from(v).forEach(x=>{const w=URL.createObjectURL(x);o(_=>({..._,images:[..._.images,{file:x,previewUrl:w}]}))})},d=y=>{o(v=>({...v,images:v.images.filter((x,w)=>w!==y)}))},f=async y=>{if(y.preventDefault(),r.images.length===0){alert("Please upload at least one image");return}try{const v=r.images.map(S=>S.file),x=new Date().getTime(),w=`${t?.id||x}`,_=await xe.uploadMultipleImages(v,"events",w);if(t?.id&&t.imageUrl)try{await xe.deleteImage(t.imageUrl,"events")}catch{}const b=new Date(`${r.dateInput}T12:00:00`),T={...r,date:b.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),day:b.toLocaleDateString("en-US",{day:"2-digit"}),month:b.toLocaleDateString("en-US",{month:"short"}).toUpperCase(),imageUrl:_[0],price:r.price||"Free Entry",description:r.description?.trim(),contacts:r.contacts?.filter(S=>S.trim()),phone:r.phone?.trim(),email:r.email?.trim(),time:r.time,images:void 0};delete T.dateInput,e(T)}catch{alert("Failed to upload images. Please try again.")}},m=()=>{o(y=>({...y,contacts:[...y.contacts||[],""]}))},p=y=>{o(v=>({...v,contacts:v.contacts?.filter((x,w)=>w!==y)||[]}))},g=(y,v)=>{const x=[...r.contacts||[]];x[y]=v,o(w=>({...w,contacts:x}))};return c.jsxs("form",{onSubmit:f,className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[c.jsx(q,{name:"title",value:r.title,onChange:l,placeholder:"Title",required:!0}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx(q,{name:"dateInput",type:"date",value:r.dateInput,onChange:l,required:!0}),c.jsx(q,{name:"time",type:"time",value:r.time,onChange:l,placeholder:"Time",required:!0})]}),c.jsx(q,{name:"location",value:r.location,onChange:l,placeholder:"Location",required:!0}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.jsxs("div",{className:"relative",children:[c.jsx(q,{name:"price",value:r.price,onChange:l,placeholder:"Entrance Fee (e.g., 10000 or 'Free Entry')"}),c.jsx("button",{type:"button",onClick:()=>o(y=>({...y,price:"Free Entry"})),className:"absolute right-2 top-1/2 -translate-y-1/2 text-sm text-unistay-yellow hover:text-unistay-navy",children:"Set as Free"})]})}),c.jsx(zn,{name:"description",value:r.description,onChange:l,placeholder:"Event Description",required:!0}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-gray-700",children:"Contact Information"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx(q,{name:"phone",value:r.phone,onChange:l,placeholder:"Contact Phone"}),c.jsx(q,{name:"email",type:"email",value:r.email,onChange:l,placeholder:"Contact Email"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("label",{className:"text-sm text-gray-700",children:"Contact Persons"}),c.jsxs("button",{type:"button",onClick:m,className:"text-sm text-unistay-yellow hover:text-unistay-navy transition-colors",children:[c.jsx("i",{className:"fas fa-plus mr-1"}),"Add Contact"]})]}),r.contacts?.map((y,v)=>c.jsxs("div",{className:"flex gap-2",children:[c.jsx(q,{value:y,onChange:x=>g(v,x.target.value),placeholder:"Contact Person Name"}),c.jsx("button",{type:"button",onClick:()=>p(v),className:"text-red-500 hover:text-red-700",children:c.jsx("i",{className:"fas fa-times"})})]},v))]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx(q,{type:"file",accept:"image/*",onChange:h,className:"w-full",required:r.images.length===0}),r.images.length>0&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:r.images.map((y,v)=>c.jsxs("div",{className:"relative group",children:[c.jsx("img",{src:y.previewUrl,alt:`Preview ${v+1}`,className:"w-full h-32 object-cover rounded-lg"}),c.jsx("button",{type:"button",onClick:()=>d(v),className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("i",{className:"fas fa-times"})})]},v))})]}),c.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[c.jsx(ce,{onClick:n,className:"bg-gray-200 text-gray-800 hover:bg-gray-300",children:"Cancel"}),c.jsxs(ce,{type:"submit",loading:s,children:[t?"Update":"Add"," Event"]})]})]})},eg=({item:t,onSubmit:e,onCancel:n,isSubmitting:s})=>{const[i,r]=C.useState({title:t?.title||"",deadline:t?.deadline||"",company:t?.company||"",images:[]}),o=f=>{r(m=>({...m,[f.target.name]:f.target.value}))},l=f=>{const m=f.target.files;m&&Array.from(m).forEach(p=>{const g=URL.createObjectURL(p);r(y=>({...y,images:[...y.images,{file:p,previewUrl:g}]}))})},h=f=>{r(m=>({...m,images:m.images.filter((p,g)=>g!==f)}))},d=async f=>{if(f.preventDefault(),i.images.length===0){alert("Please upload at least one image");return}try{const m=i.images.map(v=>v.file),p=new Date().getTime(),g=`${t?.id||p}`,y=await xe.uploadMultipleImages(m,"jobs",g);if(t?.id&&t.imageUrl)try{const v=t.imageUrl.split("/").slice(-2).join("/");await xe.deleteImage(v,"jobs")}catch{}e({...i,imageUrl:y[0],images:void 0})}catch{alert("Failed to upload images. Please try again.")}};return c.jsxs("form",{onSubmit:d,className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[c.jsx(q,{name:"title",value:i.title,onChange:o,placeholder:"Title",required:!0}),c.jsx(q,{name:"deadline",value:i.deadline,onChange:o,placeholder:"Deadline (e.g., July 15th)",required:!0}),c.jsx(q,{name:"company",value:i.company,onChange:o,placeholder:"Company",required:!0}),c.jsxs("div",{className:"space-y-4",children:[c.jsx(q,{type:"file",accept:"image/*",onChange:l,className:"w-full",required:i.images.length===0}),i.images.length>0&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:i.images.map((f,m)=>c.jsxs("div",{className:"relative group",children:[c.jsx("img",{src:f.previewUrl,alt:`Preview ${m+1}`,className:"w-full h-32 object-cover rounded-lg"}),c.jsx("button",{type:"button",onClick:()=>h(m),className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("i",{className:"fas fa-times"})})]},m))})]}),c.jsxs("div",{className:"flex gap-2 justify-end",children:[c.jsx(ce,{onClick:n,className:"bg-gray-200 text-gray-800 hover:bg-gray-300",children:"Cancel"}),c.jsxs(ce,{type:"submit",loading:s,children:[t?"Update":"Add"," Job"]})]})]})},tg=({item:t,onSubmit:e,onCancel:n,universities:s,isSubmitting:i})=>{const o=s.find(y=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(y.id))?.id||"123e4567-e89b-12d3-a456-426614174001",[l,h]=C.useState({name:t?.name||"",location:t?.location||"",priceRange:t?.priceRange||"",images:t?.images||[],rating:t?.rating||4,universityId:t?.universityId||o,description:t?.description||"",amenities:t?.amenities||[],isRecommended:t?.isRecommended||!1}),d=y=>{const v=y.target.files;v&&Array.from(v).forEach(x=>{const w=URL.createObjectURL(x);h(_=>({..._,images:[..._.images||[],{file:x,previewUrl:w}]}))})},f=y=>{h(v=>({...v,images:(v.images||[]).filter((x,w)=>w!==y)}))},m=y=>{const{name:v,value:x,type:w}=y.target,_=y.target.checked;h(b=>({...b,[v]:w==="checkbox"?_:x}))},p=y=>{const v=(l.amenities||[]).filter((x,w)=>w!==y);h(x=>({...x,amenities:v}))},g=async y=>{if(y.preventDefault(),!l.images||l.images.length===0){alert("Please upload at least one image");return}try{const v=l.images.map(T=>T.file),x=new Date().getTime(),w=`${t?.id||x}`,_=await xe.uploadMultipleImages(v,"hostels",w);if(t?.id&&t.imageUrls){const T=new Set(t.imageUrls),S=new Set(_),E=t.imageUrls.filter(N=>!S.has(N));await Promise.all(E.map(async N=>{try{await xe.deleteImage(N,"hostels")}catch{}}))}const b={...l,rating:l.rating,imageUrl:_[0],imageUrls:_,images:void 0};e(b)}catch{alert("Failed to upload images. Please try again.")}};return c.jsxs("form",{onSubmit:g,className:"space-y-6 p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx(q,{name:"name",value:l.name,onChange:m,placeholder:"Hostel Name",required:!0}),c.jsxs("div",{className:"space-y-4",children:[c.jsx(q,{type:"file",multiple:!0,accept:"image/*",onChange:d,className:"w-full",required:(l.images?.length||0)===0}),l.images&&l.images.length>0&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 mt-4",children:l.images.map((y,v)=>c.jsxs("div",{className:"relative group",children:[c.jsx("img",{src:y.previewUrl,alt:`Preview ${v+1}`,className:"w-full h-32 object-cover rounded-lg"}),c.jsx("button",{type:"button",onClick:()=>f(v),className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("i",{className:"fas fa-times"})})]},v))})]}),c.jsx(q,{name:"location",value:l.location,onChange:m,placeholder:"Location",required:!0}),c.jsx(q,{name:"priceRange",value:l.priceRange,onChange:m,placeholder:"Price Range (e.g., 800K - 1.4M)",required:!0}),c.jsx(q,{name:"rating",type:"number",step:"0.1",min:"0",max:"5",value:l.rating,onChange:m,placeholder:"Rating",required:!0}),c.jsx(zp,{name:"universityId",value:l.universityId,onChange:m,children:s.map(y=>c.jsx("option",{value:y.id,children:y.name},y.id))})]}),c.jsx(zn,{name:"description",value:l.description,onChange:m,placeholder:"Description",required:!0}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"Amenities"}),c.jsx("div",{className:"mb-3",children:(()=>{const y=[{name:"Wifi",icon:"fas fa-wifi"},{name:"Swimming Pool",icon:"fas fa-water"},{name:"Laundry",icon:"fas fa-tshirt"},{name:"Parking",icon:"fas fa-parking"},{name:"Canteen",icon:"fa fa-shopping-bag"},{name:"Security",icon:"fas fa-shield-alt"},{name:"Restaurant",icon:"fas fa-utensils"},{name:"Study Area",icon:"fas fa-book"},{name:"TV",icon:"fas fa-tv"},{name:"Shuttle",icon:"fas fa-bus"},{name:"Girls Only",icon:"fa fa-female"},{name:"Boys Only",icon:"fa fa-male"},{name:"Mixed",icon:"fa fa-users"},{name:"Gym",icon:"fa fa-dumbbell"}],v=w=>(l.amenities||[]).some(_=>_.name===w),x=w=>{const _=l.amenities||[],b=_.findIndex(T=>T.name===w.name);if(b>=0){const T=_.filter((S,E)=>E!==b);h({...l,amenities:T})}else h({...l,amenities:[..._,{name:w.name,icon:w.icon}]})};return c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2",children:y.map(w=>c.jsxs("button",{type:"button",onClick:()=>x(w),className:`flex items-center gap-3 p-2 rounded-md border transition-colors text-sm text-gray-700 ${v(w.name)?"bg-unistay-yellow text-unistay-navy border-unistay-yellow":"bg-white hover:bg-gray-50"}`,children:[c.jsx("i",{className:`${w.icon} w-5 text-lg`}),c.jsx("span",{children:w.name})]},w.name))})})()}),c.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(l.amenities||[]).map((y,v)=>c.jsxs("div",{className:"flex items-center gap-2 bg-white border rounded-full px-3 py-1 text-sm shadow-sm",children:[c.jsx("i",{className:`${y.icon} text-sm`}),c.jsx("span",{className:"whitespace-nowrap",children:y.name}),c.jsx("button",{type:"button",onClick:()=>p(v),className:"ml-1 text-red-500 hover:text-red-700",children:c.jsx("i",{className:"fas fa-times"})})]},`${y.name}-${v}`))}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(q,{id:"customAmenityName",placeholder:"Custom amenity (e.g., Rooftop)"}),c.jsxs(ce,{onClick:()=>{const y=document.getElementById("customAmenityName");if(!y)return;const v=y.value.trim();v&&(h({...l,amenities:[...l.amenities||[],{name:v,icon:"fas fa-check"}]}),y.value="")},className:"bg-unistay-yellow text-unistay-navy hover:bg-yellow-400",children:[c.jsx("i",{className:"fas fa-plus mr-2"}),"Add Amenity"]})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{id:"isRecommended",name:"isRecommended",type:"checkbox",checked:l.isRecommended,onChange:m,className:"h-4 w-4 text-unistay-yellow focus:ring-unistay-yellow border-gray-300 rounded"}),c.jsx("label",{htmlFor:"isRecommended",className:"ml-2 text-sm font-medium text-gray-700",children:"Mark as Recommended"})]}),c.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[c.jsx(ce,{onClick:n,className:"bg-gray-200 text-gray-800 hover:bg-gray-300",children:"Cancel"}),c.jsxs(ce,{type:"submit",loading:i,children:[t?"Update":"Add"," Hostel"]})]})]})};function ng({title:t,items:e,handler:n,columns:s,FormComponent:i,universities:r=[],onDataChange:o}){const[l,h]=C.useState(null),[d,f]=C.useState(!1),[m,p]=C.useState(!1),[g,y]=C.useState(null),{notify:v}=Kt(),x=E=>{h(E),f(!1)},w=async E=>{if(window.confirm("Are you sure you want to delete this item?")){y(E);try{await n.remove(E),v({message:"Item deleted successfully!",type:"success"}),o()}catch(N){v({message:N,type:"error"})}finally{y(null)}}},_=()=>{h(null),f(!0)},b=()=>{h(null),f(!1)},S={onSubmit:async E=>{p(!0);try{E.id?(await n.update(E.id,E),v({message:"Item updated successfully!",type:"success"})):(await n.add(E),v({message:"Item added successfully!",type:"success"})),o(),b()}catch(N){v({message:N,type:"error"})}finally{p(!1)}},onCancel:b,item:l,isSubmitting:m,...r.length>0&&{universities:r}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-unistay-navy",children:t}),c.jsxs(ce,{onClick:_,className:"bg-unistay-yellow text-unistay-navy hover:bg-yellow-400",disabled:m||g!==null,children:[c.jsx("i",{className:"fas fa-plus mr-2"}),"Add New"]})]}),(d||l)&&c.jsx(i,{...S}),c.jsx("div",{className:"bg-white shadow rounded-lg overflow-x-auto",children:c.jsxs("table",{className:"w-full text-left",children:[c.jsx("thead",{className:"bg-gray-50 border-b",children:c.jsxs("tr",{children:[s.map(E=>c.jsx("th",{className:"p-4 font-semibold text-sm",children:E.header},E.header)),c.jsx("th",{className:"p-4 font-semibold text-sm text-right",children:"Actions"})]})}),c.jsx("tbody",{children:e.map(E=>c.jsxs("tr",{className:"border-b last:border-b-0 hover:bg-gray-50",children:[s.map(N=>c.jsx("td",{className:"p-4 text-sm text-gray-700 align-top",children:typeof E[N.accessor]=="boolean"?E[N.accessor]?c.jsx("span",{className:"flex items-center justify-center",children:c.jsx("i",{className:"fas fa-star text-unistay-yellow"})}):c.jsx("span",{className:"flex items-center justify-center",children:c.jsx("i",{className:"fas fa-minus text-gray-300"})}):E[N.accessor]},N.accessor)),c.jsx("td",{className:"p-4 text-right",children:c.jsxs("div",{className:"flex gap-3 justify-end",children:[c.jsx(Hi,{icon:"fa-pencil-alt",onClick:()=>x(E)}),c.jsx(Hi,{icon:"fa-trash",onClick:()=>w(E.id),colorClass:"text-red-500 hover:text-red-700",loading:g===E.id})]})})]},E.id))})]})})]})}const sg=({onExitAdminMode:t,content:e,onDataChange:n})=>{const[s,i]=C.useState("Dashboard"),[r,o]=C.useState({hostels:0,news:0,events:0,jobs:0,roommateProfiles:0}),[l,h]=C.useState(!0);C.useEffect(()=>{(async()=>{if(s==="Dashboard"){h(!0);try{const[g,y,v,x,w]=await Promise.all([Hn.getCounts(),Jn.getCounts(),Wn.getCounts(),Kn.getCounts(),Rt.getCounts()]);o({hostels:g,news:y,events:v,jobs:x,roommateProfiles:w})}catch{o({hostels:0,news:0,events:0,jobs:0,roommateProfiles:0})}finally{h(!1)}}})()},[s]);const d={Hostels:{title:"Manage Hostels",items:e.hostels.items,handler:e.hostels.handler,columns:[{header:"Name",accessor:"name"},{header:"University",accessor:"universityId"},{header:"Price Range",accessor:"priceRange"},{header:"Recommended",accessor:"isRecommended"}],FormComponent:tg,universities:e.hostels.universities},News:{title:"Manage News",items:e.news.items,handler:e.news.handler,columns:[{header:"Title",accessor:"title"},{header:"Source",accessor:"source"}],FormComponent:Xp},Events:{title:"Manage Events",items:e.events.items,handler:e.events.handler,columns:[{header:"Title",accessor:"title"},{header:"Date",accessor:"date"},{header:"Location",accessor:"location"}],FormComponent:Zp},Jobs:{title:"Manage Jobs",items:e.jobs.items,handler:e.jobs.handler,columns:[{header:"Title",accessor:"title"},{header:"Company",accessor:"company"},{header:"Deadline",accessor:"deadline"}],FormComponent:eg}},f={Dashboard:"fa-tachometer-alt",Hostels:"fa-hotel",News:"fa-newspaper",Events:"fa-calendar-alt",Jobs:"fa-briefcase"},m=["Dashboard","Hostels","News","Events","Jobs"];return c.jsxs("div",{className:"flex min-h-screen bg-gray-100",children:[c.jsxs("aside",{className:"w-64 bg-unistay-navy text-white flex flex-col p-4",children:[c.jsx("div",{className:"text-center py-4 mb-6",children:c.jsx("h1",{className:"text-3xl font-extrabold",children:"Admin"})}),c.jsx("nav",{className:"flex-grow",children:m.map(p=>c.jsxs("button",{onClick:()=>i(p),className:`w-full text-left px-4 py-3 my-1 rounded-lg transition-colors flex items-center gap-3 ${s===p?"bg-unistay-yellow text-unistay-navy font-bold":"hover:bg-white/10"}`,children:[c.jsx("i",{className:`fas ${f[p]} w-5`}),p]},p))}),c.jsx("div",{className:"pt-4 border-t border-white/20",children:c.jsxs("button",{onClick:t,className:"w-full text-left px-4 py-3 rounded-lg hover:bg-white/10 transition-colors flex items-center gap-3",children:[c.jsx("i",{className:"fas fa-arrow-left w-5"}),"Back to Site"]})})]}),c.jsx("main",{className:"flex-1 p-8 overflow-y-auto",children:s==="Dashboard"?c.jsx(Qp,{stats:r,isLoading:l}):c.jsx(ng,{...d[s],onDataChange:n})})]})},Nt=({icon:t,label:e,value:n})=>c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 flex items-center gap-4",children:[c.jsx("div",{className:"bg-unistay-yellow/20 text-unistay-navy rounded-full h-12 w-12 flex items-center justify-center flex-shrink-0",children:c.jsx("i",{className:`fas ${t} text-xl`})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:e}),c.jsx("p",{className:"text-lg font-bold text-unistay-navy truncate",children:n})]})]}),ig=({user:t,savedHostels:e,onSignOut:n,onToggleSaveHostel:s,profile:i,universities:r,onNavigate:o,onDataChange:l})=>{const[h,d]=C.useState(!1),f=C.useRef(null),{notify:m}=Kt(),p=v=>{if(!v)return"Not Set";const x=r.find(w=>w.id===v);return x?x.name:"Unknown University"},g=()=>{f.current?.click()},y=async v=>{const x=v.target.files?.[0];if(!(!x||!t)){d(!0);try{await ct.updateProfilePhoto(t.id,x),m({message:"Profile photo updated successfully!",type:"success"}),l()}catch(w){m({message:w,type:"error"})}finally{d(!1),f.current&&(f.current.value="")}}};return c.jsxs("div",{className:"bg-gray-100 min-h-screen",children:[c.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:c.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-20",children:[c.jsx("h1",{className:"text-3xl font-bold text-unistay-navy",children:"My Profile"}),c.jsxs("button",{onClick:()=>o("main"),className:"font-semibold text-unistay-navy hover:text-unistay-yellow transition-colors flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-arrow-left"}),"Back to Home"]})]})}),c.jsx("main",{className:"max-w-5xl mx-auto p-4 sm:p-6 lg:p-8 pt-8",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-fade-in-up",children:[c.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 text-center",children:[c.jsx("input",{type:"file",ref:f,onChange:y,className:"hidden",accept:"image/png, image/jpeg",disabled:h}),c.jsxs("div",{className:"relative w-32 h-32 mx-auto mb-4 group",children:[c.jsx("button",{onClick:g,disabled:h,className:"w-full h-full rounded-full bg-unistay-yellow flex items-center justify-center font-bold text-unistay-navy text-5xl disabled:cursor-not-allowed","aria-label":"Change profile photo",children:i?.imageUrl?c.jsx("img",{src:i.imageUrl,alt:t.name||"",className:"w-full h-full rounded-full object-cover"}):t.name?.charAt(0).toUpperCase()}),h?c.jsx("div",{className:"absolute inset-0 bg-black/60 rounded-full flex items-center justify-center",children:c.jsx(Q,{color:"white",size:"lg"})}):c.jsx("div",{className:"absolute inset-0 bg-black/60 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:g,children:c.jsx("i",{className:"fas fa-camera text-white text-3xl"})})]}),c.jsx("h2",{className:"text-2xl font-bold text-unistay-navy",children:t.name}),c.jsx("p",{className:"text-gray-500",children:t.email}),c.jsx("button",{onClick:()=>o("roommateFinder"),className:"mt-6 w-full bg-unistay-navy text-white font-bold py-2 px-6 rounded-full hover:bg-opacity-90 transition-colors",children:i?"Edit Roommate Profile":"Create Roommate Profile"})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6",children:[c.jsx("h3",{className:"text-xl font-bold text-unistay-navy mb-4",children:"Account"}),c.jsxs("button",{onClick:n,className:"w-full text-left px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors flex items-center gap-3",children:[c.jsx("i",{className:"fas fa-sign-out-alt w-5"}),"Logout"]})]})]}),c.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6",children:[c.jsx("h3",{className:"text-xl font-bold text-unistay-navy mb-4",children:"My Student Details"}),i?c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsx(Nt,{icon:"fa-university",label:"University",value:p(i?.universityId)}),c.jsx(Nt,{icon:"fa-book",label:"Course",value:i.course||"Not Set"}),c.jsx(Nt,{icon:"fa-calendar-day",label:"Year of Study",value:i.yearOfStudy?.toString()||"Not Set"}),c.jsx(Nt,{icon:"fa-wallet",label:"Budget",value:`UGX ${i.budget?.toLocaleString()||"0"}`})]}):c.jsxs("div",{className:"text-center py-8",children:[c.jsx("i",{className:"fas fa-user-graduate text-4xl text-gray-300 mb-4"}),c.jsx("p",{className:"text-gray-600",children:"You haven't created a roommate profile yet."}),c.jsx("button",{onClick:()=>o("roommateFinder"),className:"mt-4 font-bold text-unistay-navy hover:text-unistay-yellow",children:"Create one now to find matches!"})]})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6",children:[c.jsx("h3",{className:"text-xl font-bold text-unistay-navy mb-4",children:"Quick Links"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{onClick:()=>o("roommateFinder"),className:"flex items-center justify-between w-full p-4 rounded-lg hover:bg-gray-50 transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("i",{className:"fas fa-users text-unistay-navy"}),c.jsx("span",{className:"font-semibold",children:"My Roommate Matches"})]}),c.jsx("i",{className:"fas fa-chevron-right text-gray-400"})]}),e.length>0?c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-center justify-between px-4",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("i",{className:"fas fa-heart text-unistay-navy"}),c.jsxs("span",{className:"font-semibold",children:["Saved Hostels (",e.length,")"]})]})}),c.jsx("div",{className:"space-y-2 px-4",children:e.map(v=>c.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-gray-50",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-unistay-navy",children:v.name}),c.jsx("p",{className:"text-sm text-gray-600",children:v.priceRange})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("button",{onClick:()=>s(v.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-full",title:"Remove from saved",children:c.jsx("i",{className:"fas fa-heart"})})})]},v.id))})]}):c.jsx("div",{className:"flex items-center justify-between w-full p-4 rounded-lg hover:bg-gray-50 transition-colors",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("i",{className:"far fa-heart text-unistay-navy"}),c.jsx("span",{className:"font-semibold",children:"No Saved Hostels"})]})}),c.jsxs("button",{className:"flex items-center justify-between w-full p-4 rounded-lg hover:bg-gray-50 transition-colors cursor-not-allowed opacity-60",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("i",{className:"fas fa-file-alt text-unistay-navy"}),c.jsx("span",{className:"font-semibold",children:"My Job Applications"})]}),c.jsx("i",{className:"fas fa-chevron-right text-gray-400"})]})]})]})]})]})})]})},rg=()=>{const{notifications:t,removeNotification:e}=Kt(),n={success:"fa-check-circle",error:"fa-exclamation-circle",info:"fa-info-circle"},s={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500"};return c.jsxs("div",{className:"fixed top-5 right-5 z-[200] w-full max-w-sm space-y-3",children:[t.map(i=>c.jsxs("div",{className:`relative flex items-start gap-4 p-4 rounded-lg shadow-2xl text-white ${s[i.type]}`,style:{animation:"slideInLeft 0.3s ease-out forwards"},children:[c.jsx("div",{className:"flex-shrink-0 pt-0.5",children:c.jsx("i",{className:`fas ${n[i.type]} text-xl`})}),c.jsx("div",{className:"flex-1",children:c.jsx("p",{className:"font-bold text-sm leading-snug",children:i.message})}),c.jsx("button",{onClick:()=>e(i.id),className:"p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":"Close notification",children:c.jsx("i",{className:"fas fa-times text-sm"})})]},i.id)),c.jsx("style",{children:`
          @keyframes slideInLeft {
            from { 
              opacity: 0; 
              transform: translateX(100%); 
            }
            to { 
              opacity: 1; 
              transform: translateX(0); 
            }
          }
      `})]})},og=()=>{const[t,e]=C.useState("main"),[n,s]=C.useState(ue[0]),[i,r]=C.useState(null),[o,l]=C.useState(null),[h,d]=C.useState(!1),[f,m]=C.useState(!0),[p,g]=C.useState(()=>{try{const D=localStorage.getItem("unistay_saved_hostels");return D?new Set(JSON.parse(D)):new Set}catch{return new Set}}),[y,v]=C.useState([]),[x,w]=C.useState([]),[_,b]=C.useState([]),[T,S]=C.useState([]),[E,N]=C.useState([]),[M,R]=C.useState([]);C.useEffect(()=>{let D=!0;const K=async()=>{try{const{data:{session:be}}=await B.auth.getSession(),fe=Ot(be?.user||null);D&&(l(fe),d(fe?.email==="admin@unistay.com"||fe?.email==="victorbaguma34@gmail.com"),fe||(g(new Set),v([])),await U(),m(!1))}catch{D&&m(!1)}},{data:{subscription:ne}}=B.auth.onAuthStateChange(async(be,fe)=>{const st=Ot(fe?.user||null);D&&(l(st),d(st?.email==="admin@unistay.com"||st?.email==="victorbaguma34@gmail.com"||st?.email==="drilebaroy33@gmail.com"),st||(g(new Set),v([])))});return K(),()=>{D=!1,ne.unsubscribe()}},[]),C.useEffect(()=>{try{localStorage.setItem("unistay_saved_hostels",JSON.stringify(Array.from(p)))}catch{}},[p]),C.useEffect(()=>{if(o&&!f&&y.length===0){const D=M.find(ne=>ne.id===o?.id),K=[];_.length>0&&K.push({id:`notif-news-${_[0].id}`,type:"news",message:`New article posted: "${_[0].title}"`,timestamp:new Date(new Date().getTime()-1e3*60*3),read:!1}),E.length>0&&K.push({id:`notif-job-${E[0].id}`,type:"job",message:`New opportunity: ${E[0].title} at ${E[0].company}`,timestamp:new Date(new Date().getTime()-1e3*60*60*1),read:!1}),M.length>1&&D&&K.push({id:`notif-roommate-${Date.now()}`,type:"roommate",message:"You have new potential roommate matches!",timestamp:new Date(new Date().getTime()-1e3*60*60*5),read:!1}),v(K.sort((ne,be)=>be.timestamp.getTime()-ne.timestamp.getTime()))}},[o,f,_,E,M]);const U=async()=>{const[D,K,ne,be,fe]=await Promise.all([Hn.getAll(),Jn.getAll(),Wn.getAll(),Kn.getAll(),Rt.getAll()]);w(D),b(K),S(ne),N(be),R(fe)},V=D=>r(D),$=()=>r(null),te=async D=>{await Rt.set(D);const K=await Rt.getAll();R(K)},G=D=>{D==="admin"&&h?e("admin"):D!=="admin"&&e(D),window.scrollTo(0,0)},nt=D=>{if(!o){G("auth");return}g(K=>{const ne=new Set(K);return ne.has(D)?ne.delete(D):ne.add(D),ne})},ie=()=>{G("main")},Ue=async()=>{await ct.logout(),G("auth")},Ro=()=>{v(D=>D.map(K=>({...K,read:!0})))};if(f)return c.jsx("div",{className:"flex items-center justify-center h-screen bg-unistay-bg",children:c.jsx(Q,{size:"lg"})});const Po=t==="main";return c.jsx(qp,{children:c.jsxs("div",{className:`bg-white font-sans antialiased ${Po?"pt-20":""}`,children:[c.jsx(rg,{}),c.jsx(Bo,{onNavigate:G,currentView:t,user:o,isAdmin:h,onLogout:Ue,notifications:y,onMarkNotificationsAsRead:Ro}),c.jsxs("main",{children:[t==="main"&&c.jsxs(c.Fragment,{children:[c.jsx(Ho,{hostels:x,onHostelSelect:V}),c.jsx(ia,{universities:ue,selectedUniversity:n,onSelectUniversity:s,hostels:x,onViewHostel:V,savedHostelIds:p,onToggleSave:nt}),c.jsx(Yh,{news:_,events:T,jobs:E,universities:ue,onNavigateToBlog:()=>G("blog"),onNavigateToEvents:()=>G("events"),onNavigateToJobs:()=>G("jobs"),user:o,onNavigate:G}),c.jsx(Zh,{services:Jo,selectedUniversity:n})]}),t==="blog"&&c.jsx(cf,{news:_,onNavigateHome:()=>G("main")}),t==="events"&&c.jsx(hf,{events:T,onNavigateHome:()=>G("main")}),t==="jobs"&&c.jsx(mf,{jobs:E,onNavigateHome:()=>G("main")}),t==="roommateFinder"&&o&&c.jsx(lf,{currentUser:o,currentUserProfile:M.find(D=>D.id===o.id)||null,onProfileUpdate:te,profiles:M,universities:ue,onNavigateHome:()=>G("main")}),t==="auth"&&c.jsx(Gp,{onAuthSuccess:ie,onNavigateHome:()=>G("main")}),t==="admin"&&h&&c.jsx(sg,{onExitAdminMode:()=>G("main"),content:{hostels:{items:x,handler:Bp,universities:ue},news:{items:_,handler:Hp},events:{items:T,handler:Jp},jobs:{items:E,handler:Wp},roommateProfiles:{items:M}},onDataChange:U}),t==="profile"&&o&&c.jsx(ig,{user:o,profile:M.find(D=>D.id===o.id),onNavigate:G,onSignOut:Ue,universities:ue,onDataChange:U,savedHostels:Array.from(p).map(D=>x.find(K=>K.id===D)).filter(Boolean),onToggleSaveHostel:nt})]}),i&&c.jsx(tf,{hostel:i,onClose:$}),t!=="admin"&&t!=="auth"&&t!=="roommateFinder"&&t!=="profile"&&c.jsx(ef,{onNavigateToRoommateFinder:()=>G("roommateFinder"),onNavigateToBlog:()=>G("blog"),onNavigateToAuth:()=>G("auth"),user:o})]})})},Ao=document.getElementById("root");if(!Ao)throw new Error("Could not find root element to mount to");const ag=an.createRoot(Ao);ag.render(c.jsx(Mo.StrictMode,{children:c.jsx(og,{})}));
